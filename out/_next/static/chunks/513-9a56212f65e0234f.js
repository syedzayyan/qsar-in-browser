(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[513],{7707:function(r,e){var t;/**
 * @license Complex.js v2.1.1 12/05/2020
 *
 * Copyright (c) 2020, Robert Eisele (robert@xarg.org)
 * Dual licensed under the MIT or GPL Version 2 licenses.
 **/!function(n){"use strict";var a=Math.cosh||function(r){return 1e-9>Math.abs(r)?1-r:(Math.exp(r)+Math.exp(-r))*.5},o=Math.sinh||function(r){return 1e-9>Math.abs(r)?r:(Math.exp(r)-Math.exp(-r))*.5},cosm1=function(r){var e=Math.PI/4;if(-e>r||r>e)return Math.cos(r)-1;var t=r*r;return t*(t*(t*(t*(t*(t*(t*(t/20922789888e3-1/87178291200)+1/479001600)-1/3628800)+1/40320)-1/720)+1/24)-.5)},hypot=function(r,e){var t=Math.abs(r),n=Math.abs(e);return t<3e3&&n<3e3?Math.sqrt(t*t+n*n):(t<n?(t=n,n=r/e):n=e/r,t*Math.sqrt(1+n*n))},parser_exit=function(){throw SyntaxError("Invalid Param")};function logHypot(r,e){var t=Math.abs(r),n=Math.abs(e);return 0===r?Math.log(n):0===e?Math.log(t):t<3e3&&n<3e3?.5*Math.log(r*r+e*e):.5*Math.log((r/=2)*r+(e/=2)*e)+Math.LN2}var parse=function(r,e){var t={re:0,im:0};if(null==r)t.re=t.im=0;else if(void 0!==e)t.re=r,t.im=e;else switch(typeof r){case"object":if("im"in r&&"re"in r)t.re=r.re,t.im=r.im;else if("abs"in r&&"arg"in r){if(!Number.isFinite(r.abs)&&Number.isFinite(r.arg))return Complex.INFINITY;t.re=r.abs*Math.cos(r.arg),t.im=r.abs*Math.sin(r.arg)}else if("r"in r&&"phi"in r){if(!Number.isFinite(r.r)&&Number.isFinite(r.phi))return Complex.INFINITY;t.re=r.r*Math.cos(r.phi),t.im=r.r*Math.sin(r.phi)}else 2===r.length?(t.re=r[0],t.im=r[1]):parser_exit();break;case"string":t.im=t.re=0;var n=r.match(/\d+\.?\d*e[+-]?\d+|\d+\.?\d*|\.\d+|./g),a=1,o=0;null===n&&parser_exit();for(var u=0;u<n.length;u++){var s=n[u];" "===s||"	"===s||"\n"===s||("+"===s?a++:"-"===s?o++:("i"===s||"I"===s?(a+o===0&&parser_exit()," "===n[u+1]||isNaN(n[u+1])?t.im+=parseFloat((o%2?"-":"")+"1"):(t.im+=parseFloat((o%2?"-":"")+n[u+1]),u++)):((a+o===0||isNaN(s))&&parser_exit(),"i"===n[u+1]||"I"===n[u+1]?(t.im+=parseFloat((o%2?"-":"")+s),u++):t.re+=parseFloat((o%2?"-":"")+s)),a=o=0))}a+o>0&&parser_exit();break;case"number":t.im=0,t.re=r;break;default:parser_exit()}return isNaN(t.re)||isNaN(t.im),t};function Complex(r,e){if(!(this instanceof Complex))return new Complex(r,e);var t=parse(r,e);this.re=t.re,this.im=t.im}Complex.prototype={re:0,im:0,sign:function(){var r=this.abs();return new Complex(this.re/r,this.im/r)},add:function(r,e){var t=new Complex(r,e);return this.isInfinite()&&t.isInfinite()?Complex.NAN:this.isInfinite()||t.isInfinite()?Complex.INFINITY:new Complex(this.re+t.re,this.im+t.im)},sub:function(r,e){var t=new Complex(r,e);return this.isInfinite()&&t.isInfinite()?Complex.NAN:this.isInfinite()||t.isInfinite()?Complex.INFINITY:new Complex(this.re-t.re,this.im-t.im)},mul:function(r,e){var t=new Complex(r,e);return this.isInfinite()&&t.isZero()||this.isZero()&&t.isInfinite()?Complex.NAN:this.isInfinite()||t.isInfinite()?Complex.INFINITY:0===t.im&&0===this.im?new Complex(this.re*t.re,0):new Complex(this.re*t.re-this.im*t.im,this.re*t.im+this.im*t.re)},div:function(r,e){var t,n,a=new Complex(r,e);if(this.isZero()&&a.isZero()||this.isInfinite()&&a.isInfinite())return Complex.NAN;if(this.isInfinite()||a.isZero())return Complex.INFINITY;if(this.isZero()||a.isInfinite())return Complex.ZERO;r=this.re,e=this.im;var o=a.re,u=a.im;return 0===u?new Complex(r/o,e/o):Math.abs(o)<Math.abs(u)?(n=o/u,t=o*n+u,new Complex((r*n+e)/t,(e*n-r)/t)):(n=u/o,t=u*n+o,new Complex((r+e*n)/t,(e-r*n)/t))},pow:function(r,e){var t=new Complex(r,e);if(r=this.re,e=this.im,t.isZero())return Complex.ONE;if(0===t.im){if(0===e&&r>0)return new Complex(Math.pow(r,t.re),0);if(0===r)switch((t.re%4+4)%4){case 0:return new Complex(Math.pow(e,t.re),0);case 1:return new Complex(0,Math.pow(e,t.re));case 2:return new Complex(-Math.pow(e,t.re),0);case 3:return new Complex(0,-Math.pow(e,t.re))}}if(0===r&&0===e&&t.re>0&&t.im>=0)return Complex.ZERO;var n=Math.atan2(e,r),a=logHypot(r,e);return r=Math.exp(t.re*a-t.im*n),e=t.im*a+t.re*n,new Complex(r*Math.cos(e),r*Math.sin(e))},sqrt:function(){var r,e,t=this.re,n=this.im,a=this.abs();if(t>=0){if(0===n)return new Complex(Math.sqrt(t),0);r=.5*Math.sqrt(2*(a+t))}else r=Math.abs(n)/Math.sqrt(2*(a-t));return e=t<=0?.5*Math.sqrt(2*(a-t)):Math.abs(n)/Math.sqrt(2*(a+t)),new Complex(r,n<0?-e:e)},exp:function(){var r=Math.exp(this.re);return this.im,new Complex(r*Math.cos(this.im),r*Math.sin(this.im))},expm1:function(){var r=this.re,e=this.im;return new Complex(Math.expm1(r)*Math.cos(e)+cosm1(e),Math.exp(r)*Math.sin(e))},log:function(){var r=this.re,e=this.im;return new Complex(logHypot(r,e),Math.atan2(e,r))},abs:function(){return hypot(this.re,this.im)},arg:function(){return Math.atan2(this.im,this.re)},sin:function(){var r=this.re,e=this.im;return new Complex(Math.sin(r)*a(e),Math.cos(r)*o(e))},cos:function(){var r=this.re,e=this.im;return new Complex(Math.cos(r)*a(e),-Math.sin(r)*o(e))},tan:function(){var r=2*this.re,e=2*this.im,t=Math.cos(r)+a(e);return new Complex(Math.sin(r)/t,o(e)/t)},cot:function(){var r=2*this.re,e=2*this.im,t=Math.cos(r)-a(e);return new Complex(-Math.sin(r)/t,o(e)/t)},sec:function(){var r=this.re,e=this.im,t=.5*a(2*e)+.5*Math.cos(2*r);return new Complex(Math.cos(r)*a(e)/t,Math.sin(r)*o(e)/t)},csc:function(){var r=this.re,e=this.im,t=.5*a(2*e)-.5*Math.cos(2*r);return new Complex(Math.sin(r)*a(e)/t,-Math.cos(r)*o(e)/t)},asin:function(){var r=this.re,e=this.im,t=new Complex(e*e-r*r+1,-2*r*e).sqrt(),n=new Complex(t.re-e,t.im+r).log();return new Complex(n.im,-n.re)},acos:function(){var r=this.re,e=this.im,t=new Complex(e*e-r*r+1,-2*r*e).sqrt(),n=new Complex(t.re-e,t.im+r).log();return new Complex(Math.PI/2-n.im,n.re)},atan:function(){var r=this.re,e=this.im;if(0===r){if(1===e)return new Complex(0,1/0);if(-1===e)return new Complex(0,-1/0)}var t=r*r+(1-e)*(1-e),n=new Complex((1-e*e-r*r)/t,-2*r/t).log();return new Complex(-.5*n.im,.5*n.re)},acot:function(){var r=this.re,e=this.im;if(0===e)return new Complex(Math.atan2(1,r),0);var t=r*r+e*e;return 0!==t?new Complex(r/t,-e/t).atan():new Complex(0!==r?r/0:0,0!==e?-e/0:0).atan()},asec:function(){var r=this.re,e=this.im;if(0===r&&0===e)return new Complex(0,1/0);var t=r*r+e*e;return 0!==t?new Complex(r/t,-e/t).acos():new Complex(0!==r?r/0:0,0!==e?-e/0:0).acos()},acsc:function(){var r=this.re,e=this.im;if(0===r&&0===e)return new Complex(Math.PI/2,1/0);var t=r*r+e*e;return 0!==t?new Complex(r/t,-e/t).asin():new Complex(0!==r?r/0:0,0!==e?-e/0:0).asin()},sinh:function(){var r=this.re,e=this.im;return new Complex(o(r)*Math.cos(e),a(r)*Math.sin(e))},cosh:function(){var r=this.re,e=this.im;return new Complex(a(r)*Math.cos(e),o(r)*Math.sin(e))},tanh:function(){var r=2*this.re,e=2*this.im,t=a(r)+Math.cos(e);return new Complex(o(r)/t,Math.sin(e)/t)},coth:function(){var r=2*this.re,e=2*this.im,t=a(r)-Math.cos(e);return new Complex(o(r)/t,-Math.sin(e)/t)},csch:function(){var r=this.re,e=this.im,t=Math.cos(2*e)-a(2*r);return new Complex(-2*o(r)*Math.cos(e)/t,2*a(r)*Math.sin(e)/t)},sech:function(){var r=this.re,e=this.im,t=Math.cos(2*e)+a(2*r);return new Complex(2*a(r)*Math.cos(e)/t,-2*o(r)*Math.sin(e)/t)},asinh:function(){var r=this.im;this.im=-this.re,this.re=r;var e=this.asin();return this.re=-this.im,this.im=r,r=e.re,e.re=-e.im,e.im=r,e},acosh:function(){var r=this.acos();if(r.im<=0){var e=r.re;r.re=-r.im,r.im=e}else{var e=r.im;r.im=-r.re,r.re=e}return r},atanh:function(){var r=this.re,e=this.im,t=r>1&&0===e,n=1-r,a=1+r,o=n*n+e*e,u=0!==o?new Complex((a*n-e*e)/o,(e*n+a*e)/o):new Complex(-1!==r?r/0:0,0!==e?e/0:0),s=u.re;return u.re=logHypot(u.re,u.im)/2,u.im=Math.atan2(u.im,s)/2,t&&(u.im=-u.im),u},acoth:function(){var r=this.re,e=this.im;if(0===r&&0===e)return new Complex(0,Math.PI/2);var t=r*r+e*e;return 0!==t?new Complex(r/t,-e/t).atanh():new Complex(0!==r?r/0:0,0!==e?-e/0:0).atanh()},acsch:function(){var r=this.re,e=this.im;if(0===e)return new Complex(0!==r?Math.log(r+Math.sqrt(r*r+1)):1/0,0);var t=r*r+e*e;return 0!==t?new Complex(r/t,-e/t).asinh():new Complex(0!==r?r/0:0,0!==e?-e/0:0).asinh()},asech:function(){var r=this.re,e=this.im;if(this.isZero())return Complex.INFINITY;var t=r*r+e*e;return 0!==t?new Complex(r/t,-e/t).acosh():new Complex(0!==r?r/0:0,0!==e?-e/0:0).acosh()},inverse:function(){if(this.isZero())return Complex.INFINITY;if(this.isInfinite())return Complex.ZERO;var r=this.re,e=this.im,t=r*r+e*e;return new Complex(r/t,-e/t)},conjugate:function(){return new Complex(this.re,-this.im)},neg:function(){return new Complex(-this.re,-this.im)},ceil:function(r){return r=Math.pow(10,r||0),new Complex(Math.ceil(this.re*r)/r,Math.ceil(this.im*r)/r)},floor:function(r){return r=Math.pow(10,r||0),new Complex(Math.floor(this.re*r)/r,Math.floor(this.im*r)/r)},round:function(r){return r=Math.pow(10,r||0),new Complex(Math.round(this.re*r)/r,Math.round(this.im*r)/r)},equals:function(r,e){var t=new Complex(r,e);return Math.abs(t.re-this.re)<=Complex.EPSILON&&Math.abs(t.im-this.im)<=Complex.EPSILON},clone:function(){return new Complex(this.re,this.im)},toString:function(){var r=this.re,e=this.im,t="";return this.isNaN()?"NaN":this.isInfinite()?"Infinity":(Math.abs(r)<Complex.EPSILON&&(r=0),Math.abs(e)<Complex.EPSILON&&(e=0),0===e)?t+r:(0!==r?(t+=r+" ",e<0?(e=-e,t+="-"):t+="+",t+=" "):e<0&&(e=-e,t+="-"),1!==e&&(t+=e),t+"i")},toVector:function(){return[this.re,this.im]},valueOf:function(){return 0===this.im?this.re:null},isNaN:function(){return isNaN(this.re)||isNaN(this.im)},isZero:function(){return 0===this.im&&0===this.re},isFinite:function(){return isFinite(this.re)&&isFinite(this.im)},isInfinite:function(){return!(this.isNaN()||this.isFinite())}},Complex.ZERO=new Complex(0,0),Complex.ONE=new Complex(1,0),Complex.I=new Complex(0,1),Complex.PI=new Complex(Math.PI,0),Complex.E=new Complex(Math.E,0),Complex.INFINITY=new Complex(1/0,1/0),Complex.NAN=new Complex(NaN,NaN),Complex.EPSILON=1e-15,void 0!==(t=(function(){return Complex}).apply(e,[]))&&(r.exports=t)}(0)},92:function(r){/**
 * @license Fraction.js v4.3.0 20/08/2023
 * https://www.xarg.org/2014/03/rational-numbers-in-javascript/
 *
 * Copyright (c) 2023, Robert Eisele (robert@raw.org)
 * Dual licensed under the MIT or GPL Version 2 licenses.
 **/!function(e){"use strict";var t={s:1,n:0,d:1};function assign(r,e){if(isNaN(r=parseInt(r,10)))throw InvalidParameter();return r*e}function newFraction(r,e){if(0===e)throw DivisionByZero();var t=Object.create(Fraction.prototype);t.s=r<0?-1:1;var n=gcd(r=r<0?-r:r,e);return t.n=r/n,t.d=e/n,t}function factorize(r){for(var e={},t=r,n=2,a=4;a<=t;){for(;t%n==0;)t/=n,e[n]=(e[n]||0)+1;a+=1+2*n++}return t!==r?t>1&&(e[t]=(e[t]||0)+1):e[r]=(e[r]||0)+1,e}var parse=function(r,e){var n,a=0,o=1,u=1,s=0,c=0,f=0,l=1,p=1,m=0,h=1,d=1,g=1;if(null==r);else if(void 0!==e){if(u=(a=r)*(o=e),a%1!=0||o%1!=0)throw NonIntegerParameter()}else switch(typeof r){case"object":if("d"in r&&"n"in r)a=r.n,o=r.d,"s"in r&&(a*=r.s);else if(0 in r)a=r[0],1 in r&&(o=r[1]);else throw InvalidParameter();u=a*o;break;case"number":if(r<0&&(u=r,r=-r),r%1==0)a=r;else if(r>0){for(r>=1&&(p=Math.pow(10,Math.floor(1+Math.log(r)/Math.LN10)),r/=p);h<=1e7&&g<=1e7;){if(r===(n=(m+d)/(h+g))){h+g<=1e7?(a=m+d,o=h+g):g>h?(a=d,o=g):(a=m,o=h);break}r>n?(m+=d,h+=g):(d+=m,g+=h),h>1e7?(a=d,o=g):(a=m,o=h)}a*=p}else(isNaN(r)||isNaN(e))&&(o=a=NaN);break;case"string":if(null===(h=r.match(/\d+|./g)))throw InvalidParameter();if("-"===h[m]?(u=-1,m++):"+"===h[m]&&m++,h.length===m+1?c=assign(h[m++],u):"."===h[m+1]||"."===h[m]?("."!==h[m]&&(s=assign(h[m++],u)),(++m+1===h.length||"("===h[m+1]&&")"===h[m+3]||"'"===h[m+1]&&"'"===h[m+3])&&(c=assign(h[m],u),l=Math.pow(10,h[m].length),m++),("("===h[m]&&")"===h[m+2]||"'"===h[m]&&"'"===h[m+2])&&(f=assign(h[m+1],u),p=Math.pow(10,h[m+1].length)-1,m+=3)):"/"===h[m+1]||":"===h[m+1]?(c=assign(h[m],u),l=assign(h[m+2],1),m+=3):"/"===h[m+3]&&" "===h[m+1]&&(s=assign(h[m],u),c=assign(h[m+2],u),l=assign(h[m+4],1),m+=5),h.length<=m){u=a=f+(o=l*p)*s+p*c;break}default:throw InvalidParameter()}if(0===o)throw DivisionByZero();t.s=u<0?-1:1,t.n=Math.abs(a),t.d=Math.abs(o)};function gcd(r,e){if(!r)return e;if(!e)return r;for(;;){if(!(r%=e))return e;if(!(e%=r))return r}}function Fraction(r,e){if(parse(r,e),!(this instanceof Fraction))return newFraction(t.s*t.n,t.d);r=gcd(t.d,t.n),this.s=t.s,this.n=t.n/r,this.d=t.d/r}var DivisionByZero=function(){return Error("Division by Zero")},InvalidParameter=function(){return Error("Invalid argument")},NonIntegerParameter=function(){return Error("Parameters must be integer")};Fraction.prototype={s:1,n:0,d:1,abs:function(){return newFraction(this.n,this.d)},neg:function(){return newFraction(-this.s*this.n,this.d)},add:function(r,e){return parse(r,e),newFraction(this.s*this.n*t.d+t.s*this.d*t.n,this.d*t.d)},sub:function(r,e){return parse(r,e),newFraction(this.s*this.n*t.d-t.s*this.d*t.n,this.d*t.d)},mul:function(r,e){return parse(r,e),newFraction(this.s*t.s*this.n*t.n,this.d*t.d)},div:function(r,e){return parse(r,e),newFraction(this.s*t.s*this.n*t.d,this.d*t.n)},clone:function(){return newFraction(this.s*this.n,this.d)},mod:function(r,e){if(isNaN(this.n)||isNaN(this.d))return new Fraction(NaN);if(void 0===r)return newFraction(this.s*this.n%this.d,1);if(parse(r,e),0===t.n&&0===this.d)throw DivisionByZero();return newFraction(this.s*(t.d*this.n)%(t.n*this.d),t.d*this.d)},gcd:function(r,e){return parse(r,e),newFraction(gcd(t.n,this.n)*gcd(t.d,this.d),t.d*this.d)},lcm:function(r,e){return(parse(r,e),0===t.n&&0===this.n)?newFraction(0,1):newFraction(t.n*this.n,gcd(t.n,this.n)*gcd(t.d,this.d))},ceil:function(r){return(r=Math.pow(10,r||0),isNaN(this.n)||isNaN(this.d))?new Fraction(NaN):newFraction(Math.ceil(r*this.s*this.n/this.d),r)},floor:function(r){return(r=Math.pow(10,r||0),isNaN(this.n)||isNaN(this.d))?new Fraction(NaN):newFraction(Math.floor(r*this.s*this.n/this.d),r)},round:function(r){return(r=Math.pow(10,r||0),isNaN(this.n)||isNaN(this.d))?new Fraction(NaN):newFraction(Math.round(r*this.s*this.n/this.d),r)},inverse:function(){return newFraction(this.s*this.d,this.n)},pow:function(r,e){if(parse(r,e),1===t.d)return t.s<0?newFraction(Math.pow(this.s*this.d,t.n),Math.pow(this.n,t.n)):newFraction(Math.pow(this.s*this.n,t.n),Math.pow(this.d,t.n));if(this.s<0)return null;var n=factorize(this.n),a=factorize(this.d),o=1,u=1;for(var s in n)if("1"!==s){if("0"===s){o=0;break}if(n[s]*=t.n,n[s]%t.d!=0)return null;n[s]/=t.d,o*=Math.pow(s,n[s])}for(var s in a)if("1"!==s){if(a[s]*=t.n,a[s]%t.d!=0)return null;a[s]/=t.d,u*=Math.pow(s,a[s])}return t.s<0?newFraction(u,o):newFraction(o,u)},equals:function(r,e){return parse(r,e),this.s*this.n*t.d==t.s*t.n*this.d},compare:function(r,e){parse(r,e);var n=this.s*this.n*t.d-t.s*t.n*this.d;return(0<n)-(n<0)},simplify:function(r){if(isNaN(this.n)||isNaN(this.d))return this;r=r||.001;for(var e=this.abs(),t=e.toContinued(),n=1;n<t.length;n++){for(var a=newFraction(t[n-1],1),o=n-2;o>=0;o--)a=a.inverse().add(t[o]);if(Math.abs(a.sub(e).valueOf())<r)return a.mul(this.s)}return this},divisible:function(r,e){return parse(r,e),!(!(t.n*this.d)||this.n*t.d%(t.n*this.d))},valueOf:function(){return this.s*this.n/this.d},toFraction:function(r){var e,t="",n=this.n,a=this.d;return this.s<0&&(t+="-"),1===a?t+=n:(r&&(e=Math.floor(n/a))>0&&(t+=e+" ",n%=a),t+=n+"/"+a),t},toLatex:function(r){var e,t="",n=this.n,a=this.d;return this.s<0&&(t+="-"),1===a?t+=n:(r&&(e=Math.floor(n/a))>0&&(t+=e,n%=a),t+="\\frac{"+n+"}{"+a+"}"),t},toContinued:function(){var r,e=this.n,t=this.d,n=[];if(isNaN(e)||isNaN(t))return n;do n.push(Math.floor(e/t)),r=e%t,e=t,t=r;while(1!==e);return n},toString:function(r){var e=this.n,t=this.d;if(isNaN(e)||isNaN(t))return"NaN";r=r||15;var n=function(r,e){for(;e%2==0;e/=2);for(;e%5==0;e/=5);if(1===e)return 0;for(var t=10%e,n=1;1!==t;n++)if(t=10*t%e,n>2e3)return 0;return n}(0,t),a=function(r,e,t){for(var n=1,a=function(r,e,t){for(var n=1;e>0;r=r*r%t,e>>=1)1&e&&(n=n*r%t);return n}(10,t,e),o=0;o<300;o++){if(n===a)return o;n=10*n%e,a=10*a%e}return 0}(0,t,n),o=this.s<0?"-":"";if(o+=e/t|0,e%=t,(e*=10)&&(o+="."),n){for(var u=a;u--;)o+=e/t|0,e%=t,e*=10;o+="(";for(var u=n;u--;)o+=e/t|0,e%=t,e*=10;o+=")"}else for(var u=r;e&&u--;)o+=e/t|0,e%=t,e*=10;return o}},Object.defineProperty(Fraction,"__esModule",{value:!0}),Fraction.default=Fraction,Fraction.Fraction=Fraction,r.exports=Fraction}(0)},7478:function(r){r.exports=function naturalSort(r,e){"use strict";var t,n,a=/(^([+\-]?(?:0|[1-9]\d*)(?:\.\d*)?(?:[eE][+\-]?\d+)?)?$|^0x[0-9a-f]+$|\d+)/gi,o=/(^[ ]*|[ ]*$)/g,u=/(^([\w ]+,?[\w ]+)?[\w ]+,?[\w ]+\d+:\d+(:\d+)?[\w ]?|^\d{1,4}[\/\-]\d{1,4}[\/\-]\d{1,4}|^\w+, \w+ \d+, \d{4})/,s=/^0x[0-9a-f]+$/i,c=/^0/,i=function(r){return naturalSort.insensitive&&(""+r).toLowerCase()||""+r},f=i(r).replace(o,"")||"",l=i(e).replace(o,"")||"",p=f.replace(a,"\x00$1\x00").replace(/\0$/,"").replace(/^\0/,"").split("\x00"),m=l.replace(a,"\x00$1\x00").replace(/\0$/,"").replace(/^\0/,"").split("\x00"),h=parseInt(f.match(s),16)||1!==p.length&&f.match(u)&&Date.parse(f),d=parseInt(l.match(s),16)||h&&l.match(u)&&Date.parse(l)||null;if(d){if(h<d)return -1;if(h>d)return 1}for(var g=0,v=Math.max(p.length,m.length);g<v;g++){if(t=!(p[g]||"").match(c)&&parseFloat(p[g])||p[g]||0,n=!(m[g]||"").match(c)&&parseFloat(m[g])||m[g]||0,isNaN(t)!==isNaN(n))return isNaN(t)?1:-1;if(typeof t!=typeof n&&(t+="",n+=""),t<n)return -1;if(t>n)return 1}return 0}},711:function(r,e,t){var n=t(6122),a=t(8490),o=t(8549),u=t(1835),s=t(1433),c=t(3201),f=t(7514);f.alea=n,f.xor128=a,f.xorwow=o,f.xorshift7=u,f.xor4096=s,f.tychei=c,r.exports=f},6122:function(r,e,t){var n;!function(r,a,o){function Alea(r){var e,t=this,n=(e=4022871197,function(r){r=String(r);for(var t=0;t<r.length;t++){var n=.02519603282416938*(e+=r.charCodeAt(t));e=n>>>0,n-=e,n*=e,e=n>>>0,n-=e,e+=4294967296*n}return(e>>>0)*23283064365386963e-26});t.next=function(){var r=2091639*t.s0+23283064365386963e-26*t.c;return t.s0=t.s1,t.s1=t.s2,t.s2=r-(t.c=0|r)},t.c=1,t.s0=n(" "),t.s1=n(" "),t.s2=n(" "),t.s0-=n(r),t.s0<0&&(t.s0+=1),t.s1-=n(r),t.s1<0&&(t.s1+=1),t.s2-=n(r),t.s2<0&&(t.s2+=1)}function copy(r,e){return e.c=r.c,e.s0=r.s0,e.s1=r.s1,e.s2=r.s2,e}function impl(r,e){var t=new Alea(r),n=e&&e.state,a=t.next;return a.int32=function(){return 4294967296*t.next()|0},a.double=function(){return a()+(2097152*a()|0)*11102230246251565e-32},a.quick=a,n&&("object"==typeof n&&copy(n,t),a.state=function(){return copy(t,{})}),a}a&&a.exports?a.exports=impl:t.amdD&&t.amdO?void 0!==(n=(function(){return impl}).call(e,t,e,a))&&(a.exports=n):this.alea=impl}(0,r=t.nmd(r),t.amdD)},3201:function(r,e,t){var n;!function(r,a,o){function XorGen(r){var e=this,t="";e.next=function(){var r=e.b,t=e.c,n=e.d,a=e.a;return r=r<<25^r>>>7^t,t=t-n|0,n=n<<24^n>>>8^a,a=a-r|0,e.b=r=r<<20^r>>>12^t,e.c=t=t-n|0,e.d=n<<16^t>>>16^a,e.a=a-r|0},e.a=0,e.b=0,e.c=-1640531527,e.d=1367130551,r===Math.floor(r)?(e.a=r/4294967296|0,e.b=0|r):t+=r;for(var n=0;n<t.length+20;n++)e.b^=0|t.charCodeAt(n),e.next()}function copy(r,e){return e.a=r.a,e.b=r.b,e.c=r.c,e.d=r.d,e}function impl(r,e){var t=new XorGen(r),n=e&&e.state,prng=function(){return(t.next()>>>0)/4294967296};return prng.double=function(){do var r=((t.next()>>>11)+(t.next()>>>0)/4294967296)/2097152;while(0===r);return r},prng.int32=t.next,prng.quick=prng,n&&("object"==typeof n&&copy(n,t),prng.state=function(){return copy(t,{})}),prng}a&&a.exports?a.exports=impl:t.amdD&&t.amdO?void 0!==(n=(function(){return impl}).call(e,t,e,a))&&(a.exports=n):this.tychei=impl}(0,r=t.nmd(r),t.amdD)},8490:function(r,e,t){var n;!function(r,a,o){function XorGen(r){var e=this,t="";e.x=0,e.y=0,e.z=0,e.w=0,e.next=function(){var r=e.x^e.x<<11;return e.x=e.y,e.y=e.z,e.z=e.w,e.w^=e.w>>>19^r^r>>>8},r===(0|r)?e.x=r:t+=r;for(var n=0;n<t.length+64;n++)e.x^=0|t.charCodeAt(n),e.next()}function copy(r,e){return e.x=r.x,e.y=r.y,e.z=r.z,e.w=r.w,e}function impl(r,e){var t=new XorGen(r),n=e&&e.state,prng=function(){return(t.next()>>>0)/4294967296};return prng.double=function(){do var r=((t.next()>>>11)+(t.next()>>>0)/4294967296)/2097152;while(0===r);return r},prng.int32=t.next,prng.quick=prng,n&&("object"==typeof n&&copy(n,t),prng.state=function(){return copy(t,{})}),prng}a&&a.exports?a.exports=impl:t.amdD&&t.amdO?void 0!==(n=(function(){return impl}).call(e,t,e,a))&&(a.exports=n):this.xor128=impl}(0,r=t.nmd(r),t.amdD)},1433:function(r,e,t){var n;!function(r,a,o){function XorGen(r){var e=this;e.next=function(){var r,t,n=e.w,a=e.X,o=e.i;return e.w=n=n+1640531527|0,t=a[o+34&127],r=a[o=o+1&127],t^=t<<13,r^=r<<17,t^=t>>>15,r^=r>>>12,t=a[o]=t^r,e.i=o,t+(n^n>>>16)|0},function(r,e){var t,n,a,o,u,s=[],c=128;for(e===(0|e)?(n=e,e=null):(e+="\x00",n=0,c=Math.max(c,e.length)),a=0,o=-32;o<c;++o)e&&(n^=e.charCodeAt((o+32)%e.length)),0===o&&(u=n),n^=n<<10,n^=n>>>15,n^=n<<4,n^=n>>>13,o>=0&&(u=u+1640531527|0,a=0==(t=s[127&o]^=n+u)?a+1:0);for(a>=128&&(s[127&(e&&e.length||0)]=-1),a=127,o=512;o>0;--o)n=s[a+34&127],t=s[a=a+1&127],n^=n<<13,t^=t<<17,n^=n>>>15,t^=t>>>12,s[a]=n^t;r.w=u,r.X=s,r.i=a}(e,r)}function copy(r,e){return e.i=r.i,e.w=r.w,e.X=r.X.slice(),e}function impl(r,e){null==r&&(r=+new Date);var t=new XorGen(r),n=e&&e.state,prng=function(){return(t.next()>>>0)/4294967296};return prng.double=function(){do var r=((t.next()>>>11)+(t.next()>>>0)/4294967296)/2097152;while(0===r);return r},prng.int32=t.next,prng.quick=prng,n&&(n.X&&copy(n,t),prng.state=function(){return copy(t,{})}),prng}a&&a.exports?a.exports=impl:t.amdD&&t.amdO?void 0!==(n=(function(){return impl}).call(e,t,e,a))&&(a.exports=n):this.xor4096=impl}(0,r=t.nmd(r),t.amdD)},1835:function(r,e,t){var n;!function(r,a,o){function XorGen(r){var e=this;e.next=function(){var r,t,n=e.x,a=e.i;return r=n[a],r^=r>>>7,t=r^r<<24^((r=n[a+1&7])^r>>>10)^((r=n[a+3&7])^r>>>3)^((r=n[a+4&7])^r<<7),r=n[a+7&7],r^=r<<13,t^=r^r<<9,n[a]=t,e.i=a+1&7,t},function(r,e){var t,n=[];if(e===(0|e))n[0]=e;else for(t=0,e=""+e;t<e.length;++t)n[7&t]=n[7&t]<<15^e.charCodeAt(t)+n[t+1&7]<<13;for(;n.length<8;)n.push(0);for(t=0;t<8&&0===n[t];++t);for(8==t?n[7]=-1:n[t],r.x=n,r.i=0,t=256;t>0;--t)r.next()}(e,r)}function copy(r,e){return e.x=r.x.slice(),e.i=r.i,e}function impl(r,e){null==r&&(r=+new Date);var t=new XorGen(r),n=e&&e.state,prng=function(){return(t.next()>>>0)/4294967296};return prng.double=function(){do var r=((t.next()>>>11)+(t.next()>>>0)/4294967296)/2097152;while(0===r);return r},prng.int32=t.next,prng.quick=prng,n&&(n.x&&copy(n,t),prng.state=function(){return copy(t,{})}),prng}a&&a.exports?a.exports=impl:t.amdD&&t.amdO?void 0!==(n=(function(){return impl}).call(e,t,e,a))&&(a.exports=n):this.xorshift7=impl}(0,r=t.nmd(r),t.amdD)},8549:function(r,e,t){var n;!function(r,a,o){function XorGen(r){var e=this,t="";e.next=function(){var r=e.x^e.x>>>2;return e.x=e.y,e.y=e.z,e.z=e.w,e.w=e.v,(e.d=e.d+362437|0)+(e.v=e.v^e.v<<4^(r^r<<1))|0},e.x=0,e.y=0,e.z=0,e.w=0,e.v=0,r===(0|r)?e.x=r:t+=r;for(var n=0;n<t.length+64;n++)e.x^=0|t.charCodeAt(n),n==t.length&&(e.d=e.x<<10^e.x>>>4),e.next()}function copy(r,e){return e.x=r.x,e.y=r.y,e.z=r.z,e.w=r.w,e.v=r.v,e.d=r.d,e}function impl(r,e){var t=new XorGen(r),n=e&&e.state,prng=function(){return(t.next()>>>0)/4294967296};return prng.double=function(){do var r=((t.next()>>>11)+(t.next()>>>0)/4294967296)/2097152;while(0===r);return r},prng.int32=t.next,prng.quick=prng,n&&("object"==typeof n&&copy(n,t),prng.state=function(){return copy(t,{})}),prng}a&&a.exports?a.exports=impl:t.amdD&&t.amdO?void 0!==(n=(function(){return impl}).call(e,t,e,a))&&(a.exports=n):this.xorwow=impl}(0,r=t.nmd(r),t.amdD)},7514:function(r,e,t){var n;!function(a,o,u){var s,c=u.pow(256,6),f=u.pow(2,52),l=2*f;function seedrandom(r,e,t){var n=[],p=mixkey(function flatten(r,e){var t,n=[],a=typeof r;if(e&&"object"==a)for(t in r)try{n.push(flatten(r[t],e-1))}catch(r){}return n.length?n:"string"==a?r:r+"\x00"}((e=!0==e?{entropy:!0}:e||{}).entropy?[r,tostring(o)]:null==r?function(){try{var r;return s&&(r=s.randomBytes)?r=r(256):(r=new Uint8Array(256),(a.crypto||a.msCrypto).getRandomValues(r)),tostring(r)}catch(r){var e=a.navigator,t=e&&e.plugins;return[+new Date,a,t,a.screen,tostring(o)]}}():r,3),n),m=new ARC4(n),prng=function(){for(var r=m.g(6),e=c,t=0;r<f;)r=(r+t)*256,e*=256,t=m.g(1);for(;r>=l;)r/=2,e/=2,t>>>=1;return(r+t)/e};return prng.int32=function(){return 0|m.g(4)},prng.quick=function(){return m.g(4)/4294967296},prng.double=prng,mixkey(tostring(m.S),o),(e.pass||t||function(r,e,t,n){return(n&&(n.S&&copy(n,m),r.state=function(){return copy(m,{})}),t)?(u.random=r,e):r})(prng,p,"global"in e?e.global:this==u,e.state)}function ARC4(r){var e,t=r.length,n=this,a=0,o=n.i=n.j=0,u=n.S=[];for(t||(r=[t++]);a<256;)u[a]=a++;for(a=0;a<256;a++)u[a]=u[o=255&o+r[a%t]+(e=u[a])],u[o]=e;(n.g=function(r){for(var e,t=0,a=n.i,o=n.j,u=n.S;r--;)e=u[a=255&a+1],t=256*t+u[255&(u[a]=u[o=255&o+e])+(u[o]=e)];return n.i=a,n.j=o,t})(256)}function copy(r,e){return e.i=r.i,e.j=r.j,e.S=r.S.slice(),e}function mixkey(r,e){for(var t,n=r+"",a=0;a<n.length;)e[255&a]=255&(t^=19*e[255&a])+n.charCodeAt(a++);return tostring(e)}function tostring(r){return String.fromCharCode.apply(0,r)}if(mixkey(u.random(),o),r.exports){r.exports=seedrandom;try{s=t(5042)}catch(r){}}else void 0!==(n=(function(){return seedrandom}).call(e,t,e,r))&&(r.exports=n)}("undefined"!=typeof self?self:this,[],Math)},8722:function(r){r.exports=function(){"use strict";function ok(){return!0}function notOk(){return!1}function undef(){}let r="Argument is not a typed-function.";return function create(){let e,t;function isPlainObject(r){return"object"==typeof r&&null!==r&&r.constructor===Object}let n=[{name:"number",test:function(r){return"number"==typeof r}},{name:"string",test:function(r){return"string"==typeof r}},{name:"boolean",test:function(r){return"boolean"==typeof r}},{name:"Function",test:function(r){return"function"==typeof r}},{name:"Array",test:Array.isArray},{name:"Date",test:function(r){return r instanceof Date}},{name:"RegExp",test:function(r){return r instanceof RegExp}},{name:"Object",test:isPlainObject},{name:"null",test:function(r){return null===r}},{name:"undefined",test:function(r){return void 0===r}}],a={name:"any",test:ok,isAny:!0},o=0,u={createCount:0};function findType(r){let n;let a=e.get(r);if(a)return a;let o='Unknown type "'+r+'"',u=r.toLowerCase();for(n of t)if(n.toLowerCase()===u){o+='. Did you mean "'+n+'" ?';break}throw TypeError(o)}function addTypes(r){let n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"any",a=n?findType(n).index:t.length,o=[];for(let t=0;t<r.length;++t){if(!r[t]||"string"!=typeof r[t].name||"function"!=typeof r[t].test)throw TypeError("Object with properties {name: string, test: function} expected");let n=r[t].name;if(e.has(n))throw TypeError('Duplicate type name "'+n+'"');o.push(n),e.set(n,{name:n,test:r[t].test,isAny:r[t].isAny,index:a+t,conversionsTo:[]})}let u=t.slice(a);t=t.slice(0,a).concat(o).concat(u);for(let r=a+o.length;r<t.length;++r)e.get(t[r]).index=r}function clear(){e=new Map,t=[],o=0,addTypes([a],!1)}function findTypeNames(r){let n=t.filter(t=>{let n=e.get(t);return!n.isAny&&n.test(r)});return n.length?n:["any"]}function isTypedFunction(r){return r&&"function"==typeof r&&"_typedFunctionData"in r}function findSignature(e,t,n){let a,o;if(!isTypedFunction(e))throw TypeError(r);let u=n&&n.exact,s=Array.isArray(t)?t.join(","):t,c=parseSignature(s),f=stringifyParams(c);if(!u||f in e.signatures){let r=e._typedFunctionData.signatureMap.get(f);if(r)return r}let l=c.length;if(u){let r;for(r in a=[],e.signatures)a.push(e._typedFunctionData.signatureMap.get(r))}else a=e._typedFunctionData.signatures;for(let r=0;r<l;++r){let e;let t=c[r],n=[];for(e of a){let a=getParamAtIndex(e.params,r);if(a&&(!t.restParam||a.restParam)){if(!a.hasAny){let r=paramTypeSet(a);if(t.types.some(e=>!r.has(e.name)))continue}n.push(e)}}if(0===(a=n).length)break}for(o of a)if(o.params.length<=l)return o;throw TypeError("Signature not found (signature: "+(e.name||"unnamed")+"("+stringifyParams(c,", ")+"))")}function stringifyParams(r){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:",";return r.map(r=>r.name).join(e)}function expandParam(r){let e=r.types.map(r=>r.name),t=function(r){if(0===r.length)return[];let e=r.map(findType);r.length>1&&e.sort((r,e)=>r.index-e.index);let t=e[0].conversionsTo;if(1===r.length)return t;t=t.concat([]);let n=new Set(r);for(let r=1;r<e.length;++r){let a;for(a of e[r].conversionsTo)n.has(a.from)||(t.push(a),n.add(a.from))}return t}(e),n=r.hasAny,a=r.name,o=t.map(function(r){let e=findType(r.from);return n=e.isAny||n,a+="|"+r.from,{name:r.from,typeIndex:e.index,test:e.test,isAny:e.isAny,conversion:r,conversionIndex:r.index}});return{types:r.types.concat(o),name:a,hasAny:n,hasConversion:o.length>0,restParam:r.restParam}}function paramTypeSet(r){return r.typeSet||(r.typeSet=new Set,r.types.forEach(e=>r.typeSet.add(e.name))),r.typeSet}function parseSignature(r){let e=[];if("string"!=typeof r)throw TypeError("Signatures must be strings");let t=r.trim();if(""===t)return e;let n=t.split(",");for(let r=0;r<n.length;++r){let t=function(r){let e=0===r.indexOf("..."),t=e?r.length>3?r.slice(3):"any":r,n=t.split("|").map(r=>findType(r.trim())),a=!1,o=e?"...":"",u=n.map(function(r){return a=r.isAny||a,o+=r.name+"|",{name:r.name,typeIndex:r.index,test:r.test,isAny:r.isAny,conversion:null,conversionIndex:-1}});return{types:u,name:o.slice(0,-1),hasAny:a,hasConversion:!1,restParam:e}}(n[r].trim());if(t.restParam&&r!==n.length-1)throw SyntaxError('Unexpected rest parameter "'+n[r]+'": only allowed for the last parameter');if(0===t.types.length)return null;e.push(t)}return e}function hasRestParam(r){let e=last(r);return!!e&&e.restParam}function compileTest(r){if(!r||0===r.types.length)return ok;if(1===r.types.length)return findType(r.types[0].name).test;if(2===r.types.length){let e=findType(r.types[0].name).test,t=findType(r.types[1].name).test;return function(r){return e(r)||t(r)}}{let e=r.types.map(function(r){return findType(r.name).test});return function(r){for(let t=0;t<e.length;t++)if(e[t](r))return!0;return!1}}}function getParamAtIndex(r,e){return e<r.length?r[e]:hasRestParam(r)?last(r):null}function getTypeSetAtIndex(r,e){let t=getParamAtIndex(r,e);return t?paramTypeSet(t):new Set}function isExactType(r){return null===r.conversion||void 0===r.conversion}function mergeExpectedParams(r,e){let t=new Set;return r.forEach(r=>{let n;let a=getTypeSetAtIndex(r.params,e);for(n of a)t.add(n)}),t.has("any")?["any"]:Array.from(t)}function createError(r,e,t){let n,a,o;let u=r||"unnamed",s=t;for(o=0;o<e.length;o++){let r=[];if(s.forEach(t=>{let n=getParamAtIndex(t.params,o),a=compileTest(n);(o<t.params.length||hasRestParam(t.params))&&a(e[o])&&r.push(t)}),0===r.length){if((a=mergeExpectedParams(s,o)).length>0){let r=findTypeNames(e[o]);return(n=TypeError("Unexpected type of argument in function "+u+" (expected: "+a.join(" or ")+", actual: "+r.join(" | ")+", index: "+o+")")).data={category:"wrongType",fn:u,index:o,actual:r,expected:a},n}}else s=r}let c=s.map(function(r){return hasRestParam(r.params)?1/0:r.params.length});if(e.length<Math.min.apply(null,c))return(n=TypeError("Too few arguments in function "+u+" (expected: "+(a=mergeExpectedParams(s,o)).join(" or ")+", index: "+e.length+")")).data={category:"tooFewArgs",fn:u,index:e.length,expected:a},n;let f=Math.max.apply(null,c);if(e.length>f)return(n=TypeError("Too many arguments in function "+u+" (expected: "+f+", actual: "+e.length+")")).data={category:"tooManyArgs",fn:u,index:e.length,expectedLength:f},n;let l=[];for(let r=0;r<e.length;++r)l.push(findTypeNames(e[r]).join("|"));return(n=TypeError('Arguments of type "'+l.join(", ")+'" do not match any of the defined signatures of function '+u+".")).data={category:"mismatch",actual:l},n}function getLowestTypeIndex(r){let e=t.length+1;for(let t=0;t<r.types.length;t++)isExactType(r.types[t])&&(e=Math.min(e,r.types[t].typeIndex));return e}function getLowestConversionIndex(r){let e=o+1;for(let t=0;t<r.types.length;t++)isExactType(r.types[t])||(e=Math.min(e,r.types[t].conversionIndex));return e}function compareSignatures(r,e){let t,n;let a=r.params,o=e.params,u=last(a),s=last(o),c=hasRestParam(a),f=hasRestParam(o);if(c&&u.hasAny){if(!f||!s.hasAny)return 1}else if(f&&s.hasAny)return -1;let l=0,p=0;for(t of a)t.hasAny&&++l,t.hasConversion&&++p;let m=0,h=0;for(t of o)t.hasAny&&++m,t.hasConversion&&++h;if(l!==m)return l-m;if(c&&u.hasConversion){if(!f||!s.hasConversion)return 1}else if(f&&s.hasConversion)return -1;if(p!==h)return p-h;if(c){if(!f)return 1}else if(f)return -1;let d=(a.length-o.length)*(c?-1:1);if(0!==d)return d;let g=[],v=0;for(let r=0;r<a.length;++r){let e=function(r,e){if(r.hasAny){if(!e.hasAny)return 1}else if(e.hasAny)return -1;if(r.restParam){if(!e.restParam)return 1}else if(e.restParam)return -1;if(r.hasConversion){if(!e.hasConversion)return 1}else if(e.hasConversion)return -1;let t=getLowestTypeIndex(r)-getLowestTypeIndex(e);if(t<0)return -1;if(t>0)return 1;let n=getLowestConversionIndex(r)-getLowestConversionIndex(e);return n<0?-1:n>0?1:0}(a[r],o[r]);g.push(e),v+=e}if(0!==v)return v;for(n of g)if(0!==n)return n;return 0}function compileArgConversion(r){let e,t,n,a;let o=[],u=[];switch(r.types.forEach(function(r){r.conversion&&(o.push(findType(r.conversion.from).test),u.push(r.conversion.convert))}),u.length){case 0:return function(r){return r};case 1:return e=o[0],n=u[0],function(r){return e(r)?n(r):r};case 2:return e=o[0],t=o[1],n=u[0],a=u[1],function(r){return e(r)?n(r):t(r)?a(r):r};default:return function(r){for(let e=0;e<u.length;e++)if(o[e](r))return u[e](r);return r}}}function _onMismatch(r,e,t){throw createError(r,e,t)}function initial(r){return slice(r,0,r.length-1)}function last(r){return r[r.length-1]}function slice(r,e,t){return Array.prototype.slice.call(r,e,t)}function makeReferTo(r,e){return{referTo:{references:r,callback:e}}}function referToSelf(r){if("function"!=typeof r)throw TypeError("Callback function expected as first argument");return{referToSelf:{callback:r}}}function isReferTo(r){return r&&"object"==typeof r.referTo&&Array.isArray(r.referTo.references)&&"function"==typeof r.referTo.callback}function isReferToSelf(r){return r&&"object"==typeof r.referToSelf&&"function"==typeof r.referToSelf.callback}function checkName(r,e){if(!r)return e;if(e&&e!==r){let t=Error("Function names do not match (expected: "+r+", actual: "+e+")");throw t.data={actual:e,expected:r},t}return r}clear(),addTypes(n);let s=u;function _validateConversion(r){if(!r||"string"!=typeof r.from||"string"!=typeof r.to||"function"!=typeof r.convert)throw TypeError("Object with properties {from: string, to: string, convert: function} expected");if(r.to===r.from)throw SyntaxError('Illegal to define conversion from "'+r.from+'" to itself.')}return(u=function(r){let e="string"==typeof r,t=e?1:0,n=e?r:"",a={};for(let r=t;r<arguments.length;++r){let t;let o=arguments[r],u={};if("function"==typeof o?(t=o.name,"string"==typeof o.signature?u[o.signature]=o:isTypedFunction(o)&&(u=o.signatures)):isPlainObject(o)&&(u=o,e||(t=function(r){let e;for(let t in r)Object.prototype.hasOwnProperty.call(r,t)&&(isTypedFunction(r[t])||"string"==typeof r[t].signature)&&(e=checkName(e,r[t].name));return e}(o))),0===Object.keys(u).length){let e=TypeError("Argument to 'typed' at index "+r+" is not a (typed) function, nor an object with signatures as keys and functions as values.");throw e.data={index:r,argument:o},e}e||(n=checkName(n,t)),function(r,e){let t;for(t in e)if(Object.prototype.hasOwnProperty.call(e,t)){if(t in r&&e[t]!==r[t]){let n=Error('Signature "'+t+'" is defined twice');throw n.data={signature:t,sourceFunction:e[t],destFunction:r[t]},n}r[t]=e[t]}}(a,u)}return function(r,e){let t,n;if(u.createCount++,0===Object.keys(e).length)throw SyntaxError("No signatures provided");u.warnAgainstDeprecatedThis&&function(r){let e=/\bthis(\(|\.signatures\b)/;Object.keys(r).forEach(t=>{let n=r[t];if(e.test(n.toString()))throw SyntaxError("Using `this` to self-reference a function is deprecated since typed-function@3. Use typed.referTo and typed.referToSelf instead.")})}(e);let a=[],o=[],s={},c=[];for(t in e){let r;if(!Object.prototype.hasOwnProperty.call(e,t))continue;let n=parseSignature(t);if(!n)continue;a.forEach(function(r){if(function(r,e){let t=Math.max(r.length,e.length);for(let n=0;n<t;n++){let t;let a=getTypeSetAtIndex(r,n),o=getTypeSetAtIndex(e,n),u=!1;for(t of o)if(a.has(t)){u=!0;break}if(!u)return!1}let n=r.length,a=e.length,o=hasRestParam(r),u=hasRestParam(e);return o?u?n===a:a>=n:u?n>=a:n===a}(r,n))throw TypeError('Conflicting signatures "'+stringifyParams(r)+'" and "'+stringifyParams(n)+'".')}),a.push(n);let u=o.length;o.push(e[t]);let f=n.map(expandParam);for(r of function _splitParams(r,e,t){if(!(e<r.length))return[t];{var n,a;let o=r[e],u=[];if(o.restParam){let r=o.types.filter(isExactType);r.length<o.types.length&&u.push({types:r,name:"..."+r.map(r=>r.name).join("|"),hasAny:r.some(r=>r.isAny),hasConversion:!1,restParam:!0}),u.push(o)}else u=o.types.map(function(r){return{types:[r],name:r.name,hasAny:r.isAny,hasConversion:r.conversion,restParam:!1}});return n=u,a=function(n){return _splitParams(r,e+1,t.concat([n]))},Array.prototype.concat.apply([],n.map(a))}}(f,0,[])){let e=stringifyParams(r);c.push({params:r,name:e,fn:u}),r.every(r=>!r.hasConversion)&&(s[e]=u)}}c.sort(compareSignatures);let f=function(r,e,t){let n=r.map(r=>isReferToSelf(r)?referToSelf(r.referToSelf.callback):isReferTo(r)?makeReferTo(r.referTo.references,r.referTo.callback):r),a=Array(n.length).fill(!1),o=!0;for(;o;){o=!1;let r=!0;for(let u=0;u<n.length;++u){if(a[u])continue;let s=n[u];if(isReferToSelf(s))n[u]=s.referToSelf.callback(t),n[u].referToSelf=s.referToSelf,a[u]=!0,r=!1;else if(isReferTo(s)){let t=function(r,e,t){let n;let a=[];for(n of r){let r=t[n];if("number"!=typeof r)throw TypeError('No definition for referenced signature "'+n+'"');if("function"!=typeof(r=e[r]))return!1;a.push(r)}return a}(s.referTo.references,n,e);t?(n[u]=s.referTo.callback.apply(this,t),n[u].referTo=s.referTo,a[u]=!0,r=!1):o=!0}}if(r&&o)throw SyntaxError("Circular reference detected in resolving typed.referTo")}return n}(o,s,theTypedFn);for(n in s)Object.prototype.hasOwnProperty.call(s,n)&&(s[n]=f[s[n]]);let l=[],p=new Map;for(n of c)p.has(n.name)||(n.fn=f[n.fn],l.push(n),p.set(n.name,n));let m=l[0]&&l[0].params.length<=2&&!hasRestParam(l[0].params),h=l[1]&&l[1].params.length<=2&&!hasRestParam(l[1].params),d=l[2]&&l[2].params.length<=2&&!hasRestParam(l[2].params),g=l[3]&&l[3].params.length<=2&&!hasRestParam(l[3].params),v=l[4]&&l[4].params.length<=2&&!hasRestParam(l[4].params),D=l[5]&&l[5].params.length<=2&&!hasRestParam(l[5].params);for(let r=0;r<l.length;++r)l[r].test=function(r){let e,t,n;if(hasRestParam(r)){e=initial(r).map(compileTest);let t=e.length,n=compileTest(last(r)),testRestParam=function(r){for(let e=t;e<r.length;e++)if(!n(r[e]))return!1;return!0};return function(r){for(let t=0;t<e.length;t++)if(!e[t](r[t]))return!1;return testRestParam(r)&&r.length>=t+1}}return 0===r.length?function(r){return 0===r.length}:1===r.length?(t=compileTest(r[0]),function(r){return t(r[0])&&1===r.length}):2===r.length?(t=compileTest(r[0]),n=compileTest(r[1]),function(r){return t(r[0])&&n(r[1])&&2===r.length}):(e=r.map(compileTest),function(r){for(let t=0;t<e.length;t++)if(!e[t](r[t]))return!1;return r.length===e.length})}(l[r].params);let y=m?compileTest(l[0].params[0]):notOk,x=h?compileTest(l[1].params[0]):notOk,b=d?compileTest(l[2].params[0]):notOk,_=g?compileTest(l[3].params[0]):notOk,E=v?compileTest(l[4].params[0]):notOk,w=D?compileTest(l[5].params[0]):notOk,A=m?compileTest(l[0].params[1]):notOk,F=h?compileTest(l[1].params[1]):notOk,C=d?compileTest(l[2].params[1]):notOk,M=g?compileTest(l[3].params[1]):notOk,N=v?compileTest(l[4].params[1]):notOk,S=D?compileTest(l[5].params[1]):notOk;for(let r=0;r<l.length;++r)l[r].implementation=function(r,e){let t=e;if(r.some(r=>r.hasConversion)){let n=hasRestParam(r),a=r.map(compileArgConversion);t=function(){let r=[],t=n?arguments.length-1:arguments.length;for(let e=0;e<t;e++)r[e]=a[e](arguments[e]);return n&&(r[t]=arguments[t].map(a[t])),e.apply(this,r)}}let n=t;if(hasRestParam(r)){let e=r.length-1;n=function(){return t.apply(this,slice(arguments,0,e).concat([slice(arguments,e)]))}}return n}(l[r].params,l[r].fn);let B=m?l[0].implementation:undef,z=h?l[1].implementation:undef,T=d?l[2].implementation:undef,I=g?l[3].implementation:undef,O=v?l[4].implementation:undef,P=D?l[5].implementation:undef,j=m?l[0].params.length:-1,k=h?l[1].params.length:-1,q=d?l[2].params.length:-1,R=g?l[3].params.length:-1,U=v?l[4].params.length:-1,L=D?l[5].params.length:-1,Z=m&&h&&d&&g&&v&&D?6:0,V=l.length,H=l.map(r=>r.test),J=l.map(r=>r.implementation),generic=function(){for(let r=Z;r<V;r++)if(H[r](arguments))return J[r].apply(this,arguments);return u.onMismatch(r,arguments,l)};function theTypedFn(r,e){return arguments.length===j&&y(r)&&A(e)?B.apply(this,arguments):arguments.length===k&&x(r)&&F(e)?z.apply(this,arguments):arguments.length===q&&b(r)&&C(e)?T.apply(this,arguments):arguments.length===R&&_(r)&&M(e)?I.apply(this,arguments):arguments.length===U&&E(r)&&N(e)?O.apply(this,arguments):arguments.length===L&&w(r)&&S(e)?P.apply(this,arguments):generic.apply(this,arguments)}try{Object.defineProperty(theTypedFn,"name",{value:r})}catch(r){}return theTypedFn.signatures=s,theTypedFn._typedFunctionData={signatures:l,signatureMap:p},theTypedFn}(n||"",a)}).create=create,u.createCount=s.createCount,u.onMismatch=_onMismatch,u.throwMismatchError=_onMismatch,u.createError=createError,u.clear=clear,u.clearConversions=function(){let r;for(r of t)e.get(r).conversionsTo=[];o=0},u.addTypes=addTypes,u._findType=findType,u.referTo=function(){let r=initial(arguments).map(r=>stringifyParams(parseSignature(r))),e=last(arguments);if("function"!=typeof e)throw TypeError("Callback function expected as last argument");return makeReferTo(r,e)},u.referToSelf=referToSelf,u.convert=function(r,e){let t=findType(e);if(t.test(r))return r;let n=t.conversionsTo;if(0===n.length)throw Error("There are no conversions to "+e+" defined.");for(let e=0;e<n.length;e++){let t=findType(n[e].from);if(t.test(r))return n[e].convert(r)}throw Error("Cannot convert "+r+" to "+e)},u.findSignature=findSignature,u.find=function(r,e,t){return findSignature(r,e,t).implementation},u.isTypedFunction=isTypedFunction,u.warnAgainstDeprecatedThis=!0,u.addType=function(r,t){let n="any";!1!==t&&e.has("Object")&&(n="Object"),u.addTypes([r],n)},u.addConversion=function(r){_validateConversion(r);let e=findType(r.to);if(e.conversionsTo.every(function(e){return e.from!==r.from}))e.conversionsTo.push({from:r.from,convert:r.convert,index:o++});else throw Error('There is already a conversion from "'+r.from+'" to "'+e.name+'"')},u.addConversions=function(r){r.forEach(u.addConversion)},u.removeConversion=function(r){_validateConversion(r);let e=findType(r.to),t=function(r,e){for(let t=0;t<r.length;t++)if(e(r[t]))return r[t]}(e.conversionsTo,e=>e.from===r.from);if(!t)throw Error("Attempt to remove nonexistent conversion from "+r.from+" to "+r.to);if(t.convert!==r.convert)throw Error("Conversion to remove does not match existing conversion");let n=e.conversionsTo.indexOf(t);e.conversionsTo.splice(n,1)},u.resolve=function(e,t){if(!isTypedFunction(e))throw TypeError(r);let n=e._typedFunctionData.signatures;for(let r=0;r<n.length;++r)if(n[r].test(t))return n[r];return null},u}()}()},3513:function(r,e,t){"use strict";function _extends(){return(_extends=Object.assign?Object.assign.bind():function(r){for(var e=1;e<arguments.length;e++){var t=arguments[e];for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(r[n]=t[n])}return r}).apply(this,arguments)}t.d(e,{AKD:function(){return nU},J69:function(){return n8},C2o:function(){return n3},xJM:function(){return ny},KOy:function(){return n5},Rxh:function(){return no},h62:function(){return nl}});var n={epsilon:1e-12,matrix:"Matrix",number:"number",precision:64,predictable:!1,randomSeed:null},config=function(r){if(r)throw Error("The global config is readonly. \nPlease create a mathjs instance if you want to change the default configuration. \nExample:\n\n  import { create, all } from 'mathjs';\n  const mathjs = create(all);\n  mathjs.config({ number: 'BigNumber' });\n");return Object.freeze(n)};_extends(config,n,{MATRIX_OPTIONS:["Matrix","Array"],NUMBER_OPTIONS:["number","BigNumber","Fraction"]});/*!
 *  decimal.js v10.4.3
 *  An arbitrary-precision Decimal type for JavaScript.
 *  https://github.com/MikeMcl/decimal.js
 *  Copyright (c) 2022 Michael Mclaughlin <M8ch88l@gmail.com>
 *  MIT Licence
 */var a,o,u="0123456789abcdef",s="2.3025850929940456840179914546843642076011014886287729760333279009675726096773524802359972050895982983419677840422862486334095254650828067566662873690987816894829072083255546808437998948262331985283935053089653777326288461633662222876982198867465436674744042432743651550489343149393914796194044002221051017141748003688084012647080685567743216228355220114804663715659121373450747856947683463616792101806445070648000277502684916746550586856935673420670581136429224554405758925724208241314695689016758940256776311356919292033376587141660230105703089634572075440370847469940168269282808481184289314848524948644871927809676271275775397027668605952496716674183485704422507197965004714951050492214776567636938662976979522110718264549734772662425709429322582798502585509785265383207606726317164309505995087807523710333101197857547331541421808427543863591778117054309827482385045648019095610299291824318237525357709750539565187697510374970888692180205189339507238539205144634197265287286965110862571492198849978748873771345686209167058",c="3.1415926535897932384626433832795028841971693993751058209749445923078164062862089986280348253421170679821480865132823066470938446095505822317253594081284811174502841027019385211055596446229489549303819644288109756659334461284756482337867831652712019091456485669234603486104543266482133936072602491412737245870066063155881748815209209628292540917153643678925903600113305305488204665213841469519415116094330572703657595919530921861173819326117931051185480744623799627495673518857527248912279381830119491298336733624406566430860213949463952247371907021798609437027705392171762931767523846748184676694051320005681271452635608277857713427577896091736371787214684409012249534301465495853710507922796892589235420199561121290219608640344181598136297747713099605187072113499999983729780499510597317328160963185950244594553469083026425223082533446850352619311881710100031378387528865875332083814206171776691473035982534904287554687311595628638823537875937519577818577805321712268066130019278766111959092164201989380952572010654858632789",f={precision:20,rounding:4,modulo:1,toExpNeg:-7,toExpPos:21,minE:-9e15,maxE:9e15,crypto:!1},l=!0,p="[DecimalError] ",m=p+"Invalid argument: ",h=p+"Precision limit exceeded",d=p+"crypto unavailable",g="[object Decimal]",v=Math.floor,D=Math.pow,y=/^0b([01]+(\.[01]*)?|\.[01]+)(p[+-]?\d+)?$/i,x=/^0x([0-9a-f]+(\.[0-9a-f]*)?|\.[0-9a-f]+)(p[+-]?\d+)?$/i,b=/^0o([0-7]+(\.[0-7]*)?|\.[0-7]+)(p[+-]?\d+)?$/i,_=/^(\d+(\.\d*)?|\.\d+)(e[+-]?\d+)?$/i,E=s.length-1,w=c.length-1,A={toStringTag:g};function digitsToString(r){var e,t,n,a=r.length-1,o="",u=r[0];if(a>0){for(o+=u,e=1;e<a;e++)(t=7-(n=r[e]+"").length)&&(o+=getZeroString(t)),o+=n;(t=7-(n=(u=r[e])+"").length)&&(o+=getZeroString(t))}else if(0===u)return"0";for(;u%10==0;)u/=10;return o+u}function checkInt32(r,e,t){if(r!==~~r||r<e||r>t)throw Error(m+r)}function checkRoundingDigits(r,e,t,n){var a,o,u,s;for(o=r[0];o>=10;o/=10)--e;return--e<0?(e+=7,a=0):(a=Math.ceil((e+1)/7),e%=7),o=D(10,7-e),s=r[a]%o|0,null==n?e<3?(0==e?s=s/100|0:1==e&&(s=s/10|0),u=t<4&&99999==s||t>3&&49999==s||5e4==s||0==s):u=(t<4&&s+1==o||t>3&&s+1==o/2)&&(r[a+1]/o/100|0)==D(10,e-2)-1||(s==o/2||0==s)&&(r[a+1]/o/100|0)==0:e<4?(0==e?s=s/1e3|0:1==e?s=s/100|0:2==e&&(s=s/10|0),u=(n||t<4)&&9999==s||!n&&t>3&&4999==s):u=((n||t<4)&&s+1==o||!n&&t>3&&s+1==o/2)&&(r[a+1]/o/1e3|0)==D(10,e-3)-1,u}function convertBase(r,e,t){for(var n,a,o=[0],s=0,c=r.length;s<c;){for(a=o.length;a--;)o[a]*=e;for(o[0]+=u.indexOf(r.charAt(s++)),n=0;n<o.length;n++)o[n]>t-1&&(void 0===o[n+1]&&(o[n+1]=0),o[n+1]+=o[n]/t|0,o[n]%=t)}return o.reverse()}A.absoluteValue=A.abs=function(){var r=new this.constructor(this);return r.s<0&&(r.s=1),finalise(r)},A.ceil=function(){return finalise(new this.constructor(this),this.e+1,2)},A.clampedTo=A.clamp=function(r,e){var t=this.constructor;if(r=new t(r),e=new t(e),!r.s||!e.s)return new t(NaN);if(r.gt(e))throw Error(m+e);return 0>this.cmp(r)?r:this.cmp(e)>0?e:new t(this)},A.comparedTo=A.cmp=function(r){var e,t,n,a,o=this.d,u=(r=new this.constructor(r)).d,s=this.s,c=r.s;if(!o||!u)return s&&c?s!==c?s:o===u?0:!o^s<0?1:-1:NaN;if(!o[0]||!u[0])return o[0]?s:u[0]?-c:0;if(s!==c)return s;if(this.e!==r.e)return this.e>r.e^s<0?1:-1;for(e=0,t=(n=o.length)<(a=u.length)?n:a;e<t;++e)if(o[e]!==u[e])return o[e]>u[e]^s<0?1:-1;return n===a?0:n>a^s<0?1:-1},A.cosine=A.cos=function(){var r,e,t=this,n=t.constructor;return t.d?t.d[0]?(r=n.precision,e=n.rounding,n.precision=r+Math.max(t.e,t.sd())+7,n.rounding=1,t=function(r,e){var t,n,a;if(e.isZero())return e;(n=e.d.length)<32?a=(1/tinyPow(4,t=Math.ceil(n/3))).toString():(t=16,a="2.3283064365386962890625e-10"),r.precision+=t,e=taylorSeries(r,1,e.times(a),new r(1));for(var o=t;o--;){var u=e.times(e);e=u.times(u).minus(u).times(8).plus(1)}return r.precision-=t,e}(n,toLessThanHalfPi(n,t)),n.precision=r,n.rounding=e,finalise(2==o||3==o?t.neg():t,r,e,!0)):new n(1):new n(NaN)},A.cubeRoot=A.cbrt=function(){var r,e,t,n,a,o,u,s,c,f,p=this.constructor;if(!this.isFinite()||this.isZero())return new p(this);for(l=!1,(o=this.s*D(this.s*this,1/3))&&Math.abs(o)!=1/0?n=new p(o.toString()):(t=digitsToString(this.d),(o=((r=this.e)-t.length+1)%3)&&(t+=1==o||-2==o?"0":"00"),o=D(t,1/3),r=v((r+1)/3)-(r%3==(r<0?-1:2)),t=o==1/0?"5e"+r:(t=o.toExponential()).slice(0,t.indexOf("e")+1)+r,(n=new p(t)).s=this.s),u=(r=p.precision)+3;;)if(n=F((f=(c=(s=n).times(s).times(s)).plus(this)).plus(this).times(s),f.plus(c),u+2,1),digitsToString(s.d).slice(0,u)===(t=digitsToString(n.d)).slice(0,u)){if("9999"!=(t=t.slice(u-3,u+1))&&(a||"4999"!=t)){+t&&(+t.slice(1)||"5"!=t.charAt(0))||(finalise(n,r+1,1),e=!n.times(n).times(n).eq(this));break}if(!a&&(finalise(s,r+1,0),s.times(s).times(s).eq(this))){n=s;break}u+=4,a=1}return l=!0,finalise(n,r,p.rounding,e)},A.decimalPlaces=A.dp=function(){var r,e=this.d,t=NaN;if(e){if(t=((r=e.length-1)-v(this.e/7))*7,r=e[r])for(;r%10==0;r/=10)t--;t<0&&(t=0)}return t},A.dividedBy=A.div=function(r){return F(this,new this.constructor(r))},A.dividedToIntegerBy=A.divToInt=function(r){var e=this.constructor;return finalise(F(this,new e(r),0,1,1),e.precision,e.rounding)},A.equals=A.eq=function(r){return 0===this.cmp(r)},A.floor=function(){return finalise(new this.constructor(this),this.e+1,3)},A.greaterThan=A.gt=function(r){return this.cmp(r)>0},A.greaterThanOrEqualTo=A.gte=function(r){var e=this.cmp(r);return 1==e||0===e},A.hyperbolicCosine=A.cosh=function(){var r,e,t,n,a,o=this,u=o.constructor,s=new u(1);if(!o.isFinite())return new u(o.s?1/0:NaN);if(o.isZero())return s;t=u.precision,n=u.rounding,u.precision=t+Math.max(o.e,o.sd())+4,u.rounding=1,(a=o.d.length)<32?e=(1/tinyPow(4,r=Math.ceil(a/3))).toString():(r=16,e="2.3283064365386962890625e-10"),o=taylorSeries(u,1,o.times(e),new u(1),!0);for(var c,f=r,l=new u(8);f--;)c=o.times(o),o=s.minus(c.times(l.minus(c.times(l))));return finalise(o,u.precision=t,u.rounding=n,!0)},A.hyperbolicSine=A.sinh=function(){var r,e,t,n,a=this,o=a.constructor;if(!a.isFinite()||a.isZero())return new o(a);if(e=o.precision,t=o.rounding,o.precision=e+Math.max(a.e,a.sd())+4,o.rounding=1,(n=a.d.length)<3)a=taylorSeries(o,2,a,a,!0);else{r=(r=1.4*Math.sqrt(n))>16?16:0|r,a=taylorSeries(o,2,a=a.times(1/tinyPow(5,r)),a,!0);for(var u,s=new o(5),c=new o(16),f=new o(20);r--;)u=a.times(a),a=a.times(s.plus(u.times(c.times(u).plus(f))))}return o.precision=e,o.rounding=t,finalise(a,e,t,!0)},A.hyperbolicTangent=A.tanh=function(){var r,e,t=this.constructor;return this.isFinite()?this.isZero()?new t(this):(r=t.precision,e=t.rounding,t.precision=r+7,t.rounding=1,F(this.sinh(),this.cosh(),t.precision=r,t.rounding=e)):new t(this.s)},A.inverseCosine=A.acos=function(){var r,e=this,t=e.constructor,n=e.abs().cmp(1),a=t.precision,o=t.rounding;return -1!==n?0===n?e.isNeg()?getPi(t,a,o):new t(0):new t(NaN):e.isZero()?getPi(t,a+4,o).times(.5):(t.precision=a+6,t.rounding=1,e=e.asin(),r=getPi(t,a+4,o).times(.5),t.precision=a,t.rounding=o,r.minus(e))},A.inverseHyperbolicCosine=A.acosh=function(){var r,e,t=this,n=t.constructor;return t.lte(1)?new n(t.eq(1)?0:NaN):t.isFinite()?(r=n.precision,e=n.rounding,n.precision=r+Math.max(Math.abs(t.e),t.sd())+4,n.rounding=1,l=!1,t=t.times(t).minus(1).sqrt().plus(t),l=!0,n.precision=r,n.rounding=e,t.ln()):new n(t)},A.inverseHyperbolicSine=A.asinh=function(){var r,e,t=this,n=t.constructor;return!t.isFinite()||t.isZero()?new n(t):(r=n.precision,e=n.rounding,n.precision=r+2*Math.max(Math.abs(t.e),t.sd())+6,n.rounding=1,l=!1,t=t.times(t).plus(1).sqrt().plus(t),l=!0,n.precision=r,n.rounding=e,t.ln())},A.inverseHyperbolicTangent=A.atanh=function(){var r,e,t,n,a=this,o=a.constructor;return a.isFinite()?a.e>=0?new o(a.abs().eq(1)?a.s/0:a.isZero()?a:NaN):(r=o.precision,e=o.rounding,Math.max(n=a.sd(),r)<-(2*a.e)-1)?finalise(new o(a),r,e,!0):(o.precision=t=n-a.e,a=F(a.plus(1),new o(1).minus(a),t+r,1),o.precision=r+4,o.rounding=1,a=a.ln(),o.precision=r,o.rounding=e,a.times(.5)):new o(NaN)},A.inverseSine=A.asin=function(){var r,e,t,n,a=this,o=a.constructor;return a.isZero()?new o(a):(e=a.abs().cmp(1),t=o.precision,n=o.rounding,-1!==e)?0===e?((r=getPi(o,t+4,n).times(.5)).s=a.s,r):new o(NaN):(o.precision=t+6,o.rounding=1,a=a.div(new o(1).minus(a.times(a)).sqrt().plus(1)).atan(),o.precision=t,o.rounding=n,a.times(2))},A.inverseTangent=A.atan=function(){var r,e,t,n,a,o,u,s,c,f=this,p=f.constructor,m=p.precision,h=p.rounding;if(f.isFinite()){if(f.isZero())return new p(f);if(f.abs().eq(1)&&m+4<=w)return(u=getPi(p,m+4,h).times(.25)).s=f.s,u}else{if(!f.s)return new p(NaN);if(m+4<=w)return(u=getPi(p,m+4,h).times(.5)).s=f.s,u}for(p.precision=s=m+10,p.rounding=1,r=t=Math.min(28,s/7+2|0);r;--r)f=f.div(f.times(f).plus(1).sqrt().plus(1));for(l=!1,e=Math.ceil(s/7),n=1,c=f.times(f),u=new p(f),a=f;-1!==r;)if(a=a.times(c),o=u.minus(a.div(n+=2)),a=a.times(c),void 0!==(u=o.plus(a.div(n+=2))).d[e])for(r=e;u.d[r]===o.d[r]&&r--;);return t&&(u=u.times(2<<t-1)),l=!0,finalise(u,p.precision=m,p.rounding=h,!0)},A.isFinite=function(){return!!this.d},A.isInteger=A.isInt=function(){return!!this.d&&v(this.e/7)>this.d.length-2},A.isNaN=function(){return!this.s},A.isNegative=A.isNeg=function(){return this.s<0},A.isPositive=A.isPos=function(){return this.s>0},A.isZero=function(){return!!this.d&&0===this.d[0]},A.lessThan=A.lt=function(r){return 0>this.cmp(r)},A.lessThanOrEqualTo=A.lte=function(r){return 1>this.cmp(r)},A.logarithm=A.log=function(r){var e,t,n,a,o,u,s,c=this.constructor,f=c.precision,p=c.rounding;if(null==r)r=new c(10),e=!0;else{if(t=(r=new c(r)).d,r.s<0||!t||!t[0]||r.eq(1))return new c(NaN);e=r.eq(10)}if(t=this.d,this.s<0||!t||!t[0]||this.eq(1))return new c(t&&!t[0]?-1/0:1!=this.s?NaN:t?0:1/0);if(e){if(t.length>1)a=!0;else{for(n=t[0];n%10==0;)n/=10;a=1!==n}}if(l=!1,checkRoundingDigits((s=F(naturalLogarithm(this,u=f+5),e?getLn10(c,u+10):naturalLogarithm(r,u),u,1)).d,n=f,p))do if(u+=10,s=F(naturalLogarithm(this,u),e?getLn10(c,u+10):naturalLogarithm(r,u),u,1),!a){+digitsToString(s.d).slice(n+1,n+15)+1==1e14&&(s=finalise(s,f+1,0));break}while(checkRoundingDigits(s.d,n+=10,p));return l=!0,finalise(s,f,p)},A.minus=A.sub=function(r){var e,t,n,a,o,u,s,c,f,p,m,h,d=this.constructor;if(r=new d(r),!this.d||!r.d)return this.s&&r.s?this.d?r.s=-r.s:r=new d(r.d||this.s!==r.s?this:NaN):r=new d(NaN),r;if(this.s!=r.s)return r.s=-r.s,this.plus(r);if(f=this.d,h=r.d,s=d.precision,c=d.rounding,!f[0]||!h[0]){if(h[0])r.s=-r.s;else{if(!f[0])return new d(3===c?-0:0);r=new d(this)}return l?finalise(r,s,c):r}if(t=v(r.e/7),p=v(this.e/7),f=f.slice(),o=p-t){for((m=o<0)?(e=f,o=-o,u=h.length):(e=h,t=p,u=f.length),o>(n=Math.max(Math.ceil(s/7),u)+2)&&(o=n,e.length=1),e.reverse(),n=o;n--;)e.push(0);e.reverse()}else{for((m=(n=f.length)<(u=h.length))&&(u=n),n=0;n<u;n++)if(f[n]!=h[n]){m=f[n]<h[n];break}o=0}for(m&&(e=f,f=h,h=e,r.s=-r.s),u=f.length,n=h.length-u;n>0;--n)f[u++]=0;for(n=h.length;n>o;){if(f[--n]<h[n]){for(a=n;a&&0===f[--a];)f[a]=1e7-1;--f[a],f[n]+=1e7}f[n]-=h[n]}for(;0===f[--u];)f.pop();for(;0===f[0];f.shift())--t;return f[0]?(r.d=f,r.e=getBase10Exponent(f,t),l?finalise(r,s,c):r):new d(3===c?-0:0)},A.modulo=A.mod=function(r){var e,t=this.constructor;return(r=new t(r),this.d&&r.s&&(!r.d||r.d[0]))?r.d&&(!this.d||this.d[0])?(l=!1,9==t.modulo?(e=F(this,r.abs(),0,3,1),e.s*=r.s):e=F(this,r,0,t.modulo,1),e=e.times(r),l=!0,this.minus(e)):finalise(new t(this),t.precision,t.rounding):new t(NaN)},A.naturalExponential=A.exp=function(){return naturalExponential(this)},A.naturalLogarithm=A.ln=function(){return naturalLogarithm(this)},A.negated=A.neg=function(){var r=new this.constructor(this);return r.s=-r.s,finalise(r)},A.plus=A.add=function(r){var e,t,n,a,o,u,s,c,f,p,m=this.constructor;if(r=new m(r),!this.d||!r.d)return this.s&&r.s?this.d||(r=new m(r.d||this.s===r.s?this:NaN)):r=new m(NaN),r;if(this.s!=r.s)return r.s=-r.s,this.minus(r);if(f=this.d,p=r.d,s=m.precision,c=m.rounding,!f[0]||!p[0])return p[0]||(r=new m(this)),l?finalise(r,s,c):r;if(o=v(this.e/7),n=v(r.e/7),f=f.slice(),a=o-n){for(a<0?(t=f,a=-a,u=p.length):(t=p,n=o,u=f.length),a>(u=(o=Math.ceil(s/7))>u?o+1:u+1)&&(a=u,t.length=1),t.reverse();a--;)t.push(0);t.reverse()}for((u=f.length)-(a=p.length)<0&&(a=u,t=p,p=f,f=t),e=0;a;)e=(f[--a]=f[a]+p[a]+e)/1e7|0,f[a]%=1e7;for(e&&(f.unshift(e),++n),u=f.length;0==f[--u];)f.pop();return r.d=f,r.e=getBase10Exponent(f,n),l?finalise(r,s,c):r},A.precision=A.sd=function(r){var e;if(void 0!==r&&!!r!==r&&1!==r&&0!==r)throw Error(m+r);return this.d?(e=getPrecision(this.d),r&&this.e+1>e&&(e=this.e+1)):e=NaN,e},A.round=function(){var r=this.constructor;return finalise(new r(this),this.e+1,r.rounding)},A.sine=A.sin=function(){var r,e,t=this,n=t.constructor;return t.isFinite()?t.isZero()?new n(t):(r=n.precision,e=n.rounding,n.precision=r+Math.max(t.e,t.sd())+7,n.rounding=1,t=function(r,e){var t,n=e.d.length;if(n<3)return e.isZero()?e:taylorSeries(r,2,e,e);t=(t=1.4*Math.sqrt(n))>16?16:0|t,e=taylorSeries(r,2,e=e.times(1/tinyPow(5,t)),e);for(var a,o=new r(5),u=new r(16),s=new r(20);t--;)a=e.times(e),e=e.times(o.plus(a.times(u.times(a).minus(s))));return e}(n,toLessThanHalfPi(n,t)),n.precision=r,n.rounding=e,finalise(o>2?t.neg():t,r,e,!0)):new n(NaN)},A.squareRoot=A.sqrt=function(){var r,e,t,n,a,o,u=this.d,s=this.e,c=this.s,f=this.constructor;if(1!==c||!u||!u[0])return new f(!c||c<0&&(!u||u[0])?NaN:u?this:1/0);for(l=!1,0==(c=Math.sqrt(+this))||c==1/0?(((e=digitsToString(u)).length+s)%2==0&&(e+="0"),c=Math.sqrt(e),s=v((s+1)/2)-(s<0||s%2),e=c==1/0?"5e"+s:(e=c.toExponential()).slice(0,e.indexOf("e")+1)+s,n=new f(e)):n=new f(c.toString()),t=(s=f.precision)+3;;)if(n=(o=n).plus(F(this,o,t+2,1)).times(.5),digitsToString(o.d).slice(0,t)===(e=digitsToString(n.d)).slice(0,t)){if("9999"!=(e=e.slice(t-3,t+1))&&(a||"4999"!=e)){+e&&(+e.slice(1)||"5"!=e.charAt(0))||(finalise(n,s+1,1),r=!n.times(n).eq(this));break}if(!a&&(finalise(o,s+1,0),o.times(o).eq(this))){n=o;break}t+=4,a=1}return l=!0,finalise(n,s,f.rounding,r)},A.tangent=A.tan=function(){var r,e,t=this,n=t.constructor;return t.isFinite()?t.isZero()?new n(t):(r=n.precision,e=n.rounding,n.precision=r+10,n.rounding=1,(t=t.sin()).s=1,t=F(t,new n(1).minus(t.times(t)).sqrt(),r+10,0),n.precision=r,n.rounding=e,finalise(2==o||4==o?t.neg():t,r,e,!0)):new n(NaN)},A.times=A.mul=function(r){var e,t,n,a,o,u,s,c,f,p=this.constructor,m=this.d,h=(r=new p(r)).d;if(r.s*=this.s,!m||!m[0]||!h||!h[0])return new p(r.s&&(!m||m[0]||h)&&(!h||h[0]||m)?m&&h?0*r.s:r.s/0:NaN);for(t=v(this.e/7)+v(r.e/7),(c=m.length)<(f=h.length)&&(o=m,m=h,h=o,u=c,c=f,f=u),o=[],n=u=c+f;n--;)o.push(0);for(n=f;--n>=0;){for(e=0,a=c+n;a>n;)s=o[a]+h[n]*m[a-n-1]+e,o[a--]=s%1e7|0,e=s/1e7|0;o[a]=(o[a]+e)%1e7|0}for(;!o[--u];)o.pop();return e?++t:o.shift(),r.d=o,r.e=getBase10Exponent(o,t),l?finalise(r,p.precision,p.rounding):r},A.toBinary=function(r,e){return toStringBinary(this,2,r,e)},A.toDecimalPlaces=A.toDP=function(r,e){var t=this,n=t.constructor;return(t=new n(t),void 0===r)?t:(checkInt32(r,0,1e9),void 0===e?e=n.rounding:checkInt32(e,0,8),finalise(t,r+t.e+1,e))},A.toExponential=function(r,e){var t,n=this,a=n.constructor;return void 0===r?t=finiteToString(n,!0):(checkInt32(r,0,1e9),void 0===e?e=a.rounding:checkInt32(e,0,8),t=finiteToString(n=finalise(new a(n),r+1,e),!0,r+1)),n.isNeg()&&!n.isZero()?"-"+t:t},A.toFixed=function(r,e){var t,n,a=this.constructor;return void 0===r?t=finiteToString(this):(checkInt32(r,0,1e9),void 0===e?e=a.rounding:checkInt32(e,0,8),t=finiteToString(n=finalise(new a(this),r+this.e+1,e),!1,r+n.e+1)),this.isNeg()&&!this.isZero()?"-"+t:t},A.toFraction=function(r){var e,t,n,a,o,u,s,c,f,p,h,d,g=this.d,v=this.constructor;if(!g)return new v(this);if(f=t=new v(1),n=c=new v(0),u=(o=(e=new v(n)).e=getPrecision(g)-this.e-1)%7,e.d[0]=D(10,u<0?7+u:u),null==r)r=o>0?e:f;else{if(!(s=new v(r)).isInt()||s.lt(f))throw Error(m+s);r=s.gt(e)?o>0?e:f:s}for(l=!1,s=new v(digitsToString(g)),p=v.precision,v.precision=o=14*g.length;h=F(s,e,0,1,1),1!=(a=t.plus(h.times(n))).cmp(r);)t=n,n=a,a=f,f=c.plus(h.times(a)),c=a,a=e,e=s.minus(h.times(a)),s=a;return a=F(r.minus(t),n,0,1,1),c=c.plus(a.times(f)),t=t.plus(a.times(n)),c.s=f.s=this.s,d=1>F(f,n,o,1).minus(this).abs().cmp(F(c,t,o,1).minus(this).abs())?[f,n]:[c,t],v.precision=p,l=!0,d},A.toHexadecimal=A.toHex=function(r,e){return toStringBinary(this,16,r,e)},A.toNearest=function(r,e){var t=this,n=t.constructor;if(t=new n(t),null==r){if(!t.d)return t;r=new n(1),e=n.rounding}else{if(r=new n(r),void 0===e?e=n.rounding:checkInt32(e,0,8),!t.d)return r.s?t:r;if(!r.d)return r.s&&(r.s=t.s),r}return r.d[0]?(l=!1,t=F(t,r,0,e,1).times(r),l=!0,finalise(t)):(r.s=t.s,t=r),t},A.toNumber=function(){return+this},A.toOctal=function(r,e){return toStringBinary(this,8,r,e)},A.toPower=A.pow=function(r){var e,t,n,a,o,u,s=this,c=s.constructor,f=+(r=new c(r));if(!s.d||!r.d||!s.d[0]||!r.d[0])return new c(D(+s,f));if((s=new c(s)).eq(1))return s;if(n=c.precision,o=c.rounding,r.eq(1))return finalise(s,n,o);if((e=v(r.e/7))>=r.d.length-1&&(t=f<0?-f:f)<=9007199254740991)return a=intPow(c,s,t,n),r.s<0?new c(1).div(a):finalise(a,n,o);if((u=s.s)<0){if(e<r.d.length-1)return new c(NaN);if((1&r.d[e])==0&&(u=1),0==s.e&&1==s.d[0]&&1==s.d.length)return s.s=u,s}return(e=0!=(t=D(+s,f))&&isFinite(t)?new c(t+"").e:v(f*(Math.log("0."+digitsToString(s.d))/Math.LN10+s.e+1)))>c.maxE+1||e<c.minE-1?new c(e>0?u/0:0):(l=!1,c.rounding=s.s=1,t=Math.min(12,(e+"").length),(a=naturalExponential(r.times(naturalLogarithm(s,n+t)),n)).d&&checkRoundingDigits((a=finalise(a,n+5,1)).d,n,o)&&(e=n+10,+digitsToString((a=finalise(naturalExponential(r.times(naturalLogarithm(s,e+t)),e),e+5,1)).d).slice(n+1,n+15)+1==1e14&&(a=finalise(a,n+1,0))),a.s=u,l=!0,c.rounding=o,finalise(a,n,o))},A.toPrecision=function(r,e){var t,n=this,a=n.constructor;return void 0===r?t=finiteToString(n,n.e<=a.toExpNeg||n.e>=a.toExpPos):(checkInt32(r,1,1e9),void 0===e?e=a.rounding:checkInt32(e,0,8),t=finiteToString(n=finalise(new a(n),r,e),r<=n.e||n.e<=a.toExpNeg,r)),n.isNeg()&&!n.isZero()?"-"+t:t},A.toSignificantDigits=A.toSD=function(r,e){var t=this.constructor;return void 0===r?(r=t.precision,e=t.rounding):(checkInt32(r,1,1e9),void 0===e?e=t.rounding:checkInt32(e,0,8)),finalise(new t(this),r,e)},A.toString=function(){var r=this.constructor,e=finiteToString(this,this.e<=r.toExpNeg||this.e>=r.toExpPos);return this.isNeg()&&!this.isZero()?"-"+e:e},A.truncated=A.trunc=function(){return finalise(new this.constructor(this),this.e+1,1)},A.valueOf=A.toJSON=function(){var r=this.constructor,e=finiteToString(this,this.e<=r.toExpNeg||this.e>=r.toExpPos);return this.isNeg()?"-"+e:e};var F=function(){function multiplyInteger(r,e,t){var n,a=0,o=r.length;for(r=r.slice();o--;)n=r[o]*e+a,r[o]=n%t|0,a=n/t|0;return a&&r.unshift(a),r}function compare(r,e,t,n){var a,o;if(t!=n)o=t>n?1:-1;else for(a=o=0;a<t;a++)if(r[a]!=e[a]){o=r[a]>e[a]?1:-1;break}return o}function subtract(r,e,t,n){for(var a=0;t--;)r[t]-=a,a=r[t]<e[t]?1:0,r[t]=a*n+r[t]-e[t];for(;!r[0]&&r.length>1;)r.shift()}return function(r,e,t,n,o,u){var s,c,f,l,p,m,h,d,g,D,y,x,b,_,E,w,A,F,C,M,N=r.constructor,S=r.s==e.s?1:-1,B=r.d,z=e.d;if(!B||!B[0]||!z||!z[0])return new N(r.s&&e.s&&(B?!z||B[0]!=z[0]:z)?B&&0==B[0]||!z?0*S:S/0:NaN);for(u?(p=1,c=r.e-e.e):(u=1e7,p=7,c=v(r.e/p)-v(e.e/p)),C=z.length,A=B.length,D=(g=new N(S)).d=[],f=0;z[f]==(B[f]||0);f++);if(z[f]>(B[f]||0)&&c--,null==t?(_=t=N.precision,n=N.rounding):_=o?t+(r.e-e.e)+1:t,_<0)D.push(1),m=!0;else{if(_=_/p+2|0,f=0,1==C){for(l=0,z=z[0],_++;(f<A||l)&&_--;f++)E=l*u+(B[f]||0),D[f]=E/z|0,l=E%z|0;m=l||f<A}else{for((l=u/(z[0]+1)|0)>1&&(z=multiplyInteger(z,l,u),B=multiplyInteger(B,l,u),C=z.length,A=B.length),w=C,x=(y=B.slice(0,C)).length;x<C;)y[x++]=0;(M=z.slice()).unshift(0),F=z[0],z[1]>=u/2&&++F;do l=0,(s=compare(z,y,C,x))<0?(b=y[0],C!=x&&(b=b*u+(y[1]||0)),(l=b/F|0)>1?(l>=u&&(l=u-1),d=(h=multiplyInteger(z,l,u)).length,x=y.length,1==(s=compare(h,y,d,x))&&(l--,subtract(h,C<d?M:z,d,u))):(0==l&&(s=l=1),h=z.slice()),(d=h.length)<x&&h.unshift(0),subtract(y,h,x,u),-1==s&&(x=y.length,(s=compare(z,y,C,x))<1&&(l++,subtract(y,C<x?M:z,x,u))),x=y.length):0===s&&(l++,y=[0]),D[f++]=l,s&&y[0]?y[x++]=B[w]||0:(y=[B[w]],x=1);while((w++<A||void 0!==y[0])&&_--);m=void 0!==y[0]}D[0]||D.shift()}if(1==p)g.e=c,a=m;else{for(f=1,l=D[0];l>=10;l/=10)f++;g.e=f+c*p-1,finalise(g,o?t+g.e+1:t,n,m)}return g}}();function finalise(r,e,t,n){var a,o,u,s,c,f,p,m,h,d=r.constructor;r:if(null!=e){if(!(m=r.d))return r;for(a=1,s=m[0];s>=10;s/=10)a++;if((o=e-a)<0)o+=7,u=e,c=(p=m[h=0])/D(10,a-u-1)%10|0;else if((h=Math.ceil((o+1)/7))>=(s=m.length)){if(n){for(;s++<=h;)m.push(0);p=c=0,a=1,o%=7,u=o-7+1}else break r}else{for(a=1,p=s=m[h];s>=10;s/=10)a++;o%=7,c=(u=o-7+a)<0?0:p/D(10,a-u-1)%10|0}if(n=n||e<0||void 0!==m[h+1]||(u<0?p:p%D(10,a-u-1)),f=t<4?(c||n)&&(0==t||t==(r.s<0?3:2)):c>5||5==c&&(4==t||n||6==t&&(o>0?u>0?p/D(10,a-u):0:m[h-1])%10&1||t==(r.s<0?8:7)),e<1||!m[0])return m.length=0,f?(e-=r.e+1,m[0]=D(10,(7-e%7)%7),r.e=-e||0):m[0]=r.e=0,r;if(0==o?(m.length=h,s=1,h--):(m.length=h+1,s=D(10,7-o),m[h]=u>0?(p/D(10,a-u)%D(10,u)|0)*s:0),f)for(;;){if(0==h){for(o=1,u=m[0];u>=10;u/=10)o++;for(u=m[0]+=s,s=1;u>=10;u/=10)s++;o!=s&&(r.e++,1e7==m[0]&&(m[0]=1));break}if(m[h]+=s,1e7!=m[h])break;m[h--]=0,s=1}for(o=m.length;0===m[--o];)m.pop()}return l&&(r.e>d.maxE?(r.d=null,r.e=NaN):r.e<d.minE&&(r.e=0,r.d=[0])),r}function finiteToString(r,e,t){if(!r.isFinite())return nonFiniteToString(r);var n,a=r.e,o=digitsToString(r.d),u=o.length;return e?(t&&(n=t-u)>0?o=o.charAt(0)+"."+o.slice(1)+getZeroString(n):u>1&&(o=o.charAt(0)+"."+o.slice(1)),o=o+(r.e<0?"e":"e+")+r.e):a<0?(o="0."+getZeroString(-a-1)+o,t&&(n=t-u)>0&&(o+=getZeroString(n))):a>=u?(o+=getZeroString(a+1-u),t&&(n=t-a-1)>0&&(o=o+"."+getZeroString(n))):((n=a+1)<u&&(o=o.slice(0,n)+"."+o.slice(n)),t&&(n=t-u)>0&&(a+1===u&&(o+="."),o+=getZeroString(n))),o}function getBase10Exponent(r,e){var t=r[0];for(e*=7;t>=10;t/=10)e++;return e}function getLn10(r,e,t){if(e>E)throw l=!0,t&&(r.precision=t),Error(h);return finalise(new r(s),e,1,!0)}function getPi(r,e,t){if(e>w)throw Error(h);return finalise(new r(c),e,t,!0)}function getPrecision(r){var e=r.length-1,t=7*e+1;if(e=r[e]){for(;e%10==0;e/=10)t--;for(e=r[0];e>=10;e/=10)t++}return t}function getZeroString(r){for(var e="";r--;)e+="0";return e}function intPow(r,e,t,n){var a,o=new r(1),u=Math.ceil(n/7+4);for(l=!1;;){if(t%2&&truncate((o=o.times(e)).d,u)&&(a=!0),0===(t=v(t/2))){t=o.d.length-1,a&&0===o.d[t]&&++o.d[t];break}truncate((e=e.times(e)).d,u)}return l=!0,o}function isOdd(r){return 1&r.d[r.d.length-1]}function maxOrMin(r,e,t){for(var n,a=new r(e[0]),o=0;++o<e.length;)if((n=new r(e[o])).s)a[t](n)&&(a=n);else{a=n;break}return a}function naturalExponential(r,e){var t,n,a,o,u,s,c,f=0,p=0,m=0,h=r.constructor,d=h.rounding,g=h.precision;if(!r.d||!r.d[0]||r.e>17)return new h(r.d?r.d[0]?r.s<0?0:1/0:1:r.s?r.s<0?0:r:0/0);for(null==e?(l=!1,c=g):c=e,s=new h(.03125);r.e>-2;)r=r.times(s),m+=5;for(c+=n=Math.log(D(2,m))/Math.LN10*2+5|0,t=o=u=new h(1),h.precision=c;;){if(o=finalise(o.times(r),c,1),t=t.times(++p),digitsToString((s=u.plus(F(o,t,c,1))).d).slice(0,c)===digitsToString(u.d).slice(0,c)){for(a=m;a--;)u=finalise(u.times(u),c,1);if(null!=e)return h.precision=g,u;if(!(f<3&&checkRoundingDigits(u.d,c-n,d,f)))return finalise(u,h.precision=g,d,l=!0);h.precision=c+=10,t=o=s=new h(1),p=0,f++}u=s}}function naturalLogarithm(r,e){var t,n,a,o,u,s,c,f,p,m,h,d=1,g=r,v=g.d,D=g.constructor,y=D.rounding,x=D.precision;if(g.s<0||!v||!v[0]||!g.e&&1==v[0]&&1==v.length)return new D(v&&!v[0]?-1/0:1!=g.s?NaN:v?0:g);if(null==e?(l=!1,p=x):p=e,D.precision=p+=10,n=(t=digitsToString(v)).charAt(0),!(15e14>Math.abs(o=g.e)))return f=getLn10(D,p+2,x).times(o+""),g=naturalLogarithm(new D(n+"."+t.slice(1)),p-10).plus(f),D.precision=x,null==e?finalise(g,x,y,l=!0):g;for(;n<7&&1!=n||1==n&&t.charAt(1)>3;)n=(t=digitsToString((g=g.times(r)).d)).charAt(0),d++;for(o=g.e,n>1?(g=new D("0."+t),o++):g=new D(n+"."+t.slice(1)),m=g,c=u=g=F(g.minus(1),g.plus(1),p,1),h=finalise(g.times(g),p,1),a=3;;){if(u=finalise(u.times(h),p,1),digitsToString((f=c.plus(F(u,new D(a),p,1))).d).slice(0,p)===digitsToString(c.d).slice(0,p)){if(c=c.times(2),0!==o&&(c=c.plus(getLn10(D,p+2,x).times(o+""))),c=F(c,new D(d),p,1),null!=e)return D.precision=x,c;if(!checkRoundingDigits(c.d,p-10,y,s))return finalise(c,D.precision=x,y,l=!0);D.precision=p+=10,f=u=g=F(m.minus(1),m.plus(1),p,1),h=finalise(g.times(g),p,1),a=s=1}c=f,a+=2}}function nonFiniteToString(r){return String(r.s*r.s/0)}function parseDecimal(r,e){var t,n,a;for((t=e.indexOf("."))>-1&&(e=e.replace(".","")),(n=e.search(/e/i))>0?(t<0&&(t=n),t+=+e.slice(n+1),e=e.substring(0,n)):t<0&&(t=e.length),n=0;48===e.charCodeAt(n);n++);for(a=e.length;48===e.charCodeAt(a-1);--a);if(e=e.slice(n,a)){if(a-=n,r.e=t=t-n-1,r.d=[],n=(t+1)%7,t<0&&(n+=7),n<a){for(n&&r.d.push(+e.slice(0,n)),a-=7;n<a;)r.d.push(+e.slice(n,n+=7));n=7-(e=e.slice(n)).length}else n-=a;for(;n--;)e+="0";r.d.push(+e),l&&(r.e>r.constructor.maxE?(r.d=null,r.e=NaN):r.e<r.constructor.minE&&(r.e=0,r.d=[0]))}else r.e=0,r.d=[0];return r}function taylorSeries(r,e,t,n,a){var o,u,s,c,f=r.precision,p=Math.ceil(f/7);for(l=!1,c=t.times(t),s=new r(n);;){if(u=F(s.times(c),new r(e++*e++),f,1),s=a?n.plus(u):n.minus(u),n=F(u.times(c),new r(e++*e++),f,1),void 0!==(u=s.plus(n)).d[p]){for(o=p;u.d[o]===s.d[o]&&o--;);if(-1==o)break}o=s,s=n,n=u,u=o}return l=!0,u.d.length=p+1,u}function tinyPow(r,e){for(var t=r;--e;)t*=r;return t}function toLessThanHalfPi(r,e){var t,n=e.s<0,a=getPi(r,r.precision,1),u=a.times(.5);if((e=e.abs()).lte(u))return o=n?4:1,e;if((t=e.divToInt(a)).isZero())o=n?3:2;else{if((e=e.minus(t.times(a))).lte(u))return o=isOdd(t)?n?2:3:n?4:1,e;o=isOdd(t)?n?1:4:n?3:2}return e.minus(a).abs()}function toStringBinary(r,e,t,n){var o,s,c,f,l,p,m,h,d,g=r.constructor,v=void 0!==t;if(v?(checkInt32(t,1,1e9),void 0===n?n=g.rounding:checkInt32(n,0,8)):(t=g.precision,n=g.rounding),r.isFinite()){for(c=(m=finiteToString(r)).indexOf("."),v?(o=2,16==e?t=4*t-3:8==e&&(t=3*t-2)):o=e,c>=0&&(m=m.replace(".",""),(d=new g(1)).e=m.length-c,d.d=convertBase(finiteToString(d),10,o),d.e=d.d.length),s=l=(h=convertBase(m,10,o)).length;0==h[--l];)h.pop();if(h[0]){if(c<0?s--:((r=new g(r)).d=h,r.e=s,h=(r=F(r,d,t,n,0,o)).d,s=r.e,p=a),c=h[t],f=o/2,p=p||void 0!==h[t+1],p=n<4?(void 0!==c||p)&&(0===n||n===(r.s<0?3:2)):c>f||c===f&&(4===n||p||6===n&&1&h[t-1]||n===(r.s<0?8:7)),h.length=t,p)for(;++h[--t]>o-1;)h[t]=0,t||(++s,h.unshift(1));for(l=h.length;!h[l-1];--l);for(c=0,m="";c<l;c++)m+=u.charAt(h[c]);if(v){if(l>1){if(16==e||8==e){for(c=16==e?4:3,--l;l%c;l++)m+="0";for(l=(h=convertBase(m,o,e)).length;!h[l-1];--l);for(c=1,m="1.";c<l;c++)m+=u.charAt(h[c])}else m=m.charAt(0)+"."+m.slice(1)}m=m+(s<0?"p":"p+")+s}else if(s<0){for(;++s;)m="0"+m;m="0."+m}else if(++s>l)for(s-=l;s--;)m+="0";else s<l&&(m=m.slice(0,s)+"."+m.slice(s))}else m=v?"0p+0":"0";m=(16==e?"0x":2==e?"0b":8==e?"0o":"")+m}else m=nonFiniteToString(r);return r.s<0?"-"+m:m}function truncate(r,e){if(r.length>e)return r.length=e,!0}function abs(r){return new this(r).abs()}function acos(r){return new this(r).acos()}function acosh(r){return new this(r).acosh()}function add(r,e){return new this(r).plus(e)}function asin(r){return new this(r).asin()}function asinh(r){return new this(r).asinh()}function atan(r){return new this(r).atan()}function atanh(r){return new this(r).atanh()}function atan2(r,e){r=new this(r),e=new this(e);var t,n=this.precision,a=this.rounding,o=n+4;return r.s&&e.s?r.d||e.d?!e.d||r.isZero()?(t=e.s<0?getPi(this,n,a):new this(0)).s=r.s:!r.d||e.isZero()?(t=getPi(this,o,1).times(.5)).s=r.s:e.s<0?(this.precision=o,this.rounding=1,t=this.atan(F(r,e,o,1)),e=getPi(this,o,1),this.precision=n,this.rounding=a,t=r.s<0?t.minus(e):t.plus(e)):t=this.atan(F(r,e,o,1)):(t=getPi(this,o,1).times(e.s>0?.25:.75)).s=r.s:t=new this(NaN),t}function cbrt(r){return new this(r).cbrt()}function ceil(r){return finalise(r=new this(r),r.e+1,2)}function clamp(r,e,t){return new this(r).clamp(e,t)}function decimal_config(r){if(!r||"object"!=typeof r)throw Error(p+"Object expected");var e,t,n,a=!0===r.defaults,o=["precision",1,1e9,"rounding",0,8,"toExpNeg",-9e15,0,"toExpPos",0,9e15,"maxE",0,9e15,"minE",-9e15,0,"modulo",0,9];for(e=0;e<o.length;e+=3)if(t=o[e],a&&(this[t]=f[t]),void 0!==(n=r[t])){if(v(n)===n&&n>=o[e+1]&&n<=o[e+2])this[t]=n;else throw Error(m+t+": "+n)}if(t="crypto",a&&(this[t]=f[t]),void 0!==(n=r[t])){if(!0===n||!1===n||0===n||1===n){if(n){if("undefined"!=typeof crypto&&crypto&&(crypto.getRandomValues||crypto.randomBytes))this[t]=!0;else throw Error(d)}else this[t]=!1}else throw Error(m+t+": "+n)}return this}function cos(r){return new this(r).cos()}function cosh(r){return new this(r).cosh()}function div(r,e){return new this(r).div(e)}function exp(r){return new this(r).exp()}function floor(r){return finalise(r=new this(r),r.e+1,3)}function hypot(){var r,e,t=new this(0);for(r=0,l=!1;r<arguments.length;)if(e=new this(arguments[r++]),e.d)t.d&&(t=t.plus(e.times(e)));else{if(e.s)return l=!0,new this(1/0);t=e}return l=!0,t.sqrt()}function isDecimalInstance(r){return r instanceof C||r&&r.toStringTag===g||!1}function ln(r){return new this(r).ln()}function log(r,e){return new this(r).log(e)}function log2(r){return new this(r).log(2)}function log10(r){return new this(r).log(10)}function max(){return maxOrMin(this,arguments,"lt")}function min(){return maxOrMin(this,arguments,"gt")}function mod(r,e){return new this(r).mod(e)}function mul(r,e){return new this(r).mul(e)}function pow(r,e){return new this(r).pow(e)}function random(r){var e,t,n,a,o=0,u=new this(1),s=[];if(void 0===r?r=this.precision:checkInt32(r,1,1e9),n=Math.ceil(r/7),this.crypto){if(crypto.getRandomValues)for(e=crypto.getRandomValues(new Uint32Array(n));o<n;)(a=e[o])>=429e7?e[o]=crypto.getRandomValues(new Uint32Array(1))[0]:s[o++]=a%1e7;else if(crypto.randomBytes){for(e=crypto.randomBytes(n*=4);o<n;)(a=e[o]+(e[o+1]<<8)+(e[o+2]<<16)+((127&e[o+3])<<24))>=214e7?crypto.randomBytes(4).copy(e,o):(s.push(a%1e7),o+=4);o=n/4}else throw Error(d)}else for(;o<n;)s[o++]=1e7*Math.random()|0;for(n=s[--o],r%=7,n&&r&&(a=D(10,7-r),s[o]=(n/a|0)*a);0===s[o];o--)s.pop();if(o<0)t=0,s=[0];else{for(t=-1;0===s[0];t-=7)s.shift();for(n=1,a=s[0];a>=10;a/=10)n++;n<7&&(t-=7-n)}return u.e=t,u.d=s,u}function round(r){return finalise(r=new this(r),r.e+1,this.rounding)}function sign(r){return(r=new this(r)).d?r.d[0]?r.s:0*r.s:r.s||NaN}function sin(r){return new this(r).sin()}function sinh(r){return new this(r).sinh()}function sqrt(r){return new this(r).sqrt()}function sub(r,e){return new this(r).sub(e)}function sum(){var r=0,e=arguments,t=new this(e[r]);for(l=!1;t.s&&++r<e.length;)t=t.plus(e[r]);return l=!0,finalise(t,this.precision,this.rounding)}function tan(r){return new this(r).tan()}function tanh(r){return new this(r).tanh()}function trunc(r){return finalise(r=new this(r),r.e+1,1)}A[Symbol.for("nodejs.util.inspect.custom")]=A.toString,A[Symbol.toStringTag]="Decimal";var C=A.constructor=function decimal_clone(r){var e,t,n;function Decimal(r){var e,t,n;if(!(this instanceof Decimal))return new Decimal(r);if(this.constructor=Decimal,isDecimalInstance(r)){this.s=r.s,l?!r.d||r.e>Decimal.maxE?(this.e=NaN,this.d=null):r.e<Decimal.minE?(this.e=0,this.d=[0]):(this.e=r.e,this.d=r.d.slice()):(this.e=r.e,this.d=r.d?r.d.slice():r.d);return}if("number"==(n=typeof r)){if(0===r){this.s=1/r<0?-1:1,this.e=0,this.d=[0];return}if(r<0?(r=-r,this.s=-1):this.s=1,r===~~r&&r<1e7){for(e=0,t=r;t>=10;t/=10)e++;l?e>Decimal.maxE?(this.e=NaN,this.d=null):e<Decimal.minE?(this.e=0,this.d=[0]):(this.e=e,this.d=[r]):(this.e=e,this.d=[r]);return}if(0*r!=0){r||(this.s=NaN),this.e=NaN,this.d=null;return}return parseDecimal(this,r.toString())}if("string"!==n)throw Error(m+r);return 45===(t=r.charCodeAt(0))?(r=r.slice(1),this.s=-1):(43===t&&(r=r.slice(1)),this.s=1),_.test(r)?parseDecimal(this,r):function(r,e){var t,n,a,o,u,s,c,f,p;if(e.indexOf("_")>-1){if(e=e.replace(/(\d)_(?=\d)/g,"$1"),_.test(e))return parseDecimal(r,e)}else if("Infinity"===e||"NaN"===e)return+e||(r.s=NaN),r.e=NaN,r.d=null,r;if(x.test(e))t=16,e=e.toLowerCase();else if(y.test(e))t=2;else if(b.test(e))t=8;else throw Error(m+e);for((o=e.search(/p/i))>0?(c=+e.slice(o+1),e=e.substring(2,o)):e=e.slice(2),u=(o=e.indexOf("."))>=0,n=r.constructor,u&&(o=(s=(e=e.replace(".","")).length)-o,a=intPow(n,new n(t),o,2*o)),o=p=(f=convertBase(e,t,1e7)).length-1;0===f[o];--o)f.pop();return o<0?new n(0*r.s):(r.e=getBase10Exponent(f,p),r.d=f,l=!1,u&&(r=F(r,a,4*s)),c&&(r=r.times(54>Math.abs(c)?D(2,c):C.pow(2,c))),l=!0,r)}(this,r)}if(Decimal.prototype=A,Decimal.ROUND_UP=0,Decimal.ROUND_DOWN=1,Decimal.ROUND_CEIL=2,Decimal.ROUND_FLOOR=3,Decimal.ROUND_HALF_UP=4,Decimal.ROUND_HALF_DOWN=5,Decimal.ROUND_HALF_EVEN=6,Decimal.ROUND_HALF_CEIL=7,Decimal.ROUND_HALF_FLOOR=8,Decimal.EUCLID=9,Decimal.config=Decimal.set=decimal_config,Decimal.clone=decimal_clone,Decimal.isDecimal=isDecimalInstance,Decimal.abs=abs,Decimal.acos=acos,Decimal.acosh=acosh,Decimal.add=add,Decimal.asin=asin,Decimal.asinh=asinh,Decimal.atan=atan,Decimal.atanh=atanh,Decimal.atan2=atan2,Decimal.cbrt=cbrt,Decimal.ceil=ceil,Decimal.clamp=clamp,Decimal.cos=cos,Decimal.cosh=cosh,Decimal.div=div,Decimal.exp=exp,Decimal.floor=floor,Decimal.hypot=hypot,Decimal.ln=ln,Decimal.log=log,Decimal.log10=log10,Decimal.log2=log2,Decimal.max=max,Decimal.min=min,Decimal.mod=mod,Decimal.mul=mul,Decimal.pow=pow,Decimal.random=random,Decimal.round=round,Decimal.sign=sign,Decimal.sin=sin,Decimal.sinh=sinh,Decimal.sqrt=sqrt,Decimal.sub=sub,Decimal.sum=sum,Decimal.tan=tan,Decimal.tanh=tanh,Decimal.trunc=trunc,void 0===r&&(r={}),r&&!0!==r.defaults)for(e=0,n=["precision","rounding","toExpNeg","toExpPos","maxE","minE","modulo","crypto"];e<n.length;)r.hasOwnProperty(t=n[e++])||(r[t]=this[t]);return Decimal.config(r),Decimal}(f);function isNumber(r){return"number"==typeof r}function isBigNumber(r){return!!r&&"object"==typeof r&&"function"==typeof r.constructor&&(!0===r.isBigNumber&&"object"==typeof r.constructor.prototype&&!0===r.constructor.prototype.isBigNumber||"function"==typeof r.constructor.isDecimal&&!0===r.constructor.isDecimal(r))}function isComplex(r){return r&&"object"==typeof r&&!0===Object.getPrototypeOf(r).isComplex||!1}function isFraction(r){return r&&"object"==typeof r&&!0===Object.getPrototypeOf(r).isFraction||!1}function isUnit(r){return r&&!0===r.constructor.prototype.isUnit||!1}function isString(r){return"string"==typeof r}s=new C(s),c=new C(c);var M=Array.isArray;function isMatrix(r){return r&&!0===r.constructor.prototype.isMatrix||!1}function isCollection(r){return Array.isArray(r)||isMatrix(r)}function isDenseMatrix(r){return r&&r.isDenseMatrix&&!0===r.constructor.prototype.isMatrix||!1}function isSparseMatrix(r){return r&&r.isSparseMatrix&&!0===r.constructor.prototype.isMatrix||!1}function isRange(r){return r&&!0===r.constructor.prototype.isRange||!1}function isIndex(r){return r&&!0===r.constructor.prototype.isIndex||!1}function isBoolean(r){return"boolean"==typeof r}function isResultSet(r){return r&&!0===r.constructor.prototype.isResultSet||!1}function isHelp(r){return r&&!0===r.constructor.prototype.isHelp||!1}function isFunction(r){return"function"==typeof r}function isDate(r){return r instanceof Date}function isRegExp(r){return r instanceof RegExp}function is_isObject(r){return!!(r&&"object"==typeof r&&r.constructor===Object&&!isComplex(r)&&!isFraction(r))}function isNull(r){return null===r}function isUndefined(r){return void 0===r}function isAccessorNode(r){return r&&!0===r.isAccessorNode&&!0===r.constructor.prototype.isNode||!1}function isArrayNode(r){return r&&!0===r.isArrayNode&&!0===r.constructor.prototype.isNode||!1}function isAssignmentNode(r){return r&&!0===r.isAssignmentNode&&!0===r.constructor.prototype.isNode||!1}function isBlockNode(r){return r&&!0===r.isBlockNode&&!0===r.constructor.prototype.isNode||!1}function isConditionalNode(r){return r&&!0===r.isConditionalNode&&!0===r.constructor.prototype.isNode||!1}function isConstantNode(r){return r&&!0===r.isConstantNode&&!0===r.constructor.prototype.isNode||!1}function isFunctionAssignmentNode(r){return r&&!0===r.isFunctionAssignmentNode&&!0===r.constructor.prototype.isNode||!1}function isFunctionNode(r){return r&&!0===r.isFunctionNode&&!0===r.constructor.prototype.isNode||!1}function isIndexNode(r){return r&&!0===r.isIndexNode&&!0===r.constructor.prototype.isNode||!1}function isNode(r){return r&&!0===r.isNode&&!0===r.constructor.prototype.isNode||!1}function isObjectNode(r){return r&&!0===r.isObjectNode&&!0===r.constructor.prototype.isNode||!1}function isOperatorNode(r){return r&&!0===r.isOperatorNode&&!0===r.constructor.prototype.isNode||!1}function isParenthesisNode(r){return r&&!0===r.isParenthesisNode&&!0===r.constructor.prototype.isNode||!1}function isRangeNode(r){return r&&!0===r.isRangeNode&&!0===r.constructor.prototype.isNode||!1}function isRelationalNode(r){return r&&!0===r.isRelationalNode&&!0===r.constructor.prototype.isNode||!1}function isSymbolNode(r){return r&&!0===r.isSymbolNode&&!0===r.constructor.prototype.isNode||!1}function isChain(r){return r&&!0===r.constructor.prototype.isChain||!1}function typeOf(r){var e=typeof r;return"object"===e?null===r?"null":isBigNumber(r)?"BigNumber":r.constructor&&r.constructor.name?r.constructor.name:"Object":e}function object_clone(r){var e=typeof r;if("number"===e||"string"===e||"boolean"===e||null==r)return r;if("function"==typeof r.clone)return r.clone();if(Array.isArray(r))return r.map(function(r){return object_clone(r)});if(r instanceof Date)return new Date(r.valueOf());if(isBigNumber(r))return r;if(is_isObject(r))return function(r,e){var t={};for(var n in r)object_hasOwnProperty(r,n)&&(t[n]=e(r[n]));return t}(r,object_clone);throw TypeError("Cannot clone: unknown type of value (value: ".concat(r,")"))}function extend(r,e){for(var t in e)object_hasOwnProperty(e,t)&&(r[t]=e[t]);return r}function deepStrictEqual(r,e){var t,n,a;if(Array.isArray(r)){if(!Array.isArray(e)||r.length!==e.length)return!1;for(n=0,a=r.length;n<a;n++)if(!deepStrictEqual(r[n],e[n]))return!1;return!0}if("function"==typeof r||!(r instanceof Object))return r===e;if(Array.isArray(e)||!(e instanceof Object))return!1;for(t in r)if(!(t in e)||!deepStrictEqual(r[t],e[t]))return!1;for(t in e)if(!(t in r))return!1;return!0}function object_hasOwnProperty(r,e){return r&&Object.hasOwnProperty.call(r,e)}function factory_factory(r,e,t,n){function assertAndCreate(n){var a=function(r,e){for(var t={},n=0;n<e.length;n++){var a=e[n],o=r[a];void 0!==o&&(t[a]=o)}return t}(n,e.map(stripOptionalNotation));return function(r,e,t){if(!e.filter(r=>!(r&&"?"===r[0])).every(r=>void 0!==t[r])){var n=e.filter(r=>void 0===t[r]);throw Error('Cannot create function "'.concat(r,'", ')+"some dependencies are missing: ".concat(n.map(r=>'"'.concat(r,'"')).join(", "),"."))}}(r,e,n),t(a)}return assertAndCreate.isFactory=!0,assertAndCreate.fn=r,assertAndCreate.dependencies=e.slice().sort(),n&&(assertAndCreate.meta=n),assertAndCreate}function stripOptionalNotation(r){return r&&"?"===r[0]?r.slice(1):r}var N=factory_factory("BigNumber",["?on","config"],r=>{var{on:e,config:t}=r,n=C.clone({precision:t.precision,modulo:C.EUCLID});return n.prototype=Object.create(n.prototype),n.prototype.type="BigNumber",n.prototype.isBigNumber=!0,n.prototype.toJSON=function(){return{mathjs:"BigNumber",value:this.toString()}},n.fromJSON=function(r){return new n(r.value)},e&&e("config",function(r,e){r.precision!==e.precision&&n.config({precision:r.precision})}),n},{isClass:!0}),S=t(7707);function isInteger(r){return"boolean"==typeof r||!!isFinite(r)&&r===Math.round(r)}var B=Math.sign||function(r){return r>0?1:r<0?-1:0},z=Math.log2||function(r){return Math.log(r)/Math.LN2},T=Math.cbrt||function(r){if(0===r)return r;var e,t=r<0;return t&&(r=-r),isFinite(r)?(e=Math.exp(Math.log(r)/3),e=(r/(e*e)+2*e)/3):e=r,t?-e:e},I=Math.expm1||function(r){return r>=2e-4||r<=-.0002?Math.exp(r)-1:r+r*r/2+r*r*r/6};function formatNumberToBase(r,e,t){var n={2:"0b",8:"0o",16:"0x"}[e],a="";if(t){if(t<1)throw Error("size must be in greater than 0");if(!isInteger(t))throw Error("size must be an integer");if(r>2**(t-1)-1||r<-(2**(t-1)))throw Error("Value must be in range [-2^".concat(t-1,", 2^").concat(t-1,"-1]"));if(!isInteger(r))throw Error("Value must be an integer");r<0&&(r+=2**t),a="i".concat(t)}var o="";return r<0&&(r=-r,o="-"),"".concat(o).concat(n).concat(r.toString(e)).concat(a)}function format(r,e){if("function"==typeof e)return e(r);if(r===1/0)return"Infinity";if(r===-1/0)return"-Infinity";if(isNaN(r))return"NaN";var{notation:t,precision:n,wordSize:a}=normalizeFormatOptions(e);switch(t){case"fixed":return toFixed(r,n);case"exponential":return toExponential(r,n);case"engineering":return function(r,e){if(isNaN(r)||!isFinite(r))return String(r);var t=roundDigits(splitNumber(r),e),n=t.exponent,a=t.coefficients,o=n%3==0?n:n<0?n-3-n%3:n-n%3;if(isNumber(e))for(;e>a.length||n-o+1>a.length;)a.push(0);else for(var u=Math.abs(n-o)-(a.length-1),s=0;s<u;s++)a.push(0);for(var c=Math.abs(n-o),f=1;c>0;)f++,c--;var l=a.slice(f).join(""),p=isNumber(e)&&l.length||l.match(/[1-9]/)?"."+l:"",m=a.slice(0,f).join("")+p+"e"+(n>=0?"+":"")+o.toString();return t.sign+m}(r,n);case"bin":return formatNumberToBase(r,2,a);case"oct":return formatNumberToBase(r,8,a);case"hex":return formatNumberToBase(r,16,a);case"auto":return(function(r,e,t){if(isNaN(r)||!isFinite(r))return String(r);var n=_toNumberOrDefault(null==t?void 0:t.lowerExp,-3),a=_toNumberOrDefault(null==t?void 0:t.upperExp,5),o=splitNumber(r),u=e?roundDigits(o,e):o;if(u.exponent<n||u.exponent>=a)return toExponential(r,e);var s=u.coefficients,c=u.exponent;s.length<e&&(s=s.concat(zeros(e-s.length))),s=s.concat(zeros(c-s.length+1+(s.length<e?e-s.length:0))),s=zeros(-c).concat(s);var f=c>0?c:0;return f<s.length-1&&s.splice(f+1,0,"."),u.sign+s.join("")})(r,n,e).replace(/((\.\d*?)(0+))($|e)/,function(){var r=arguments[2],e=arguments[4];return"."!==r?r+e:e});default:throw Error('Unknown notation "'+t+'". Choose "auto", "exponential", "fixed", "bin", "oct", or "hex.')}}function normalizeFormatOptions(r){var e,t,n="auto";if(void 0!==r){if(isNumber(r))e=r;else if(isBigNumber(r))e=r.toNumber();else if(is_isObject(r))void 0!==r.precision&&(e=_toNumberOrThrow(r.precision,()=>{throw Error('Option "precision" must be a number or BigNumber')})),void 0!==r.wordSize&&(t=_toNumberOrThrow(r.wordSize,()=>{throw Error('Option "wordSize" must be a number or BigNumber')})),r.notation&&(n=r.notation);else throw Error("Unsupported type of options, number, BigNumber, or object expected")}return{notation:n,precision:e,wordSize:t}}function splitNumber(r){var e=String(r).toLowerCase().match(/^(-?)(\d+\.?\d*)(e([+-]?\d+))?$/);if(!e)throw SyntaxError("Invalid number "+r);var t=e[1],n=e[2],a=parseFloat(e[4]||"0"),o=n.indexOf(".");a+=-1!==o?o-1:n.length-1;var u=n.replace(".","").replace(/^0*/,function(r){return a-=r.length,""}).replace(/0*$/,"").split("").map(function(r){return parseInt(r)});return 0===u.length&&(u.push(0),a++),{sign:t,coefficients:u,exponent:a}}function toFixed(r,e){if(isNaN(r)||!isFinite(r))return String(r);var t=splitNumber(r),n="number"==typeof e?roundDigits(t,t.exponent+1+e):t,a=n.coefficients,o=n.exponent+1,u=o+(e||0);return a.length<u&&(a=a.concat(zeros(u-a.length))),o<0&&(a=zeros(-o+1).concat(a),o=1),o<a.length&&a.splice(o,0,0===o?"0.":"."),n.sign+a.join("")}function toExponential(r,e){if(isNaN(r)||!isFinite(r))return String(r);var t=splitNumber(r),n=e?roundDigits(t,e):t,a=n.coefficients,o=n.exponent;a.length<e&&(a=a.concat(zeros(e-a.length)));var u=a.shift();return n.sign+u+(a.length>0?"."+a.join(""):"")+"e"+(o>=0?"+":"")+o}function roundDigits(r,e){for(var t={sign:r.sign,coefficients:r.coefficients,exponent:r.exponent},n=t.coefficients;e<=0;)n.unshift(0),t.exponent++,e++;if(n.length>e&&n.splice(e,n.length-e)[0]>=5){var a=e-1;for(n[a]++;10===n[a];)n.pop(),0===a&&(n.unshift(0),t.exponent++,a++),a--,n[a]++}return t}function zeros(r){for(var e=[],t=0;t<r;t++)e.push(0);return e}var O=Number.EPSILON||2220446049250313e-31;function nearlyEqual(r,e,t){if(null==t)return r===e;if(r===e)return!0;if(isNaN(r)||isNaN(e))return!1;if(isFinite(r)&&isFinite(e)){var n=Math.abs(r-e);return n<=O||n<=Math.max(Math.abs(r),Math.abs(e))*t}return!1}var P=Math.asinh||function(r){return Math.log(Math.sqrt(r*r+1)+r)},j=Math.sinh||function(r){return(Math.exp(r)-Math.exp(-r))/2};function _toNumberOrThrow(r,e){return isNumber(r)?r:isBigNumber(r)?r.toNumber():void e()}function _toNumberOrDefault(r,e){return isNumber(r)?r:isBigNumber(r)?r.toNumber():e}var k=factory_factory("Complex",[],()=>(Object.defineProperty(S,"name",{value:"Complex"}),S.prototype.constructor=S,S.prototype.type="Complex",S.prototype.isComplex=!0,S.prototype.toJSON=function(){return{mathjs:"Complex",re:this.re,im:this.im}},S.prototype.toPolar=function(){return{r:this.abs(),phi:this.arg()}},S.prototype.format=function(r){var e=this.im,t=this.re,n=format(this.re,r),a=format(this.im,r),o=isNumber(r)?r:r?r.precision:null;if(null!==o){var u=Math.pow(10,-o);Math.abs(t/e)<u&&(t=0),Math.abs(e/t)<u&&(e=0)}return 0===e?n:0===t?1===e?"i":-1===e?"-i":a+"i":e<0?-1===e?n+" - i":n+" - "+a.substring(1)+"i":1===e?n+" + i":n+" + "+a+"i"},S.fromPolar=function(r){switch(arguments.length){case 1:var e=arguments[0];if("object"==typeof e)return S(e);throw TypeError("Input has to be an object with r and phi keys.");case 2:var t=arguments[0],n=arguments[1];if(isNumber(t)){if(isUnit(n)&&n.hasBase("ANGLE")&&(n=n.toNumber("rad")),isNumber(n))return new S({r:t,phi:n});throw TypeError("Phi is not a number nor an angle unit.")}throw TypeError("Radius r is not a number.");default:throw SyntaxError("Wrong number of arguments in function fromPolar")}},S.prototype.valueOf=S.prototype.toString,S.fromJSON=function(r){return new S(r)},S.compare=function(r,e){return r.re>e.re?1:r.re<e.re?-1:r.im>e.im?1:r.im<e.im?-1:0},S),{isClass:!0});function memoize(r){var{hasher:e,limit:t}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return t=null==t?Number.POSITIVE_INFINITY:t,e=null==e?JSON.stringify:e,function memoize(){if("object"!=typeof memoize.cache){var n,a,o,u,s,c,f;memoize.cache={values:new Map,lru:(n=t||Number.POSITIVE_INFINITY,a=0,o=1,u=Object.create(null),s=Object.create(null),c=0,f=function(r){var e=s[r];if(e&&(delete u[e],delete s[r],--a,o===e)){if(!a){c=0,o=1;return}for(;!Object.prototype.hasOwnProperty.call(u,++o););}},n=Math.abs(n),{hit:function(r){var e=s[r],t=++c;if(u[t]=r,s[r]=t,!e){if(++a<=n)return;return f(r=u[o]),r}if(delete u[e],o===e)for(;!Object.prototype.hasOwnProperty.call(u,++o););},delete:f,clear:function(){a=c=0,o=1,u=Object.create(null),s=Object.create(null)}})}}for(var l=[],p=0;p<arguments.length;p++)l[p]=arguments[p];var m=e(l);if(memoize.cache.values.has(m))return memoize.cache.lru.hit(m),memoize.cache.values.get(m);var h=r.apply(r,l);return memoize.cache.values.set(m,h),memoize.cache.values.delete(memoize.cache.lru.hit(m)),h}}function maxArgumentCount(r){return Object.keys(r.signatures||{}).reduce(function(r,e){return Math.max(r,(e.match(/,/g)||[]).length+1)},-1)}memoize(function(r){return new r(1).exp()},{hasher}),memoize(function(r){return new r(1).plus(new r(5).sqrt()).div(2)},{hasher});var q=memoize(function(r){return r.acos(-1)},{hasher}),R=memoize(function(r){return q(r).times(2)},{hasher});function hasher(r){return r[0].precision}var U=Math.PI,L=2*Math.PI;function recreateFactory(r,e,t){return factory_factory(r,e,t,{recreateOnConfigChange:!0})}function numberFactory(r,e){return factory_factory(r,["config","BigNumber"],r=>{var{config:t,BigNumber:n}=r;return"BigNumber"===t.number?new n(e):e})}numberFactory("fineStructure",.0072973525693),numberFactory("weakMixingAngle",.2229),numberFactory("efimovFactor",22.7),numberFactory("sackurTetrode",-1.16487052358);var Z=t(92),V=factory_factory("Fraction",[],()=>(Object.defineProperty(Z,"name",{value:"Fraction"}),Z.prototype.constructor=Z,Z.prototype.type="Fraction",Z.prototype.isFraction=!0,Z.prototype.toJSON=function(){return{mathjs:"Fraction",n:this.s*this.n,d:this.d}},Z.fromJSON=function(r){return new Z(r)},Z),{isClass:!0}),H=factory_factory("Matrix",[],()=>{function Matrix(){if(!(this instanceof Matrix))throw SyntaxError("Constructor must be called with the new operator")}return Matrix.prototype.type="Matrix",Matrix.prototype.isMatrix=!0,Matrix.prototype.storage=function(){throw Error("Cannot invoke storage on a Matrix interface")},Matrix.prototype.datatype=function(){throw Error("Cannot invoke datatype on a Matrix interface")},Matrix.prototype.create=function(r,e){throw Error("Cannot invoke create on a Matrix interface")},Matrix.prototype.subset=function(r,e,t){throw Error("Cannot invoke subset on a Matrix interface")},Matrix.prototype.get=function(r){throw Error("Cannot invoke get on a Matrix interface")},Matrix.prototype.set=function(r,e,t){throw Error("Cannot invoke set on a Matrix interface")},Matrix.prototype.resize=function(r,e){throw Error("Cannot invoke resize on a Matrix interface")},Matrix.prototype.reshape=function(r,e){throw Error("Cannot invoke reshape on a Matrix interface")},Matrix.prototype.clone=function(){throw Error("Cannot invoke clone on a Matrix interface")},Matrix.prototype.size=function(){throw Error("Cannot invoke size on a Matrix interface")},Matrix.prototype.map=function(r,e){throw Error("Cannot invoke map on a Matrix interface")},Matrix.prototype.forEach=function(r){throw Error("Cannot invoke forEach on a Matrix interface")},Matrix.prototype[Symbol.iterator]=function(){throw Error("Cannot iterate a Matrix interface")},Matrix.prototype.toArray=function(){throw Error("Cannot invoke toArray on a Matrix interface")},Matrix.prototype.valueOf=function(){throw Error("Cannot invoke valueOf on a Matrix interface")},Matrix.prototype.format=function(r){throw Error("Cannot invoke format on a Matrix interface")},Matrix.prototype.toString=function(){throw Error("Cannot invoke toString on a Matrix interface")},Matrix},{isClass:!0});function formatBigNumberToBase(r,e,t){var n=new r.constructor(2),a="";if(t){if(t<1)throw Error("size must be in greater than 0");if(!isInteger(t))throw Error("size must be an integer");if(r.greaterThan(n.pow(t-1).sub(1))||r.lessThan(n.pow(t-1).mul(-1)))throw Error("Value must be in range [-2^".concat(t-1,", 2^").concat(t-1,"-1]"));if(!r.isInteger())throw Error("Value must be an integer");r.lessThan(0)&&(r=r.add(n.pow(t))),a="i".concat(t)}switch(e){case 2:return"".concat(r.toBinary()).concat(a);case 8:return"".concat(r.toOctal()).concat(a);case 16:return"".concat(r.toHexadecimal()).concat(a);default:throw Error("Base ".concat(e," not supported "))}}function formatter_toExponential(r,e){return void 0!==e?r.toExponential(e-1):r.toExponential()}function formatter_toNumberOrDefault(r,e){return isNumber(r)?r:isBigNumber(r)?r.toNumber():e}function string_format(r,e){var t=function(r,e){return"number"==typeof r?format(r,e):isBigNumber(r)?function(r,e){if("function"==typeof e)return e(r);if(!r.isFinite())return r.isNaN()?"NaN":r.gt(0)?"Infinity":"-Infinity";var{notation:t,precision:n,wordSize:a}=normalizeFormatOptions(e);switch(t){case"fixed":return r.toFixed(n);case"exponential":return formatter_toExponential(r,n);case"engineering":return u=(o=r.e)%3==0?o:o<0?o-3-o%3:o-o%3,-1!==(s=r.mul(Math.pow(10,-u)).toPrecision(n)).indexOf("e")&&(s=new r.constructor(s).toFixed()),s+"e"+(o>=0?"+":"")+u.toString();case"bin":return formatBigNumberToBase(r,2,a);case"oct":return formatBigNumberToBase(r,8,a);case"hex":return formatBigNumberToBase(r,16,a);case"auto":var o,u,s,c=formatter_toNumberOrDefault(null==e?void 0:e.lowerExp,-3),f=formatter_toNumberOrDefault(null==e?void 0:e.upperExp,5);if(r.isZero())return"0";var l=r.toSignificantDigits(n),p=l.e;return(p>=c&&p<f?l.toFixed():formatter_toExponential(r,n)).replace(/((\.\d*?)(0+))($|e)/,function(){var r=arguments[2],e=arguments[4];return"."!==r?r+e:e});default:throw Error('Unknown notation "'+t+'". Choose "auto", "exponential", "fixed", "bin", "oct", or "hex.')}}(r,e):r&&"object"==typeof r&&"number"==typeof r.s&&"number"==typeof r.n&&"number"==typeof r.d?e&&"decimal"===e.fraction?r.toString():r.s*r.n+"/"+r.d:Array.isArray(r)?function formatArray(r,e){if(!Array.isArray(r))return string_format(r,e);for(var t="[",n=r.length,a=0;a<n;a++)0!==a&&(t+=", "),t+=formatArray(r[a],e);return t+"]"}(r,e):isString(r)?stringify(r):"function"==typeof r?r.syntax?String(r.syntax):"function":r&&"object"==typeof r?"function"==typeof r.format?r.format(e):r&&r.toString(e)!==({}).toString()?r.toString(e):"{"+Object.keys(r).map(t=>stringify(t)+": "+string_format(r[t],e)).join(", ")+"}":String(r)}(r,e);return e&&"object"==typeof e&&"truncate"in e&&t.length>e.truncate?t.substring(0,e.truncate-3)+"...":t}function stringify(r){for(var e=String(r),t="",n=0;n<e.length;){var a=e.charAt(n);t+=a in J?J[a]:a,n++}return'"'+t+'"'}var J={'"':'\\"',"\\":"\\\\","\b":"\\b","\f":"\\f","\n":"\\n","\r":"\\r","	":"\\t"};function compareText(r,e){if(!isString(r))throw TypeError("Unexpected type of argument in function compareText (expected: string or Array or Matrix, actual: "+typeOf(r)+", index: 0)");if(!isString(e))throw TypeError("Unexpected type of argument in function compareText (expected: string or Array or Matrix, actual: "+typeOf(e)+", index: 1)");return r===e?0:r>e?1:-1}function DimensionError(r,e,t){if(!(this instanceof DimensionError))throw SyntaxError("Constructor must be called with the new operator");this.actual=r,this.expected=e,this.relation=t,this.message="Dimension mismatch ("+(Array.isArray(r)?"["+r.join(", ")+"]":r)+" "+(this.relation||"!=")+" "+(Array.isArray(e)?"["+e.join(", ")+"]":e)+")",this.stack=Error().stack}function IndexError(r,e,t){if(!(this instanceof IndexError))throw SyntaxError("Constructor must be called with the new operator");this.index=r,arguments.length<3?(this.min=0,this.max=e):(this.min=e,this.max=t),void 0!==this.min&&this.index<this.min?this.message="Index out of range ("+this.index+" < "+this.min+")":void 0!==this.max&&this.index>=this.max?this.message="Index out of range ("+this.index+" > "+(this.max-1)+")":this.message="Index out of range ("+this.index+")",this.stack=Error().stack}function arraySize(r){for(var e=[];Array.isArray(r);)e.push(r.length),r=r[0];return e}function validate(r,e){if(0===e.length){if(Array.isArray(r))throw new DimensionError(r.length,0)}else!function _validate(r,e,t){var n,a=r.length;if(a!==e[t])throw new DimensionError(a,e[t]);if(t<e.length-1){var o=t+1;for(n=0;n<a;n++){if(!Array.isArray(r[n]))throw new DimensionError(e.length-1,e.length,"<");_validate(r[n],e,o)}}else for(n=0;n<a;n++)if(Array.isArray(r[n]))throw new DimensionError(e.length+1,e.length,">")}(r,e,0)}function validateIndexSourceSize(r,e){var t=r.isMatrix?r._size:arraySize(r);e._sourceSize.forEach((r,e)=>{if(null!==r&&r!==t[e])throw new DimensionError(r,t[e])})}function validateIndex(r,e){if(void 0!==r){if(!isNumber(r)||!isInteger(r))throw TypeError("Index must be an integer (value: "+r+")");if(r<0||"number"==typeof e&&r>=e)throw new IndexError(r,e)}}function isEmptyIndex(r){for(var e=0;e<r._dimensions.length;++e){var t=r._dimensions[e];if(t._data&&M(t._data)){if(0===t._size[0])return!0}else if(t.isRange){if(t.start===t.end)return!0}else if(isString(t)&&0===t.length)return!0}return!1}function array_resize(r,e,t){if(!Array.isArray(e))throw TypeError("Array expected");if(0===e.length)throw Error("Resizing to scalar is not supported");return e.forEach(function(r){if(!isNumber(r)||!isInteger(r)||r<0)throw TypeError("Invalid size, must contain positive integers (size: "+string_format(e)+")")}),(isNumber(r)||isBigNumber(r))&&(r=[r]),function _resize(r,e,t,n){var a,o,u=r.length,s=e[t],c=Math.min(u,s);if(r.length=s,t<e.length-1){var f=t+1;for(a=0;a<c;a++)Array.isArray(o=r[a])||(o=[o],r[a]=o),_resize(o,e,f,n);for(a=c;a<s;a++)o=[],r[a]=o,_resize(o,e,f,n)}else{for(a=0;a<c;a++)for(;Array.isArray(r[a]);)r[a]=r[a][0];for(a=c;a<s;a++)r[a]=n}}(r,e,0,void 0!==t?t:0),r}function reshape(r,e){var t=flatten(r),n=t.length;if(!Array.isArray(r)||!Array.isArray(e))throw TypeError("Array expected");if(0===e.length)throw new DimensionError(0,n,"!=");var a=product(e=processSizesWildcard(e,n));if(n!==a)throw new DimensionError(a,n,"!=");try{return function(r,e){for(var t,n=r,a=e.length-1;a>0;a--){var o=e[a];t=[];for(var u=n.length/o,s=0;s<u;s++)t.push(n.slice(s*o,(s+1)*o));n=t}return n}(t,e)}catch(r){if(r instanceof DimensionError)throw new DimensionError(a,n,"!=");throw r}}function processSizesWildcard(r,e){var t=product(r),n=r.slice(),a=r.indexOf(-1);if(r.indexOf(-1,a+1)>=0)throw Error("More than one wildcard in sizes");if(a>=0){if(e%t==0)n[a]=-e/t;else throw Error("Could not replace wildcard, since "+e+" is no multiple of "+-t)}return n}function product(r){return r.reduce((r,e)=>r*e,1)}function unsqueeze(r,e,t,n){var a=n||arraySize(r);if(t)for(var o=0;o<t;o++)r=[r],a.unshift(1);for(r=function _unsqueeze(r,e,t){var n,a;if(Array.isArray(r)){var o=t+1;for(n=0,a=r.length;n<a;n++)r[n]=_unsqueeze(r[n],e,o)}else for(var u=t;u<e;u++)r=[r];return r}(r,e,0);a.length<e;)a.push(1);return r}function flatten(r){if(!Array.isArray(r))return r;var e=[];return r.forEach(function callback(r){Array.isArray(r)?r.forEach(callback):e.push(r)}),e}function identify(r){if(!Array.isArray(r))throw TypeError("Array input expected");if(0===r.length)return r;var e=[],t=0;e[0]={value:r[0],identifier:0};for(var n=1;n<r.length;n++)r[n]===r[n-1]?t++:t=0,e.push({value:r[n],identifier:t});return e}function generalize(r){if(!Array.isArray(r))throw TypeError("Array input expected");if(0===r.length)return r;for(var e=[],t=0;t<r.length;t++)e.push(r[t].value);return e}function getArrayDataType(r,e){for(var t,n=0,a=0;a<r.length;a++){var o=r[a],u=Array.isArray(o);if(0===a&&u&&(n=o.length),u&&o.length!==n)return;var s=u?getArrayDataType(o,e):e(o);if(void 0===t)t=s;else if(t!==s)return"mixed"}return t}function concat(){var r=Array.prototype.slice.call(arguments,0,-1),e=Array.prototype.slice.call(arguments,-1);if(1===r.length)return r[0];if(r.length>1)return r.slice(1).reduce(function(r,t){return function concatRecursive(r,e,t,n){if(!(n<t))return r.concat(e);if(r.length!==e.length)throw new DimensionError(r.length,e.length);for(var a=[],o=0;o<r.length;o++)a[o]=concatRecursive(r[o],e[o],t,n+1);return a}(r,t,e,0)},r[0]);throw Error("Wrong number of arguments in function concat")}function checkBroadcastingRules(r,e){for(var t=e.length,n=r.length,a=0;a<n;a++){var o=t-n+a;if(r[a]<e[o]&&r[a]>1||r[a]>e[o])throw Error("shape missmatch: missmatch is found in arg with shape (".concat(r,") not possible to broadcast dimension ").concat(n," with size ").concat(r[a]," to size ").concat(e[o]))}}function broadcastTo(r,e){var t,n,a,o=arraySize(r);if(deepStrictEqual(o,e))return r;checkBroadcastingRules(o,e);var u=function(){for(var r=arguments.length,e=Array(r),t=0;t<r;t++)e[t]=arguments[t];for(var n=e.map(r=>r.length),a=Math.max(...n),o=Array(a).fill(null),u=0;u<e.length;u++)for(var s=e[u],c=n[u],f=0;f<c;f++){var l=a-c+f;s[f]>o[l]&&(o[l]=s[f])}for(var p=0;p<e.length;p++)checkBroadcastingRules(e[p],o);return o}(o,e),s=u.length,c=[...Array(s-o.length).fill(1),...o],f=_extends([],r);o.length<s&&(o=arraySize(f=reshape(f,c)));for(var l=0;l<s;l++)o[l]<u[l]&&(o=arraySize((t=f,n=u[l],a=l,f=concat(...Array(n).fill(t),a))));return f}DimensionError.prototype=RangeError(),DimensionError.prototype.constructor=RangeError,DimensionError.prototype.name="DimensionError",DimensionError.prototype.isDimensionError=!0,IndexError.prototype=RangeError(),IndexError.prototype.constructor=RangeError,IndexError.prototype.name="IndexError",IndexError.prototype.isIndexError=!0;var $=factory_factory("DenseMatrix",["Matrix"],r=>{var{Matrix:e}=r;function DenseMatrix(r,e){if(!(this instanceof DenseMatrix))throw SyntaxError("Constructor must be called with the new operator");if(e&&!isString(e))throw Error("Invalid datatype: "+e);if(isMatrix(r))"DenseMatrix"===r.type?(this._data=object_clone(r._data),this._size=object_clone(r._size)):(this._data=r.toArray(),this._size=r.size()),this._datatype=e||r._datatype;else if(r&&M(r.data)&&M(r.size))this._data=r.data,this._size=r.size,validate(this._data,this._size),this._datatype=e||r.datatype;else if(M(r))this._data=function preprocess(r){return isMatrix(r)?preprocess(r.valueOf()):M(r)?r.map(preprocess):r}(r),this._size=arraySize(this._data),validate(this._data,this._size),this._datatype=e;else if(r)throw TypeError("Unsupported type of data ("+typeOf(r)+")");else this._data=[],this._size=[0],this._datatype=e}function _resize(r,e,t){if(0===e.length){for(var n=r._data;M(n);)n=n[0];return n}return r._size=e.slice(0),r._data=array_resize(r._data,r._size,t),r}function _fit(r,e,t){for(var n=r._size.slice(0),a=!1;n.length<e.length;)n.push(0),a=!0;for(var o=0,u=e.length;o<u;o++)e[o]>n[o]&&(n[o]=e[o],a=!0);a&&_resize(r,n,t)}return DenseMatrix.prototype=new e,DenseMatrix.prototype.createDenseMatrix=function(r,e){return new DenseMatrix(r,e)},Object.defineProperty(DenseMatrix,"name",{value:"DenseMatrix"}),DenseMatrix.prototype.constructor=DenseMatrix,DenseMatrix.prototype.type="DenseMatrix",DenseMatrix.prototype.isDenseMatrix=!0,DenseMatrix.prototype.getDataType=function(){return getArrayDataType(this._data,typeOf)},DenseMatrix.prototype.storage=function(){return"dense"},DenseMatrix.prototype.datatype=function(){return this._datatype},DenseMatrix.prototype.create=function(r,e){return new DenseMatrix(r,e)},DenseMatrix.prototype.subset=function(r,e,t){switch(arguments.length){case 1:return function(r,e){if(!isIndex(e))throw TypeError("Invalid index");if(e.isScalar())return r.get(e.min());var t=e.size();if(t.length!==r._size.length)throw new DimensionError(t.length,r._size.length);for(var n=e.min(),a=e.max(),o=0,u=r._size.length;o<u;o++)validateIndex(n[o],r._size[o]),validateIndex(a[o],r._size[o]);return new DenseMatrix(function _getSubmatrix(r,e,t,n){var a=n===t-1,o=e.dimension(n);return a?o.map(function(e){return validateIndex(e,r.length),r[e]}).valueOf():o.map(function(a){return validateIndex(a,r.length),_getSubmatrix(r[a],e,t,n+1)}).valueOf()}(r._data,e,t.length,0),r._datatype)}(this,r);case 2:case 3:return function(r,e,t,n){if(!e||!0!==e.isIndex)throw TypeError("Invalid index");var a,o=e.size(),u=e.isScalar();if(isMatrix(t)?(a=t.size(),t=t.valueOf()):a=arraySize(t),u){if(0!==a.length)throw TypeError("Scalar expected");r.set(e.min(),t,n)}else{if(!deepStrictEqual(a,o))try{t=0===a.length?broadcastTo([t],o):broadcastTo(t,o),a=arraySize(t)}catch(r){}if(o.length<r._size.length)throw new DimensionError(o.length,r._size.length,"<");if(a.length<o.length){for(var s=0,c=0;1===o[s]&&1===a[s];)s++;for(;1===o[s];)c++,s++;t=unsqueeze(t,o.length,c,a)}if(!deepStrictEqual(o,a))throw new DimensionError(o,a,">");_fit(r,e.max().map(function(r){return r+1}),n);var f=o.length;(function _setSubmatrix(r,e,t,n,a){var o=a===n-1,u=e.dimension(a);o?u.forEach(function(e,n){validateIndex(e),r[e]=t[n[0]]}):u.forEach(function(o,u){validateIndex(o),_setSubmatrix(r[o],e,t[u[0]],n,a+1)})})(r._data,e,t,f,0)}return r}(this,r,e,t);default:throw SyntaxError("Wrong number of arguments")}},DenseMatrix.prototype.get=function(r){if(!M(r))throw TypeError("Array expected");if(r.length!==this._size.length)throw new DimensionError(r.length,this._size.length);for(var e=0;e<r.length;e++)validateIndex(r[e],this._size[e]);for(var t=this._data,n=0,a=r.length;n<a;n++){var o=r[n];validateIndex(o,t.length),t=t[o]}return t},DenseMatrix.prototype.set=function(r,e,t){if(!M(r))throw TypeError("Array expected");if(r.length<this._size.length)throw new DimensionError(r.length,this._size.length,"<");_fit(this,r.map(function(r){return r+1}),t);var n,a,o,u=this._data;for(n=0,a=r.length-1;n<a;n++)validateIndex(o=r[n],u.length),u=u[o];return validateIndex(o=r[r.length-1],u.length),u[o]=e,this},DenseMatrix.prototype.resize=function(r,e,t){if(!isCollection(r))throw TypeError("Array or Matrix expected");var n=r.valueOf().map(r=>Array.isArray(r)&&1===r.length?r[0]:r);return _resize(t?this.clone():this,n,e)},DenseMatrix.prototype.reshape=function(r,e){var t=e?this.clone():this;t._data=reshape(t._data,r);var n=t._size.reduce((r,e)=>r*e);return t._size=processSizesWildcard(r,n),t},DenseMatrix.prototype.clone=function(){return new DenseMatrix({data:object_clone(this._data),size:object_clone(this._size),datatype:this._datatype})},DenseMatrix.prototype.size=function(){return this._size.slice(0)},DenseMatrix.prototype.map=function(r){var e=this,t=maxArgumentCount(r),n=function recurse(n,a){return M(n)?n.map(function(r,e){return recurse(r,a.concat(e))}):1===t?r(n):2===t?r(n,a):r(n,a,e)}(this._data,[]),a=void 0!==this._datatype?getArrayDataType(n,typeOf):void 0;return new DenseMatrix(n,a)},DenseMatrix.prototype.forEach=function(r){var e=this;!function recurse(t,n){M(t)?t.forEach(function(r,e){recurse(r,n.concat(e))}):r(t,n,e)}(this._data,[])},DenseMatrix.prototype[Symbol.iterator]=function*(){var recurse=function* recurse(r,e){if(M(r))for(var t=0;t<r.length;t++)yield*recurse(r[t],e.concat(t));else yield{value:r,index:e}};yield*recurse(this._data,[])},DenseMatrix.prototype.rows=function(){var r=[];if(2!==this.size().length)throw TypeError("Rows can only be returned for a 2D matrix.");for(var e of this._data)r.push(new DenseMatrix([e],this._datatype));return r},DenseMatrix.prototype.columns=function(){var r=this,e=[],t=this.size();if(2!==t.length)throw TypeError("Rows can only be returned for a 2D matrix.");for(var n=this._data,_loop=function(t){var a=n.map(r=>[r[t]]);e.push(new DenseMatrix(a,r._datatype))},a=0;a<t[1];a++)_loop(a);return e},DenseMatrix.prototype.toArray=function(){return object_clone(this._data)},DenseMatrix.prototype.valueOf=function(){return this._data},DenseMatrix.prototype.format=function(r){return string_format(this._data,r)},DenseMatrix.prototype.toString=function(){return string_format(this._data)},DenseMatrix.prototype.toJSON=function(){return{mathjs:"DenseMatrix",data:this._data,size:this._size,datatype:this._datatype}},DenseMatrix.prototype.diagonal=function(r){if(r){if(isBigNumber(r)&&(r=r.toNumber()),!isNumber(r)||!isInteger(r))throw TypeError("The parameter k must be an integer number")}else r=0;for(var e=r>0?r:0,t=r<0?-r:0,n=Math.min(this._size[0]-t,this._size[1]-e),a=[],o=0;o<n;o++)a[o]=this._data[o+t][o+e];return new DenseMatrix({data:a,size:[n],datatype:this._datatype})},DenseMatrix.diagonal=function(r,e,t,n){if(!M(r))throw TypeError("Array expected, size parameter");if(2!==r.length)throw Error("Only two dimensions matrix are supported");if(r=r.map(function(r){if(isBigNumber(r)&&(r=r.toNumber()),!isNumber(r)||!isInteger(r)||r<1)throw Error("Size values must be positive integers");return r}),t){if(isBigNumber(t)&&(t=t.toNumber()),!isNumber(t)||!isInteger(t))throw TypeError("The parameter k must be an integer number")}else t=0;var a,o=t>0?t:0,u=t<0?-t:0,s=r[0],c=r[1],f=Math.min(s-u,c-o);if(M(e)){if(e.length!==f)throw Error("Invalid value array length");a=function(r){return e[r]}}else if(isMatrix(e)){var l=e.size();if(1!==l.length||l[0]!==f)throw Error("Invalid matrix length");a=function(r){return e.get([r])}}else a=function(){return e};n||(n=isBigNumber(a(0))?a(0).mul(0):0);var p=[];if(r.length>0){p=array_resize(p,r,n);for(var m=0;m<f;m++)p[m+u][m+o]=a(m)}return new DenseMatrix({data:p,size:[s,c]})},DenseMatrix.fromJSON=function(r){return new DenseMatrix(r)},DenseMatrix.prototype.swapRows=function(r,e){if(!isNumber(r)||!isInteger(r)||!isNumber(e)||!isInteger(e))throw Error("Row index must be positive integers");if(2!==this._size.length)throw Error("Only two dimensional matrix is supported");return validateIndex(r,this._size[0]),validateIndex(e,this._size[0]),DenseMatrix._swapRows(r,e,this._data),this},DenseMatrix._swapRows=function(r,e,t){var n=t[r];t[r]=t[e],t[e]=n},DenseMatrix},{isClass:!0}),W=t(8722);function getSafeProperty(r,e){if(isPlainObject(r)&&isSafeProperty(r,e))return r[e];if("function"==typeof r[e]&&!(null==r||"function"!=typeof r[e]||object_hasOwnProperty(r,e)&&Object.getPrototypeOf&&e in Object.getPrototypeOf(r))&&(object_hasOwnProperty(Y,e)||!(e in Object.prototype)&&!(e in Function.prototype)))throw Error('Cannot access method "'+e+'" as a property');throw Error('No access to property "'+e+'"')}function customs_setSafeProperty(r,e,t){if(isPlainObject(r)&&isSafeProperty(r,e))return r[e]=t,t;throw Error('No access to property "'+e+'"')}function isSafeProperty(r,e){return!!r&&"object"==typeof r&&(!!object_hasOwnProperty(X,e)||!(e in Object.prototype)&&!(e in Function.prototype))}function isPlainObject(r){return"object"==typeof r&&r&&r.constructor===Object}var X={length:!0,name:!0},Y={toString:!0,valueOf:!0,toLocaleString:!0};let ObjectWrappingMap=class ObjectWrappingMap{constructor(r){this.wrappedObject=r}keys(){return Object.keys(this.wrappedObject)}get(r){return getSafeProperty(this.wrappedObject,r)}set(r,e){return customs_setSafeProperty(this.wrappedObject,r,e),this}has(r){return r in this.wrappedObject}};function isMap(r){return!!r&&(r instanceof Map||r instanceof ObjectWrappingMap||"function"==typeof r.set&&"function"==typeof r.get&&"function"==typeof r.keys&&"function"==typeof r.has)}var _createTyped2=function(){return _createTyped2=W.create,W},G=factory_factory("typed",["?BigNumber","?Complex","?DenseMatrix","?Fraction"],function(r){var{BigNumber:e,Complex:t,DenseMatrix:n,Fraction:a}=r,o=_createTyped2();return o.clear(),o.addTypes([{name:"number",test:isNumber},{name:"Complex",test:isComplex},{name:"BigNumber",test:isBigNumber},{name:"Fraction",test:isFraction},{name:"Unit",test:isUnit},{name:"identifier",test:r=>isString&&/^(?:[A-Za-z\xAA\xB5\xBA\xC0-\xD6\xD8-\xF6\xF8-\u02C1\u02C6-\u02D1\u02E0-\u02E4\u02EC\u02EE\u0370-\u0374\u0376\u0377\u037A-\u037D\u037F\u0386\u0388-\u038A\u038C\u038E-\u03A1\u03A3-\u03F5\u03F7-\u0481\u048A-\u052F\u0531-\u0556\u0559\u0560-\u0588\u05D0-\u05EA\u05EF-\u05F2\u0620-\u064A\u066E\u066F\u0671-\u06D3\u06D5\u06E5\u06E6\u06EE\u06EF\u06FA-\u06FC\u06FF\u0710\u0712-\u072F\u074D-\u07A5\u07B1\u07CA-\u07EA\u07F4\u07F5\u07FA\u0800-\u0815\u081A\u0824\u0828\u0840-\u0858\u0860-\u086A\u0870-\u0887\u0889-\u088E\u08A0-\u08C9\u0904-\u0939\u093D\u0950\u0958-\u0961\u0971-\u0980\u0985-\u098C\u098F\u0990\u0993-\u09A8\u09AA-\u09B0\u09B2\u09B6-\u09B9\u09BD\u09CE\u09DC\u09DD\u09DF-\u09E1\u09F0\u09F1\u09FC\u0A05-\u0A0A\u0A0F\u0A10\u0A13-\u0A28\u0A2A-\u0A30\u0A32\u0A33\u0A35\u0A36\u0A38\u0A39\u0A59-\u0A5C\u0A5E\u0A72-\u0A74\u0A85-\u0A8D\u0A8F-\u0A91\u0A93-\u0AA8\u0AAA-\u0AB0\u0AB2\u0AB3\u0AB5-\u0AB9\u0ABD\u0AD0\u0AE0\u0AE1\u0AF9\u0B05-\u0B0C\u0B0F\u0B10\u0B13-\u0B28\u0B2A-\u0B30\u0B32\u0B33\u0B35-\u0B39\u0B3D\u0B5C\u0B5D\u0B5F-\u0B61\u0B71\u0B83\u0B85-\u0B8A\u0B8E-\u0B90\u0B92-\u0B95\u0B99\u0B9A\u0B9C\u0B9E\u0B9F\u0BA3\u0BA4\u0BA8-\u0BAA\u0BAE-\u0BB9\u0BD0\u0C05-\u0C0C\u0C0E-\u0C10\u0C12-\u0C28\u0C2A-\u0C39\u0C3D\u0C58-\u0C5A\u0C5D\u0C60\u0C61\u0C80\u0C85-\u0C8C\u0C8E-\u0C90\u0C92-\u0CA8\u0CAA-\u0CB3\u0CB5-\u0CB9\u0CBD\u0CDD\u0CDE\u0CE0\u0CE1\u0CF1\u0CF2\u0D04-\u0D0C\u0D0E-\u0D10\u0D12-\u0D3A\u0D3D\u0D4E\u0D54-\u0D56\u0D5F-\u0D61\u0D7A-\u0D7F\u0D85-\u0D96\u0D9A-\u0DB1\u0DB3-\u0DBB\u0DBD\u0DC0-\u0DC6\u0E01-\u0E30\u0E32\u0E33\u0E40-\u0E46\u0E81\u0E82\u0E84\u0E86-\u0E8A\u0E8C-\u0EA3\u0EA5\u0EA7-\u0EB0\u0EB2\u0EB3\u0EBD\u0EC0-\u0EC4\u0EC6\u0EDC-\u0EDF\u0F00\u0F40-\u0F47\u0F49-\u0F6C\u0F88-\u0F8C\u1000-\u102A\u103F\u1050-\u1055\u105A-\u105D\u1061\u1065\u1066\u106E-\u1070\u1075-\u1081\u108E\u10A0-\u10C5\u10C7\u10CD\u10D0-\u10FA\u10FC-\u1248\u124A-\u124D\u1250-\u1256\u1258\u125A-\u125D\u1260-\u1288\u128A-\u128D\u1290-\u12B0\u12B2-\u12B5\u12B8-\u12BE\u12C0\u12C2-\u12C5\u12C8-\u12D6\u12D8-\u1310\u1312-\u1315\u1318-\u135A\u1380-\u138F\u13A0-\u13F5\u13F8-\u13FD\u1401-\u166C\u166F-\u167F\u1681-\u169A\u16A0-\u16EA\u16F1-\u16F8\u1700-\u1711\u171F-\u1731\u1740-\u1751\u1760-\u176C\u176E-\u1770\u1780-\u17B3\u17D7\u17DC\u1820-\u1878\u1880-\u1884\u1887-\u18A8\u18AA\u18B0-\u18F5\u1900-\u191E\u1950-\u196D\u1970-\u1974\u1980-\u19AB\u19B0-\u19C9\u1A00-\u1A16\u1A20-\u1A54\u1AA7\u1B05-\u1B33\u1B45-\u1B4C\u1B83-\u1BA0\u1BAE\u1BAF\u1BBA-\u1BE5\u1C00-\u1C23\u1C4D-\u1C4F\u1C5A-\u1C7D\u1C80-\u1C88\u1C90-\u1CBA\u1CBD-\u1CBF\u1CE9-\u1CEC\u1CEE-\u1CF3\u1CF5\u1CF6\u1CFA\u1D00-\u1DBF\u1E00-\u1F15\u1F18-\u1F1D\u1F20-\u1F45\u1F48-\u1F4D\u1F50-\u1F57\u1F59\u1F5B\u1F5D\u1F5F-\u1F7D\u1F80-\u1FB4\u1FB6-\u1FBC\u1FBE\u1FC2-\u1FC4\u1FC6-\u1FCC\u1FD0-\u1FD3\u1FD6-\u1FDB\u1FE0-\u1FEC\u1FF2-\u1FF4\u1FF6-\u1FFC\u2071\u207F\u2090-\u209C\u2102\u2107\u210A-\u2113\u2115\u2119-\u211D\u2124\u2126\u2128\u212A-\u212D\u212F-\u2139\u213C-\u213F\u2145-\u2149\u214E\u2183\u2184\u2C00-\u2CE4\u2CEB-\u2CEE\u2CF2\u2CF3\u2D00-\u2D25\u2D27\u2D2D\u2D30-\u2D67\u2D6F\u2D80-\u2D96\u2DA0-\u2DA6\u2DA8-\u2DAE\u2DB0-\u2DB6\u2DB8-\u2DBE\u2DC0-\u2DC6\u2DC8-\u2DCE\u2DD0-\u2DD6\u2DD8-\u2DDE\u2E2F\u3005\u3006\u3031-\u3035\u303B\u303C\u3041-\u3096\u309D-\u309F\u30A1-\u30FA\u30FC-\u30FF\u3105-\u312F\u3131-\u318E\u31A0-\u31BF\u31F0-\u31FF\u3400-\u4DBF\u4E00-\uA48C\uA4D0-\uA4FD\uA500-\uA60C\uA610-\uA61F\uA62A\uA62B\uA640-\uA66E\uA67F-\uA69D\uA6A0-\uA6E5\uA717-\uA71F\uA722-\uA788\uA78B-\uA7CA\uA7D0\uA7D1\uA7D3\uA7D5-\uA7D9\uA7F2-\uA801\uA803-\uA805\uA807-\uA80A\uA80C-\uA822\uA840-\uA873\uA882-\uA8B3\uA8F2-\uA8F7\uA8FB\uA8FD\uA8FE\uA90A-\uA925\uA930-\uA946\uA960-\uA97C\uA984-\uA9B2\uA9CF\uA9E0-\uA9E4\uA9E6-\uA9EF\uA9FA-\uA9FE\uAA00-\uAA28\uAA40-\uAA42\uAA44-\uAA4B\uAA60-\uAA76\uAA7A\uAA7E-\uAAAF\uAAB1\uAAB5\uAAB6\uAAB9-\uAABD\uAAC0\uAAC2\uAADB-\uAADD\uAAE0-\uAAEA\uAAF2-\uAAF4\uAB01-\uAB06\uAB09-\uAB0E\uAB11-\uAB16\uAB20-\uAB26\uAB28-\uAB2E\uAB30-\uAB5A\uAB5C-\uAB69\uAB70-\uABE2\uAC00-\uD7A3\uD7B0-\uD7C6\uD7CB-\uD7FB\uF900-\uFA6D\uFA70-\uFAD9\uFB00-\uFB06\uFB13-\uFB17\uFB1D\uFB1F-\uFB28\uFB2A-\uFB36\uFB38-\uFB3C\uFB3E\uFB40\uFB41\uFB43\uFB44\uFB46-\uFBB1\uFBD3-\uFD3D\uFD50-\uFD8F\uFD92-\uFDC7\uFDF0-\uFDFB\uFE70-\uFE74\uFE76-\uFEFC\uFF21-\uFF3A\uFF41-\uFF5A\uFF66-\uFFBE\uFFC2-\uFFC7\uFFCA-\uFFCF\uFFD2-\uFFD7\uFFDA-\uFFDC]|\uD800[\uDC00-\uDC0B\uDC0D-\uDC26\uDC28-\uDC3A\uDC3C\uDC3D\uDC3F-\uDC4D\uDC50-\uDC5D\uDC80-\uDCFA\uDE80-\uDE9C\uDEA0-\uDED0\uDF00-\uDF1F\uDF2D-\uDF40\uDF42-\uDF49\uDF50-\uDF75\uDF80-\uDF9D\uDFA0-\uDFC3\uDFC8-\uDFCF]|\uD801[\uDC00-\uDC9D\uDCB0-\uDCD3\uDCD8-\uDCFB\uDD00-\uDD27\uDD30-\uDD63\uDD70-\uDD7A\uDD7C-\uDD8A\uDD8C-\uDD92\uDD94\uDD95\uDD97-\uDDA1\uDDA3-\uDDB1\uDDB3-\uDDB9\uDDBB\uDDBC\uDE00-\uDF36\uDF40-\uDF55\uDF60-\uDF67\uDF80-\uDF85\uDF87-\uDFB0\uDFB2-\uDFBA]|\uD802[\uDC00-\uDC05\uDC08\uDC0A-\uDC35\uDC37\uDC38\uDC3C\uDC3F-\uDC55\uDC60-\uDC76\uDC80-\uDC9E\uDCE0-\uDCF2\uDCF4\uDCF5\uDD00-\uDD15\uDD20-\uDD39\uDD80-\uDDB7\uDDBE\uDDBF\uDE00\uDE10-\uDE13\uDE15-\uDE17\uDE19-\uDE35\uDE60-\uDE7C\uDE80-\uDE9C\uDEC0-\uDEC7\uDEC9-\uDEE4\uDF00-\uDF35\uDF40-\uDF55\uDF60-\uDF72\uDF80-\uDF91]|\uD803[\uDC00-\uDC48\uDC80-\uDCB2\uDCC0-\uDCF2\uDD00-\uDD23\uDE80-\uDEA9\uDEB0\uDEB1\uDF00-\uDF1C\uDF27\uDF30-\uDF45\uDF70-\uDF81\uDFB0-\uDFC4\uDFE0-\uDFF6]|\uD804[\uDC03-\uDC37\uDC71\uDC72\uDC75\uDC83-\uDCAF\uDCD0-\uDCE8\uDD03-\uDD26\uDD44\uDD47\uDD50-\uDD72\uDD76\uDD83-\uDDB2\uDDC1-\uDDC4\uDDDA\uDDDC\uDE00-\uDE11\uDE13-\uDE2B\uDE3F\uDE40\uDE80-\uDE86\uDE88\uDE8A-\uDE8D\uDE8F-\uDE9D\uDE9F-\uDEA8\uDEB0-\uDEDE\uDF05-\uDF0C\uDF0F\uDF10\uDF13-\uDF28\uDF2A-\uDF30\uDF32\uDF33\uDF35-\uDF39\uDF3D\uDF50\uDF5D-\uDF61]|\uD805[\uDC00-\uDC34\uDC47-\uDC4A\uDC5F-\uDC61\uDC80-\uDCAF\uDCC4\uDCC5\uDCC7\uDD80-\uDDAE\uDDD8-\uDDDB\uDE00-\uDE2F\uDE44\uDE80-\uDEAA\uDEB8\uDF00-\uDF1A\uDF40-\uDF46]|\uD806[\uDC00-\uDC2B\uDCA0-\uDCDF\uDCFF-\uDD06\uDD09\uDD0C-\uDD13\uDD15\uDD16\uDD18-\uDD2F\uDD3F\uDD41\uDDA0-\uDDA7\uDDAA-\uDDD0\uDDE1\uDDE3\uDE00\uDE0B-\uDE32\uDE3A\uDE50\uDE5C-\uDE89\uDE9D\uDEB0-\uDEF8]|\uD807[\uDC00-\uDC08\uDC0A-\uDC2E\uDC40\uDC72-\uDC8F\uDD00-\uDD06\uDD08\uDD09\uDD0B-\uDD30\uDD46\uDD60-\uDD65\uDD67\uDD68\uDD6A-\uDD89\uDD98\uDEE0-\uDEF2\uDF02\uDF04-\uDF10\uDF12-\uDF33\uDFB0]|\uD808[\uDC00-\uDF99]|\uD809[\uDC80-\uDD43]|\uD80B[\uDF90-\uDFF0]|[\uD80C\uD81C-\uD820\uD822\uD840-\uD868\uD86A-\uD86C\uD86F-\uD872\uD874-\uD879\uD880-\uD883\uD885-\uD887][\uDC00-\uDFFF]|\uD80D[\uDC00-\uDC2F\uDC41-\uDC46]|\uD811[\uDC00-\uDE46]|\uD81A[\uDC00-\uDE38\uDE40-\uDE5E\uDE70-\uDEBE\uDED0-\uDEED\uDF00-\uDF2F\uDF40-\uDF43\uDF63-\uDF77\uDF7D-\uDF8F]|\uD81B[\uDE40-\uDE7F\uDF00-\uDF4A\uDF50\uDF93-\uDF9F\uDFE0\uDFE1\uDFE3]|\uD821[\uDC00-\uDFF7]|\uD823[\uDC00-\uDCD5\uDD00-\uDD08]|\uD82B[\uDFF0-\uDFF3\uDFF5-\uDFFB\uDFFD\uDFFE]|\uD82C[\uDC00-\uDD22\uDD32\uDD50-\uDD52\uDD55\uDD64-\uDD67\uDD70-\uDEFB]|\uD82F[\uDC00-\uDC6A\uDC70-\uDC7C\uDC80-\uDC88\uDC90-\uDC99]|\uD835[\uDC00-\uDC54\uDC56-\uDC9C\uDC9E\uDC9F\uDCA2\uDCA5\uDCA6\uDCA9-\uDCAC\uDCAE-\uDCB9\uDCBB\uDCBD-\uDCC3\uDCC5-\uDD05\uDD07-\uDD0A\uDD0D-\uDD14\uDD16-\uDD1C\uDD1E-\uDD39\uDD3B-\uDD3E\uDD40-\uDD44\uDD46\uDD4A-\uDD50\uDD52-\uDEA5\uDEA8-\uDEC0\uDEC2-\uDEDA\uDEDC-\uDEFA\uDEFC-\uDF14\uDF16-\uDF34\uDF36-\uDF4E\uDF50-\uDF6E\uDF70-\uDF88\uDF8A-\uDFA8\uDFAA-\uDFC2\uDFC4-\uDFCB]|\uD837[\uDF00-\uDF1E\uDF25-\uDF2A]|\uD838[\uDC30-\uDC6D\uDD00-\uDD2C\uDD37-\uDD3D\uDD4E\uDE90-\uDEAD\uDEC0-\uDEEB]|\uD839[\uDCD0-\uDCEB\uDFE0-\uDFE6\uDFE8-\uDFEB\uDFED\uDFEE\uDFF0-\uDFFE]|\uD83A[\uDC00-\uDCC4\uDD00-\uDD43\uDD4B]|\uD83B[\uDE00-\uDE03\uDE05-\uDE1F\uDE21\uDE22\uDE24\uDE27\uDE29-\uDE32\uDE34-\uDE37\uDE39\uDE3B\uDE42\uDE47\uDE49\uDE4B\uDE4D-\uDE4F\uDE51\uDE52\uDE54\uDE57\uDE59\uDE5B\uDE5D\uDE5F\uDE61\uDE62\uDE64\uDE67-\uDE6A\uDE6C-\uDE72\uDE74-\uDE77\uDE79-\uDE7C\uDE7E\uDE80-\uDE89\uDE8B-\uDE9B\uDEA1-\uDEA3\uDEA5-\uDEA9\uDEAB-\uDEBB]|\uD869[\uDC00-\uDEDF\uDF00-\uDFFF]|\uD86D[\uDC00-\uDF39\uDF40-\uDFFF]|\uD86E[\uDC00-\uDC1D\uDC20-\uDFFF]|\uD873[\uDC00-\uDEA1\uDEB0-\uDFFF]|\uD87A[\uDC00-\uDFE0]|\uD87E[\uDC00-\uDE1D]|\uD884[\uDC00-\uDF4A\uDF50-\uDFFF]|\uD888[\uDC00-\uDFAF])(?:[0-9A-Za-z\xAA\xB5\xBA\xC0-\xD6\xD8-\xF6\xF8-\u02C1\u02C6-\u02D1\u02E0-\u02E4\u02EC\u02EE\u0370-\u0374\u0376\u0377\u037A-\u037D\u037F\u0386\u0388-\u038A\u038C\u038E-\u03A1\u03A3-\u03F5\u03F7-\u0481\u048A-\u052F\u0531-\u0556\u0559\u0560-\u0588\u05D0-\u05EA\u05EF-\u05F2\u0620-\u064A\u066E\u066F\u0671-\u06D3\u06D5\u06E5\u06E6\u06EE\u06EF\u06FA-\u06FC\u06FF\u0710\u0712-\u072F\u074D-\u07A5\u07B1\u07CA-\u07EA\u07F4\u07F5\u07FA\u0800-\u0815\u081A\u0824\u0828\u0840-\u0858\u0860-\u086A\u0870-\u0887\u0889-\u088E\u08A0-\u08C9\u0904-\u0939\u093D\u0950\u0958-\u0961\u0971-\u0980\u0985-\u098C\u098F\u0990\u0993-\u09A8\u09AA-\u09B0\u09B2\u09B6-\u09B9\u09BD\u09CE\u09DC\u09DD\u09DF-\u09E1\u09F0\u09F1\u09FC\u0A05-\u0A0A\u0A0F\u0A10\u0A13-\u0A28\u0A2A-\u0A30\u0A32\u0A33\u0A35\u0A36\u0A38\u0A39\u0A59-\u0A5C\u0A5E\u0A72-\u0A74\u0A85-\u0A8D\u0A8F-\u0A91\u0A93-\u0AA8\u0AAA-\u0AB0\u0AB2\u0AB3\u0AB5-\u0AB9\u0ABD\u0AD0\u0AE0\u0AE1\u0AF9\u0B05-\u0B0C\u0B0F\u0B10\u0B13-\u0B28\u0B2A-\u0B30\u0B32\u0B33\u0B35-\u0B39\u0B3D\u0B5C\u0B5D\u0B5F-\u0B61\u0B71\u0B83\u0B85-\u0B8A\u0B8E-\u0B90\u0B92-\u0B95\u0B99\u0B9A\u0B9C\u0B9E\u0B9F\u0BA3\u0BA4\u0BA8-\u0BAA\u0BAE-\u0BB9\u0BD0\u0C05-\u0C0C\u0C0E-\u0C10\u0C12-\u0C28\u0C2A-\u0C39\u0C3D\u0C58-\u0C5A\u0C5D\u0C60\u0C61\u0C80\u0C85-\u0C8C\u0C8E-\u0C90\u0C92-\u0CA8\u0CAA-\u0CB3\u0CB5-\u0CB9\u0CBD\u0CDD\u0CDE\u0CE0\u0CE1\u0CF1\u0CF2\u0D04-\u0D0C\u0D0E-\u0D10\u0D12-\u0D3A\u0D3D\u0D4E\u0D54-\u0D56\u0D5F-\u0D61\u0D7A-\u0D7F\u0D85-\u0D96\u0D9A-\u0DB1\u0DB3-\u0DBB\u0DBD\u0DC0-\u0DC6\u0E01-\u0E30\u0E32\u0E33\u0E40-\u0E46\u0E81\u0E82\u0E84\u0E86-\u0E8A\u0E8C-\u0EA3\u0EA5\u0EA7-\u0EB0\u0EB2\u0EB3\u0EBD\u0EC0-\u0EC4\u0EC6\u0EDC-\u0EDF\u0F00\u0F40-\u0F47\u0F49-\u0F6C\u0F88-\u0F8C\u1000-\u102A\u103F\u1050-\u1055\u105A-\u105D\u1061\u1065\u1066\u106E-\u1070\u1075-\u1081\u108E\u10A0-\u10C5\u10C7\u10CD\u10D0-\u10FA\u10FC-\u1248\u124A-\u124D\u1250-\u1256\u1258\u125A-\u125D\u1260-\u1288\u128A-\u128D\u1290-\u12B0\u12B2-\u12B5\u12B8-\u12BE\u12C0\u12C2-\u12C5\u12C8-\u12D6\u12D8-\u1310\u1312-\u1315\u1318-\u135A\u1380-\u138F\u13A0-\u13F5\u13F8-\u13FD\u1401-\u166C\u166F-\u167F\u1681-\u169A\u16A0-\u16EA\u16F1-\u16F8\u1700-\u1711\u171F-\u1731\u1740-\u1751\u1760-\u176C\u176E-\u1770\u1780-\u17B3\u17D7\u17DC\u1820-\u1878\u1880-\u1884\u1887-\u18A8\u18AA\u18B0-\u18F5\u1900-\u191E\u1950-\u196D\u1970-\u1974\u1980-\u19AB\u19B0-\u19C9\u1A00-\u1A16\u1A20-\u1A54\u1AA7\u1B05-\u1B33\u1B45-\u1B4C\u1B83-\u1BA0\u1BAE\u1BAF\u1BBA-\u1BE5\u1C00-\u1C23\u1C4D-\u1C4F\u1C5A-\u1C7D\u1C80-\u1C88\u1C90-\u1CBA\u1CBD-\u1CBF\u1CE9-\u1CEC\u1CEE-\u1CF3\u1CF5\u1CF6\u1CFA\u1D00-\u1DBF\u1E00-\u1F15\u1F18-\u1F1D\u1F20-\u1F45\u1F48-\u1F4D\u1F50-\u1F57\u1F59\u1F5B\u1F5D\u1F5F-\u1F7D\u1F80-\u1FB4\u1FB6-\u1FBC\u1FBE\u1FC2-\u1FC4\u1FC6-\u1FCC\u1FD0-\u1FD3\u1FD6-\u1FDB\u1FE0-\u1FEC\u1FF2-\u1FF4\u1FF6-\u1FFC\u2071\u207F\u2090-\u209C\u2102\u2107\u210A-\u2113\u2115\u2119-\u211D\u2124\u2126\u2128\u212A-\u212D\u212F-\u2139\u213C-\u213F\u2145-\u2149\u214E\u2183\u2184\u2C00-\u2CE4\u2CEB-\u2CEE\u2CF2\u2CF3\u2D00-\u2D25\u2D27\u2D2D\u2D30-\u2D67\u2D6F\u2D80-\u2D96\u2DA0-\u2DA6\u2DA8-\u2DAE\u2DB0-\u2DB6\u2DB8-\u2DBE\u2DC0-\u2DC6\u2DC8-\u2DCE\u2DD0-\u2DD6\u2DD8-\u2DDE\u2E2F\u3005\u3006\u3031-\u3035\u303B\u303C\u3041-\u3096\u309D-\u309F\u30A1-\u30FA\u30FC-\u30FF\u3105-\u312F\u3131-\u318E\u31A0-\u31BF\u31F0-\u31FF\u3400-\u4DBF\u4E00-\uA48C\uA4D0-\uA4FD\uA500-\uA60C\uA610-\uA61F\uA62A\uA62B\uA640-\uA66E\uA67F-\uA69D\uA6A0-\uA6E5\uA717-\uA71F\uA722-\uA788\uA78B-\uA7CA\uA7D0\uA7D1\uA7D3\uA7D5-\uA7D9\uA7F2-\uA801\uA803-\uA805\uA807-\uA80A\uA80C-\uA822\uA840-\uA873\uA882-\uA8B3\uA8F2-\uA8F7\uA8FB\uA8FD\uA8FE\uA90A-\uA925\uA930-\uA946\uA960-\uA97C\uA984-\uA9B2\uA9CF\uA9E0-\uA9E4\uA9E6-\uA9EF\uA9FA-\uA9FE\uAA00-\uAA28\uAA40-\uAA42\uAA44-\uAA4B\uAA60-\uAA76\uAA7A\uAA7E-\uAAAF\uAAB1\uAAB5\uAAB6\uAAB9-\uAABD\uAAC0\uAAC2\uAADB-\uAADD\uAAE0-\uAAEA\uAAF2-\uAAF4\uAB01-\uAB06\uAB09-\uAB0E\uAB11-\uAB16\uAB20-\uAB26\uAB28-\uAB2E\uAB30-\uAB5A\uAB5C-\uAB69\uAB70-\uABE2\uAC00-\uD7A3\uD7B0-\uD7C6\uD7CB-\uD7FB\uF900-\uFA6D\uFA70-\uFAD9\uFB00-\uFB06\uFB13-\uFB17\uFB1D\uFB1F-\uFB28\uFB2A-\uFB36\uFB38-\uFB3C\uFB3E\uFB40\uFB41\uFB43\uFB44\uFB46-\uFBB1\uFBD3-\uFD3D\uFD50-\uFD8F\uFD92-\uFDC7\uFDF0-\uFDFB\uFE70-\uFE74\uFE76-\uFEFC\uFF21-\uFF3A\uFF41-\uFF5A\uFF66-\uFFBE\uFFC2-\uFFC7\uFFCA-\uFFCF\uFFD2-\uFFD7\uFFDA-\uFFDC]|\uD800[\uDC00-\uDC0B\uDC0D-\uDC26\uDC28-\uDC3A\uDC3C\uDC3D\uDC3F-\uDC4D\uDC50-\uDC5D\uDC80-\uDCFA\uDE80-\uDE9C\uDEA0-\uDED0\uDF00-\uDF1F\uDF2D-\uDF40\uDF42-\uDF49\uDF50-\uDF75\uDF80-\uDF9D\uDFA0-\uDFC3\uDFC8-\uDFCF]|\uD801[\uDC00-\uDC9D\uDCB0-\uDCD3\uDCD8-\uDCFB\uDD00-\uDD27\uDD30-\uDD63\uDD70-\uDD7A\uDD7C-\uDD8A\uDD8C-\uDD92\uDD94\uDD95\uDD97-\uDDA1\uDDA3-\uDDB1\uDDB3-\uDDB9\uDDBB\uDDBC\uDE00-\uDF36\uDF40-\uDF55\uDF60-\uDF67\uDF80-\uDF85\uDF87-\uDFB0\uDFB2-\uDFBA]|\uD802[\uDC00-\uDC05\uDC08\uDC0A-\uDC35\uDC37\uDC38\uDC3C\uDC3F-\uDC55\uDC60-\uDC76\uDC80-\uDC9E\uDCE0-\uDCF2\uDCF4\uDCF5\uDD00-\uDD15\uDD20-\uDD39\uDD80-\uDDB7\uDDBE\uDDBF\uDE00\uDE10-\uDE13\uDE15-\uDE17\uDE19-\uDE35\uDE60-\uDE7C\uDE80-\uDE9C\uDEC0-\uDEC7\uDEC9-\uDEE4\uDF00-\uDF35\uDF40-\uDF55\uDF60-\uDF72\uDF80-\uDF91]|\uD803[\uDC00-\uDC48\uDC80-\uDCB2\uDCC0-\uDCF2\uDD00-\uDD23\uDE80-\uDEA9\uDEB0\uDEB1\uDF00-\uDF1C\uDF27\uDF30-\uDF45\uDF70-\uDF81\uDFB0-\uDFC4\uDFE0-\uDFF6]|\uD804[\uDC03-\uDC37\uDC71\uDC72\uDC75\uDC83-\uDCAF\uDCD0-\uDCE8\uDD03-\uDD26\uDD44\uDD47\uDD50-\uDD72\uDD76\uDD83-\uDDB2\uDDC1-\uDDC4\uDDDA\uDDDC\uDE00-\uDE11\uDE13-\uDE2B\uDE3F\uDE40\uDE80-\uDE86\uDE88\uDE8A-\uDE8D\uDE8F-\uDE9D\uDE9F-\uDEA8\uDEB0-\uDEDE\uDF05-\uDF0C\uDF0F\uDF10\uDF13-\uDF28\uDF2A-\uDF30\uDF32\uDF33\uDF35-\uDF39\uDF3D\uDF50\uDF5D-\uDF61]|\uD805[\uDC00-\uDC34\uDC47-\uDC4A\uDC5F-\uDC61\uDC80-\uDCAF\uDCC4\uDCC5\uDCC7\uDD80-\uDDAE\uDDD8-\uDDDB\uDE00-\uDE2F\uDE44\uDE80-\uDEAA\uDEB8\uDF00-\uDF1A\uDF40-\uDF46]|\uD806[\uDC00-\uDC2B\uDCA0-\uDCDF\uDCFF-\uDD06\uDD09\uDD0C-\uDD13\uDD15\uDD16\uDD18-\uDD2F\uDD3F\uDD41\uDDA0-\uDDA7\uDDAA-\uDDD0\uDDE1\uDDE3\uDE00\uDE0B-\uDE32\uDE3A\uDE50\uDE5C-\uDE89\uDE9D\uDEB0-\uDEF8]|\uD807[\uDC00-\uDC08\uDC0A-\uDC2E\uDC40\uDC72-\uDC8F\uDD00-\uDD06\uDD08\uDD09\uDD0B-\uDD30\uDD46\uDD60-\uDD65\uDD67\uDD68\uDD6A-\uDD89\uDD98\uDEE0-\uDEF2\uDF02\uDF04-\uDF10\uDF12-\uDF33\uDFB0]|\uD808[\uDC00-\uDF99]|\uD809[\uDC80-\uDD43]|\uD80B[\uDF90-\uDFF0]|[\uD80C\uD81C-\uD820\uD822\uD840-\uD868\uD86A-\uD86C\uD86F-\uD872\uD874-\uD879\uD880-\uD883\uD885-\uD887][\uDC00-\uDFFF]|\uD80D[\uDC00-\uDC2F\uDC41-\uDC46]|\uD811[\uDC00-\uDE46]|\uD81A[\uDC00-\uDE38\uDE40-\uDE5E\uDE70-\uDEBE\uDED0-\uDEED\uDF00-\uDF2F\uDF40-\uDF43\uDF63-\uDF77\uDF7D-\uDF8F]|\uD81B[\uDE40-\uDE7F\uDF00-\uDF4A\uDF50\uDF93-\uDF9F\uDFE0\uDFE1\uDFE3]|\uD821[\uDC00-\uDFF7]|\uD823[\uDC00-\uDCD5\uDD00-\uDD08]|\uD82B[\uDFF0-\uDFF3\uDFF5-\uDFFB\uDFFD\uDFFE]|\uD82C[\uDC00-\uDD22\uDD32\uDD50-\uDD52\uDD55\uDD64-\uDD67\uDD70-\uDEFB]|\uD82F[\uDC00-\uDC6A\uDC70-\uDC7C\uDC80-\uDC88\uDC90-\uDC99]|\uD835[\uDC00-\uDC54\uDC56-\uDC9C\uDC9E\uDC9F\uDCA2\uDCA5\uDCA6\uDCA9-\uDCAC\uDCAE-\uDCB9\uDCBB\uDCBD-\uDCC3\uDCC5-\uDD05\uDD07-\uDD0A\uDD0D-\uDD14\uDD16-\uDD1C\uDD1E-\uDD39\uDD3B-\uDD3E\uDD40-\uDD44\uDD46\uDD4A-\uDD50\uDD52-\uDEA5\uDEA8-\uDEC0\uDEC2-\uDEDA\uDEDC-\uDEFA\uDEFC-\uDF14\uDF16-\uDF34\uDF36-\uDF4E\uDF50-\uDF6E\uDF70-\uDF88\uDF8A-\uDFA8\uDFAA-\uDFC2\uDFC4-\uDFCB]|\uD837[\uDF00-\uDF1E\uDF25-\uDF2A]|\uD838[\uDC30-\uDC6D\uDD00-\uDD2C\uDD37-\uDD3D\uDD4E\uDE90-\uDEAD\uDEC0-\uDEEB]|\uD839[\uDCD0-\uDCEB\uDFE0-\uDFE6\uDFE8-\uDFEB\uDFED\uDFEE\uDFF0-\uDFFE]|\uD83A[\uDC00-\uDCC4\uDD00-\uDD43\uDD4B]|\uD83B[\uDE00-\uDE03\uDE05-\uDE1F\uDE21\uDE22\uDE24\uDE27\uDE29-\uDE32\uDE34-\uDE37\uDE39\uDE3B\uDE42\uDE47\uDE49\uDE4B\uDE4D-\uDE4F\uDE51\uDE52\uDE54\uDE57\uDE59\uDE5B\uDE5D\uDE5F\uDE61\uDE62\uDE64\uDE67-\uDE6A\uDE6C-\uDE72\uDE74-\uDE77\uDE79-\uDE7C\uDE7E\uDE80-\uDE89\uDE8B-\uDE9B\uDEA1-\uDEA3\uDEA5-\uDEA9\uDEAB-\uDEBB]|\uD869[\uDC00-\uDEDF\uDF00-\uDFFF]|\uD86D[\uDC00-\uDF39\uDF40-\uDFFF]|\uD86E[\uDC00-\uDC1D\uDC20-\uDFFF]|\uD873[\uDC00-\uDEA1\uDEB0-\uDFFF]|\uD87A[\uDC00-\uDFE0]|\uD87E[\uDC00-\uDE1D]|\uD884[\uDC00-\uDF4A\uDF50-\uDFFF]|\uD888[\uDC00-\uDFAF])*$/.test(r)},{name:"string",test:isString},{name:"Chain",test:isChain},{name:"Array",test:M},{name:"Matrix",test:isMatrix},{name:"DenseMatrix",test:isDenseMatrix},{name:"SparseMatrix",test:isSparseMatrix},{name:"Range",test:isRange},{name:"Index",test:isIndex},{name:"boolean",test:isBoolean},{name:"ResultSet",test:isResultSet},{name:"Help",test:isHelp},{name:"function",test:isFunction},{name:"Date",test:isDate},{name:"RegExp",test:isRegExp},{name:"null",test:isNull},{name:"undefined",test:isUndefined},{name:"AccessorNode",test:isAccessorNode},{name:"ArrayNode",test:isArrayNode},{name:"AssignmentNode",test:isAssignmentNode},{name:"BlockNode",test:isBlockNode},{name:"ConditionalNode",test:isConditionalNode},{name:"ConstantNode",test:isConstantNode},{name:"FunctionNode",test:isFunctionNode},{name:"FunctionAssignmentNode",test:isFunctionAssignmentNode},{name:"IndexNode",test:isIndexNode},{name:"Node",test:isNode},{name:"ObjectNode",test:isObjectNode},{name:"OperatorNode",test:isOperatorNode},{name:"ParenthesisNode",test:isParenthesisNode},{name:"RangeNode",test:isRangeNode},{name:"RelationalNode",test:isRelationalNode},{name:"SymbolNode",test:isSymbolNode},{name:"Map",test:isMap},{name:"Object",test:is_isObject}]),o.addConversions([{from:"number",to:"BigNumber",convert:function(r){if(e||throwNoBignumber(r),r.toExponential().replace(/e.*$/,"").replace(/^0\.?0*|\./,"").length>15)throw TypeError("Cannot implicitly convert a number with >15 significant digits to BigNumber (value: "+r+"). Use function bignumber(x) to convert to BigNumber.");return new e(r)}},{from:"number",to:"Complex",convert:function(r){return t||throwNoComplex(r),new t(r,0)}},{from:"BigNumber",to:"Complex",convert:function(r){return t||throwNoComplex(r),new t(r.toNumber(),0)}},{from:"Fraction",to:"BigNumber",convert:function(r){throw TypeError("Cannot implicitly convert a Fraction to BigNumber or vice versa. Use function bignumber(x) to convert to BigNumber or fraction(x) to convert to Fraction.")}},{from:"Fraction",to:"Complex",convert:function(r){return t||throwNoComplex(r),new t(r.valueOf(),0)}},{from:"number",to:"Fraction",convert:function(r){a||throwNoFraction(r);var e=new a(r);if(e.valueOf()!==r)throw TypeError("Cannot implicitly convert a number to a Fraction when there will be a loss of precision (value: "+r+"). Use function fraction(x) to convert to Fraction.");return e}},{from:"string",to:"number",convert:function(r){var e=Number(r);if(isNaN(e))throw Error('Cannot convert "'+r+'" to a number');return e}},{from:"string",to:"BigNumber",convert:function(r){e||throwNoBignumber(r);try{return new e(r)}catch(e){throw Error('Cannot convert "'+r+'" to BigNumber')}}},{from:"string",to:"Fraction",convert:function(r){a||throwNoFraction(r);try{return new a(r)}catch(e){throw Error('Cannot convert "'+r+'" to Fraction')}}},{from:"string",to:"Complex",convert:function(r){t||throwNoComplex(r);try{return new t(r)}catch(e){throw Error('Cannot convert "'+r+'" to Complex')}}},{from:"boolean",to:"number",convert:function(r){return+r}},{from:"boolean",to:"BigNumber",convert:function(r){return e||throwNoBignumber(r),new e(+r)}},{from:"boolean",to:"Fraction",convert:function(r){return a||throwNoFraction(r),new a(+r)}},{from:"boolean",to:"string",convert:function(r){return String(r)}},{from:"Array",to:"Matrix",convert:function(r){return n||function(){throw Error("Cannot convert array into a Matrix: no class 'DenseMatrix' provided")}(),new n(r)}},{from:"Matrix",to:"Array",convert:function(r){return r.valueOf()}}]),o.onMismatch=(r,e,t)=>{var n=o.createError(r,e,t);if(["wrongType","mismatch"].includes(n.data.category)&&1===e.length&&isCollection(e[0])&&t.some(r=>!r.params.includes(","))){var a=TypeError("Function '".concat(r,"' doesn't apply to matrices. To call it ")+"elementwise on a matrix 'M', try 'map(M, ".concat(r,")'."));throw a.data=n.data,a}throw n},o.onMismatch=(r,e,t)=>{var n=o.createError(r,e,t);if(["wrongType","mismatch"].includes(n.data.category)&&1===e.length&&isCollection(e[0])&&t.some(r=>!r.params.includes(","))){var a=TypeError("Function '".concat(r,"' doesn't apply to matrices. To call it ")+"elementwise on a matrix 'M', try 'map(M, ".concat(r,")'."));throw a.data=n.data,a}throw n},o});function throwNoBignumber(r){throw Error("Cannot convert value ".concat(r," into a BigNumber: no class 'BigNumber' provided"))}function throwNoComplex(r){throw Error("Cannot convert value ".concat(r," into a Complex number: no class 'Complex' provided"))}function throwNoFraction(r){throw Error("Cannot convert value ".concat(r," into a Fraction, no class 'Fraction' provided."))}function containsCollections(r){for(var e=0;e<r.length;e++)if(isCollection(r[e]))return!0;return!1}function deepForEach(r,e){isMatrix(r)&&(r=r.valueOf());for(var t=0,n=r.length;t<n;t++){var a=r[t];Array.isArray(a)?deepForEach(a,e):e(a)}}function deepMap(r,e,t){return r&&"function"==typeof r.map?r.map(function(r){return deepMap(r,e,t)}):e(r)}function reduce(r,e,t){var n=Array.isArray(r)?arraySize(r):r.size();if(e<0||e>=n.length)throw new IndexError(e,n.length);return isMatrix(r)?r.create(_reduce(r.valueOf(),e,t)):_reduce(r,e,t)}function _reduce(r,e,t){var n,a,o,u;if(e<=0){if(Array.isArray(r[0])){for(n=0,u=function(r){var e,t,n=r.length,a=r[0].length,o=[];for(t=0;t<a;t++){var u=[];for(e=0;e<n;e++)u.push(r[e][t]);o.push(u)}return o}(r),a=[];n<u.length;n++)a[n]=_reduce(u[n],e-1,t);return a}for(n=1,o=r[0];n<r.length;n++)o=t(o,r[n]);return o}for(n=0,a=[];n<r.length;n++)a[n]=_reduce(r[n],e-1,t);return a}function scatter(r,e,t,n,a,o,u,s,c,f,l){var p,m,h,d,g=r._values,v=r._index,D=r._ptr;if(n)for(m=D[e],h=D[e+1],p=m;p<h;p++)t[d=v[p]]!==o?(t[d]=o,u.push(d),f?(n[d]=c?s(g[p],l):s(l,g[p]),a[d]=o):n[d]=g[p]):(n[d]=c?s(g[p],n[d]):s(n[d],g[p]),a[d]=o);else for(m=D[e],h=D[e+1],p=m;p<h;p++)t[d=v[p]]!==o?(t[d]=o,u.push(d)):a[d]=o}var Q="number",K="number, number";function absNumber(r){return Math.abs(r)}function addNumber(r,e){return r+e}function subtractNumber(r,e){return r-e}function multiplyNumber(r,e){return r*e}function unaryMinusNumber(r){return-r}function unaryPlusNumber(r){return r}function cbrtNumber(r){return T(r)}function expNumber(r){return Math.exp(r)}absNumber.signature=Q,addNumber.signature=K,subtractNumber.signature=K,multiplyNumber.signature=K,unaryMinusNumber.signature=Q,unaryPlusNumber.signature=Q,cbrtNumber.signature=Q,expNumber.signature=Q;function signNumber(r){return B(r)}function squareNumber(r){return r*r}function xgcdNumber(r,e){var t,n,a,o=0,u=1,s=1,c=0;if(!isInteger(r)||!isInteger(e))throw Error("Parameters in function xgcd must be integer numbers");for(;e;)n=Math.floor(r/e),a=r-n*e,t=o,o=u-n*o,u=t,t=s,s=c-n*s,c=t,r=e,e=a;return r<0?[-r,-u,-c]:[r,r?u:0,c]}function powNumber(r,e){return r*r<1&&e===1/0||r*r>1&&e===-1/0?0:Math.pow(r,e)}function roundNumber(r){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;if(!isInteger(e)||e<0||e>15)throw Error("Number of decimals in function round must be an integer from 0 to 15 inclusive");return parseFloat(toFixed(r,e))}signNumber.signature=Q,squareNumber.signature=Q,xgcdNumber.signature=K,powNumber.signature=K;var rr=(r=>{var{typed:e,config:t,BigNumber:n}=r;return e("unaryPlus",{number:unaryPlusNumber,Complex:function(r){return r},BigNumber:function(r){return r},Fraction:function(r){return r},Unit:function(r){return r.clone()},"Array | Matrix":e.referToSelf(r=>e=>deepMap(e,r,!0)),"boolean | string":function(r){return"BigNumber"===t.number?new n(+r):+r}})},factory_factory("abs",["typed"],r=>{var{typed:e}=r;return e("abs",{number:absNumber,"Complex | BigNumber | Fraction | Unit":r=>r.abs(),"Array | Matrix":e.referToSelf(r=>e=>deepMap(e,r,!0))})})),re="number",rt="addScalar",rn=factory_factory(rt,["typed"],r=>{var{typed:e}=r;return e(rt,{"number, number":addNumber,"Complex, Complex":function(r,e){return r.add(e)},"BigNumber, BigNumber":function(r,e){return r.plus(e)},"Fraction, Fraction":function(r,e){return r.add(e)},"Unit, Unit":e.referToSelf(r=>(t,n)=>{if(null===t.value||void 0===t.value)throw Error("Parameter x contains a unit with undefined value");if(null===n.value||void 0===n.value)throw Error("Parameter y contains a unit with undefined value");if(!t.equalBase(n))throw Error("Units do not match");var a=t.clone();return a.value=e.find(r,[a.valueType(),n.valueType()])(a.value,n.value),a.fixPrefix=!1,a})})}),ri=factory_factory("atan",["typed"],r=>{var{typed:e}=r;return e("atan",{number:function(r){return Math.atan(r)},Complex:function(r){return r.atan()},BigNumber:function(r){return r.atan()}})}),ra=factory_factory("bignumber",["typed","BigNumber"],r=>{var{typed:e,BigNumber:t}=r;return e("bignumber",{"":function(){return new t(0)},number:function(r){return new t(r+"")},string:function(r){var e=r.match(/(0[box][0-9a-fA-F]*)i([0-9]*)/);if(e){var n=e[2],a=t(e[1]),o=new t(2).pow(Number(n));if(a.gt(o.sub(1)))throw SyntaxError('String "'.concat(r,'" is out of range'));var u=new t(2).pow(Number(n)-1);return a.gte(u)?a.sub(o):a}return new t(r)},BigNumber:function(r){return r},Unit:e.referToSelf(r=>e=>{var t=e.clone();return t.value=r(e.value),t}),Fraction:function(r){return new t(r.n).div(r.d).times(r.s)},null:function(r){return new t(0)},"Array | Matrix":e.referToSelf(r=>e=>deepMap(e,r))})});function bitNotBigNumber(r){if(r.isFinite()&&!r.isInteger())throw Error("Integer expected in function bitNot");var e=r.constructor,t=e.precision;e.config({precision:1e9});var n=r.plus(new e(1));return n.s=-n.s||null,e.config({precision:t}),n}function bitwise(r,e,t){var n,a,o,u,s,c=r.constructor,f=+(r.s<0),l=+(e.s<0);if(f){n=decCoefficientToBinaryString(bitNotBigNumber(r));for(var p=0;p<n.length;++p)n[p]^=1}else n=decCoefficientToBinaryString(r);if(l){a=decCoefficientToBinaryString(bitNotBigNumber(e));for(var m=0;m<a.length;++m)a[m]^=1}else a=decCoefficientToBinaryString(e);n.length<=a.length?(o=n,u=a,s=f):(o=a,u=n,s=l);var h=o.length,d=u.length,g=1^t(f,l),v=new c(1^g),D=new c(1),y=new c(2),x=c.precision;for(c.config({precision:1e9});h>0;)t(o[--h],u[--d])===g&&(v=v.plus(D)),D=D.times(y);for(;d>0;)t(s,u[--d])===g&&(v=v.plus(D)),D=D.times(y);return c.config({precision:x}),0===g&&(v.s=-v.s),v}function decCoefficientToBinaryString(r){for(var e=r.d,t=e[0]+"",n=1;n<e.length;++n){for(var a=e[n]+"",o=7-a.length;o--;)a="0"+a;t+=a}for(var u=t.length;"0"===t.charAt(u);)u--;var s=r.e,c=t.slice(0,u+1||1),f=c.length;if(s>0){if(++s>f)for(s-=f;s--;)c+="0";else s<f&&(c=c.slice(0,s)+"."+c.slice(s))}for(var l=[0],p=0;p<c.length;){for(var m=l.length;m--;)l[m]*=10;l[0]+=parseInt(c.charAt(p++));for(var h=0;h<l.length;++h)l[h]>1&&((null===l[h+1]||void 0===l[h+1])&&(l[h+1]=0),l[h+1]+=l[h]>>1,l[h]&=1)}return l.reverse()}var ro="number, number";function product_product(r,e){if(e<r)return 1;if(e===r)return e;var t=e+r>>1;return product_product(r,t)*product_product(t+1,e)}function combinationsNumber(r,e){if(!isInteger(r)||r<0||!isInteger(e)||e<0)throw TypeError("Positive integer value expected in function combinations");if(e>r)throw TypeError("k must be less than or equal to n");for(var t=r-e,n=1,a=e<t?t+1:e+1,o=2,u=e<t?e:t,s=a;s<=r;++s)for(n*=s;o<=u&&n%o==0;)n/=o,++o;return o<=u&&(n/=product_product(o,u)),n}r=>{var{typed:e}=r;return e("clone",{any:object_clone})},combinationsNumber.signature="number, number";var ru="combinations";function isPositiveInteger(r){return r.isInteger()&&r.gte(0)}r=>{var{typed:e}=r;return e(ru,{"number, number":combinationsNumber,"BigNumber, BigNumber":function(r,e){var t,n,a=r.constructor,o=r.minus(e),u=new a(1);if(!isPositiveInteger(r)||!isPositiveInteger(e))throw TypeError("Positive integer value expected in function combinations");if(e.gt(r))throw TypeError("k must be less than n in function combinations");if(t=u,e.lt(o))for(n=u;n.lte(o);n=n.plus(u))t=t.times(e.plus(n)).dividedBy(n);else for(n=u;n.lte(e);n=n.plus(u))t=t.times(o.plus(n)).dividedBy(n);return t}})};var rs=factory_factory("complex",["typed","Complex"],r=>{var{typed:e,Complex:t}=r;return e("complex",{"":function(){return t.ZERO},number:function(r){return new t(r,0)},"number, number":function(r,e){return new t(r,e)},"BigNumber, BigNumber":function(r,e){return new t(r.toNumber(),e.toNumber())},Fraction:function(r){return new t(r.valueOf(),0)},Complex:function(r){return r.clone()},string:function(r){return t(r)},null:function(r){return t(0)},Object:function(r){if("re"in r&&"im"in r)return new t(r.re,r.im);if("r"in r&&"phi"in r||"abs"in r&&"arg"in r)return new t(r);throw Error("Expected object with properties (re and im) or (r and phi) or (abs and arg)")},"Array | Matrix":e.referToSelf(r=>e=>deepMap(e,r))})}),rc="conj",rf=factory_factory(rc,["typed"],r=>{var{typed:e}=r;return e(rc,{"number | BigNumber | Fraction":r=>r,Complex:r=>r.conjugate(),"Array | Matrix":e.referToSelf(r=>e=>deepMap(e,r))})}),rl=factory_factory("trigUnit",["typed"],r=>{var{typed:e}=r;return{Unit:e.referToSelf(r=>t=>{if(!t.hasBase(t.constructor.BASE_UNITS.ANGLE))throw TypeError("Unit in function cot is no angle");return e.find(r,t.valueType())(t.value)})}}),rp=factory_factory("cos",["typed"],r=>{var{typed:e}=r,t=rl({typed:e});return e("cos",{number:Math.cos,"Complex | BigNumber":r=>r.cos()},t)});function nearlyEqual_nearlyEqual(r,e,t){if(null==t)return r.eq(e);if(r.eq(e))return!0;if(r.isNaN()||e.isNaN())return!1;if(r.isFinite()&&e.isFinite()){var n=r.minus(e).abs();if(n.isZero())return!0;var a=r.constructor.max(r.abs(),e.abs());return n.lte(a.times(t))}return!1}var rm=factory_factory("compareUnits",["typed"],r=>{var{typed:e}=r;return{"Unit, Unit":e.referToSelf(r=>(t,n)=>{if(!t.equalBase(n))throw Error("Cannot compare units with different base");return e.find(r,[t.valueType(),n.valueType()])(t.value,n.value)})}}),rh="equalScalar",rd=factory_factory(rh,["typed","config"],r=>{var{typed:e,config:t}=r,n=rm({typed:e});return e(rh,{"boolean, boolean":function(r,e){return r===e},"number, number":function(r,e){return nearlyEqual(r,e,t.epsilon)},"BigNumber, BigNumber":function(r,e){return r.eq(e)||nearlyEqual_nearlyEqual(r,e,t.epsilon)},"Fraction, Fraction":function(r,e){return r.equals(e)},"Complex, Complex":function(r,e){var n;return n=t.epsilon,nearlyEqual(r.re,e.re,n)&&nearlyEqual(r.im,e.im,n)}},n)});function applyCallback(r,e,t,n,a){if(!W.isTypedFunction(r))return r(e,t,n);var o=[e,t,n],u=W.resolve(r,o);if(u)return tryWithArgs(u.implementation,o);var s=[e,t],c=W.resolve(r,s);if(c)return tryWithArgs(c.implementation,s);var f=[e],l=W.resolve(r,f);return l?tryWithArgs(l.implementation,f):tryWithArgs(r,o);function tryWithArgs(o,u){try{return o.apply(o,u)}catch(o){var s;if(o instanceof TypeError&&(null===(s=o.data)||void 0===s?void 0:s.category)==="wrongType"){var c=[];throw c.push("value: ".concat(typeOf(e))),u.length>=2&&c.push("index: ".concat(typeOf(t))),u.length>=3&&c.push("array: ".concat(typeOf(n))),TypeError("Function ".concat(a," cannot apply callback arguments ")+"".concat(r.name,"(").concat(c.join(", "),") at index ").concat(JSON.stringify(t)))}throw TypeError("Function ".concat(a," cannot apply callback arguments ")+"to function ".concat(r.name,": ").concat(o.message))}}}factory_factory(rh,["typed","config"],r=>{var{typed:e,config:t}=r;return e(rh,{"number, number":function(r,e){return nearlyEqual(r,e,t.epsilon)}})}),r=>{var{typed:e}=r;return e("exp",{number:expNumber,Complex:function(r){return r.exp()},BigNumber:function(r){return r.exp()}})};var rg="format",rv=(r=>{var{typed:e}=r;return e(rg,{any:string_format,"any, Object | function | number | BigNumber":string_format})},"getMatrixDataType"),rD=factory_factory(rv,["typed"],r=>{var{typed:e}=r;return e(rv,{Array:function(r){return getArrayDataType(r,typeOf)},Matrix:function(r){return r.getDataType()}})});factory_factory("hex",["typed","format"],r=>{var{typed:e,format:t}=r;return e("hex",{"number | BigNumber":function(r){return t(r,{notation:"hex"})},"number | BigNumber, number | BigNumber":function(r,e){return t(r,{notation:"hex",wordSize:e})}})});var ry=factory_factory("im",["typed"],r=>{var{typed:e}=r;return e("im",{number:()=>0,"BigNumber | Fraction":r=>r.mul(0),Complex:r=>r.im,"Array | Matrix":e.referToSelf(r=>e=>deepMap(e,r))})}),rx="isInteger",rb=factory_factory(rx,["typed"],r=>{var{typed:e}=r;return e(rx,{number:isInteger,BigNumber:function(r){return r.isInt()},Fraction:function(r){return 1===r.d&&isFinite(r.n)},"Array | Matrix":e.referToSelf(r=>e=>deepMap(e,r))})}),r_="number";function isNegativeNumber(r){return r<0}function isPositiveNumber(r){return r>0}function isZeroNumber(r){return 0===r}function isNaNNumber(r){return Number.isNaN(r)}isNegativeNumber.signature=r_,isPositiveNumber.signature=r_,isZeroNumber.signature=r_,isNaNNumber.signature=r_;var rE="isNegative",rw=(r=>{var{typed:e}=r;return e(rE,{number:isNegativeNumber,BigNumber:function(r){return r.isNeg()&&!r.isZero()&&!r.isNaN()},Fraction:function(r){return r.s<0},Unit:e.referToSelf(r=>t=>e.find(r,t.valueType())(t.value)),"Array | Matrix":e.referToSelf(r=>e=>deepMap(e,r))})},"isPositive"),rA=factory_factory(rw,["typed"],r=>{var{typed:e}=r;return e(rw,{number:isPositiveNumber,BigNumber:function(r){return!r.isNeg()&&!r.isZero()&&!r.isNaN()},Fraction:function(r){return r.s>0&&r.n>0},Unit:e.referToSelf(r=>t=>e.find(r,t.valueType())(t.value)),"Array | Matrix":e.referToSelf(r=>e=>deepMap(e,r))})}),rF="isZero",rC=factory_factory(rF,["typed"],r=>{var{typed:e}=r;return e(rF,{number:isZeroNumber,BigNumber:function(r){return r.isZero()},Complex:function(r){return 0===r.re&&0===r.im},Fraction:function(r){return 1===r.d&&0===r.n},Unit:e.referToSelf(r=>t=>e.find(r,t.valueType())(t.value)),"Array | Matrix":e.referToSelf(r=>e=>deepMap(e,r))})});function gammaNumber(r){if(isInteger(r))return r<=0?isFinite(r)?1/0:NaN:r>171?1/0:product_product(1,r-1);if(r<.5)return Math.PI/(Math.sin(Math.PI*r)*gammaNumber(1-r));if(r>=171.35)return 1/0;if(r>85){var e,t=r*r,n=t*r,a=n*r,o=a*r;return Math.sqrt(2*Math.PI/r)*Math.pow(r/Math.E,r)*(1+1/(12*r)+1/(288*t)-139/(51840*n)-571/(2488320*a)+163879/(209018880*o)+5246819/(75246796800*o*r))}--r,e=rN[0];for(var u=1;u<rN.length;++u)e+=rN[u]/(r+u);var s=r+rM+.5;return Math.sqrt(2*Math.PI)*Math.pow(s,r+.5)*Math.exp(-s)*e}gammaNumber.signature="number";var rM=4.7421875,rN=[.9999999999999971,57.15623566586292,-59.59796035547549,14.136097974741746,-.4919138160976202,3399464998481189e-20,4652362892704858e-20,-.00009837447530487956,1580887032249125e-19,-.00021026444172410488,21743961811521265e-20,-.0001643181065367639,8441822398385275e-20,-.000026190838401581408,36899182659531625e-22],rS=[1.000000000190015,76.18009172947146,-86.50532032941678,24.01409824083091,-1.231739572450155,.001208650973866179,-.000005395239384953],rB="log2";function _map(r,e){return function recurse(t,n){return Array.isArray(t)?t.map(function(r,e){return recurse(r,n.concat(e))}):applyCallback(e,t,n,r,"map")}(r,[])}r=>{var{typed:e,config:t,Complex:n}=r;return e(rB,{number:function(r){return r>=0||t.predictable?z(r):_log2Complex(new n(r,0))},Complex:_log2Complex,BigNumber:function(r){return!r.isNegative()||t.predictable?r.log(2):_log2Complex(new n(r.toNumber(),0))},"Array | Matrix":e.referToSelf(r=>e=>deepMap(e,r))});function _log2Complex(r){var e=Math.sqrt(r.re*r.re+r.im*r.im);return new n(Math.log2?Math.log2(e):Math.log(e)/Math.LN2,Math.atan2(r.im,r.re)/Math.LN2)}};var rz=factory_factory("multiplyScalar",["typed"],r=>{var{typed:e}=r;return e("multiplyScalar",{"number, number":multiplyNumber,"Complex, Complex":function(r,e){return r.mul(e)},"BigNumber, BigNumber":function(r,e){return r.times(e)},"Fraction, Fraction":function(r,e){return r.mul(e)},"number | Fraction | BigNumber | Complex, Unit":(r,e)=>e.multiply(r),"Unit, number | Fraction | BigNumber | Complex | Unit":(r,e)=>r.multiply(e)})}),rT="number, number";function notNumber(r){return!r}notNumber.signature="number",r=>{var{typed:e}=r;return e("not",{"null | undefined":()=>!0,number:notNumber,Complex:function(r){return 0===r.re&&0===r.im},BigNumber:function(r){return r.isZero()||r.isNaN()},Unit:e.referToSelf(r=>t=>e.find(r,t.valueType())(t.value)),"Array | Matrix":e.referToSelf(r=>e=>deepMap(e,r))})};var rI=factory_factory("number",["typed"],r=>{var{typed:e}=r,t=e("number",{"":function(){return 0},number:function(r){return r},string:function(r){if("NaN"===r)return NaN;var e,t,n=(t=(e=r).match(/(0[box])([0-9a-fA-F]*)\.([0-9a-fA-F]*)/))?{input:e,radix:({"0b":2,"0o":8,"0x":16})[t[1]],integerPart:t[2],fractionalPart:t[3]}:null;if(n)return function(r){for(var e=parseInt(r.integerPart,r.radix),t=0,n=0;n<r.fractionalPart.length;n++)t+=parseInt(r.fractionalPart[n],r.radix)/Math.pow(r.radix,n+1);var a=e+t;if(isNaN(a))throw SyntaxError('String "'+r.input+'" is not a valid number');return a}(n);var a=0,o=r.match(/(0[box][0-9a-fA-F]*)i([0-9]*)/);o&&(a=Number(o[2]),r=o[1]);var u=Number(r);if(isNaN(u))throw SyntaxError('String "'+r+'" is not a valid number');if(o){if(u>2**a-1)throw SyntaxError('String "'.concat(r,'" is out of range'));u>=2**(a-1)&&(u-=2**a)}return u},BigNumber:function(r){return r.toNumber()},Fraction:function(r){return r.valueOf()},Unit:e.referToSelf(r=>e=>{var t=e.clone();return t.value=r(e.value),t}),null:function(r){return 0},"Unit, string | Unit":function(r,e){return r.toNumber(e)},"Array | Matrix":e.referToSelf(r=>e=>deepMap(e,r))});return t.fromJSON=function(r){return parseFloat(r.value)},t});factory_factory("oct",["typed","format"],r=>{var{typed:e,format:t}=r;return e("oct",{"number | BigNumber":function(r){return t(r,{notation:"oct"})},"number | BigNumber, number | BigNumber":function(r,e){return t(r,{notation:"oct",wordSize:e})}})});var rO=t(711),rP=rO(Date.now()),rj=/\$([\w.]+)/g,rk=factory_factory("re",["typed"],r=>{var{typed:e}=r;return e("re",{"number | BigNumber | Fraction":r=>r,Complex:r=>r.re,"Array | Matrix":e.referToSelf(r=>e=>deepMap(e,r))})}),rq="sign",rR=factory_factory(rq,["typed","BigNumber","Fraction","complex"],r=>{var{typed:e,BigNumber:t,complex:n,Fraction:a}=r;return e(rq,{number:signNumber,Complex:function(r){return 0===r.im?n(signNumber(r.re)):r.sign()},BigNumber:function(r){return new t(r.cmp(0))},Fraction:function(r){return new a(r.s,1)},"Array | Matrix":e.referToSelf(r=>e=>deepMap(e,r,!0)),Unit:e.referToSelf(r=>t=>{if(!t._isDerived()&&0!==t.units[0].unit.offset)throw TypeError("sign is ambiguous for units with offset");return e.find(r,t.valueType())(t.value)})})}),rU=factory_factory("sin",["typed"],r=>{var{typed:e}=r,t=rl({typed:e});return e("sin",{number:Math.sin,"Complex | BigNumber":r=>r.sin()},t)}),rL=factory_factory("SparseMatrix",["typed","equalScalar","Matrix"],r=>{var{typed:e,equalScalar:t,Matrix:n}=r;function SparseMatrix(r,e){if(!(this instanceof SparseMatrix))throw SyntaxError("Constructor must be called with the new operator");if(e&&!isString(e))throw Error("Invalid datatype: "+e);if(isMatrix(r))"SparseMatrix"===r.type?(this._values=r._values?object_clone(r._values):void 0,this._index=object_clone(r._index),this._ptr=object_clone(r._ptr),this._size=object_clone(r._size),this._datatype=e||r._datatype):_createFromArray(this,r.valueOf(),e||r._datatype);else if(r&&M(r.index)&&M(r.ptr)&&M(r.size))this._values=r.values,this._index=r.index,this._ptr=r.ptr,this._size=r.size,this._datatype=e||r.datatype;else if(M(r))_createFromArray(this,r,e);else if(r)throw TypeError("Unsupported type of data ("+typeOf(r)+")");else this._values=[],this._index=[],this._ptr=[0],this._size=[0,0],this._datatype=e}function _createFromArray(r,n,a){r._values=[],r._index=[],r._ptr=[],r._datatype=a;var o=n.length,u=0,s=t,c=0;if(isString(a)&&(s=e.find(t,[a,a])||t,c=e.convert(0,a)),o>0){var f=0;do{r._ptr.push(r._index.length);for(var l=0;l<o;l++){var p=n[l];if(M(p)){if(0===f&&u<p.length&&(u=p.length),f<p.length){var m=p[f];s(m,c)||(r._values.push(m),r._index.push(l))}}else 0===f&&u<1&&(u=1),s(p,c)||(r._values.push(p),r._index.push(l))}f++}while(f<u)}r._ptr.push(r._index.length),r._size=[o,u]}function _getValueIndex(r,e,t,n){if(t-e==0)return t;for(var a=e;a<t;a++)if(n[a]===r)return a;return e}function _insert(r,e,t,n,a,o,u){a.splice(r,0,n),o.splice(r,0,e);for(var s=t+1;s<u.length;s++)u[s]++}function _resize(r,n,a,o){var u,s,c,f=o||0,l=t,p=0;isString(r._datatype)&&(l=e.find(t,[r._datatype,r._datatype])||t,p=e.convert(0,r._datatype),f=e.convert(f,r._datatype));var m=!l(f,p),h=r._size[0],d=r._size[1];if(a>d){for(s=d;s<a;s++)if(r._ptr[s]=r._values.length,m)for(u=0;u<h;u++)r._values.push(f),r._index.push(u);r._ptr[a]=r._values.length}else a<d&&(r._ptr.splice(a+1,d-a),r._values.splice(r._ptr[a],r._values.length),r._index.splice(r._ptr[a],r._index.length));if(d=a,n>h){if(m){var g=0;for(s=0;s<d;s++){r._ptr[s]=r._ptr[s]+g,c=r._ptr[s+1]+g;var v=0;for(u=h;u<n;u++,v++)r._values.splice(c+v,0,f),r._index.splice(c+v,0,u),g++}r._ptr[d]=r._values.length}}else if(n<h){var D=0;for(s=0;s<d;s++){r._ptr[s]=r._ptr[s]-D;var y=r._ptr[s],x=r._ptr[s+1]-D;for(c=y;c<x;c++)(u=r._index[c])>n-1&&(r._values.splice(c,1),r._index.splice(c,1),D++)}r._ptr[s]=r._values.length}return r._size[0]=n,r._size[1]=a,r}function _toArray(r,e,t,n,a){var o,u,s=n[0],c=n[1],f=[];for(o=0;o<s;o++)for(u=0,f[o]=[];u<c;u++)f[o][u]=0;for(u=0;u<c;u++)for(var l=t[u],p=t[u+1],m=l;m<p;m++)f[o=e[m]][u]=r?a?object_clone(r[m]):r[m]:1;return f}return SparseMatrix.prototype=new n,SparseMatrix.prototype.createSparseMatrix=function(r,e){return new SparseMatrix(r,e)},Object.defineProperty(SparseMatrix,"name",{value:"SparseMatrix"}),SparseMatrix.prototype.constructor=SparseMatrix,SparseMatrix.prototype.type="SparseMatrix",SparseMatrix.prototype.isSparseMatrix=!0,SparseMatrix.prototype.getDataType=function(){return getArrayDataType(this._values,typeOf)},SparseMatrix.prototype.storage=function(){return"sparse"},SparseMatrix.prototype.datatype=function(){return this._datatype},SparseMatrix.prototype.create=function(r,e){return new SparseMatrix(r,e)},SparseMatrix.prototype.density=function(){var r=this._size[0],e=this._size[1];return 0!==r&&0!==e?this._index.length/(r*e):0},SparseMatrix.prototype.subset=function(r,e,t){if(!this._values)throw Error("Cannot invoke subset on a Pattern only matrix");switch(arguments.length){case 1:return function(r,e){if(!isIndex(e))throw TypeError("Invalid index");if(e.isScalar())return r.get(e.min());var t,n,a,o,u=e.size();if(u.length!==r._size.length)throw new DimensionError(u.length,r._size.length);var s=e.min(),c=e.max();for(t=0,n=r._size.length;t<n;t++)validateIndex(s[t],r._size[t]),validateIndex(c[t],r._size[t]);var f=r._values,l=r._index,p=r._ptr,m=e.dimension(0),h=e.dimension(1),d=[],g=[];m.forEach(function(r,e){g[r]=e[0],d[r]=!0});var v=f?[]:void 0,D=[],y=[];return h.forEach(function(r){for(y.push(D.length),a=p[r],o=p[r+1];a<o;a++)!0===d[t=l[a]]&&(D.push(g[t]),v&&v.push(f[a]))}),y.push(D.length),new SparseMatrix({values:v,index:D,ptr:y,size:u,datatype:r._datatype})}(this,r);case 2:case 3:return function(r,e,t,n){if(!e||!0!==e.isIndex)throw TypeError("Invalid index");var a,o=e.size(),u=e.isScalar();if(isMatrix(t)?(a=t.size(),t=t.toArray()):a=arraySize(t),u){if(0!==a.length)throw TypeError("Scalar expected");r.set(e.min(),t,n)}else{if(1!==o.length&&2!==o.length)throw new DimensionError(o.length,r._size.length,"<");if(a.length<o.length){for(var s=0,c=0;1===o[s]&&1===a[s];)s++;for(;1===o[s];)c++,s++;t=unsqueeze(t,o.length,c,a)}if(!deepStrictEqual(o,a))throw new DimensionError(o,a,">");if(1===o.length)e.dimension(0).forEach(function(e,a){validateIndex(e),r.set([e,0],t[a[0]],n)});else{var f=e.dimension(0),l=e.dimension(1);f.forEach(function(e,a){validateIndex(e),l.forEach(function(o,u){validateIndex(o),r.set([e,o],t[a[0]][u[0]],n)})})}}return r}(this,r,e,t);default:throw SyntaxError("Wrong number of arguments")}},SparseMatrix.prototype.get=function(r){if(!M(r))throw TypeError("Array expected");if(r.length!==this._size.length)throw new DimensionError(r.length,this._size.length);if(!this._values)throw Error("Cannot invoke get on a Pattern only matrix");var e=r[0],t=r[1];validateIndex(e,this._size[0]),validateIndex(t,this._size[1]);var n=_getValueIndex(e,this._ptr[t],this._ptr[t+1],this._index);return n<this._ptr[t+1]&&this._index[n]===e?this._values[n]:0},SparseMatrix.prototype.set=function(r,n,a){if(!M(r))throw TypeError("Array expected");if(r.length!==this._size.length)throw new DimensionError(r.length,this._size.length);if(!this._values)throw Error("Cannot invoke set on a Pattern only matrix");var o=r[0],u=r[1],s=this._size[0],c=this._size[1],f=t,l=0;isString(this._datatype)&&(f=e.find(t,[this._datatype,this._datatype])||t,l=e.convert(0,this._datatype)),(o>s-1||u>c-1)&&(_resize(this,Math.max(o+1,s),Math.max(u+1,c),a),s=this._size[0],c=this._size[1]),validateIndex(o,s),validateIndex(u,c);var p=_getValueIndex(o,this._ptr[u],this._ptr[u+1],this._index);return p<this._ptr[u+1]&&this._index[p]===o?f(n,l)?function(r,e,t,n,a){t.splice(r,1),n.splice(r,1);for(var o=e+1;o<a.length;o++)a[o]--}(p,u,this._values,this._index,this._ptr):this._values[p]=n:f(n,l)||_insert(p,o,u,n,this._values,this._index,this._ptr),this},SparseMatrix.prototype.resize=function(r,e,t){if(!isCollection(r))throw TypeError("Array or Matrix expected");var n=r.valueOf().map(r=>Array.isArray(r)&&1===r.length?r[0]:r);if(2!==n.length)throw Error("Only two dimensions matrix are supported");return n.forEach(function(r){if(!isNumber(r)||!isInteger(r)||r<0)throw TypeError("Invalid size, must contain positive integers (size: "+string_format(n)+")")}),_resize(t?this.clone():this,n[0],n[1],e)},SparseMatrix.prototype.reshape=function(r,e){if(!M(r))throw TypeError("Array expected");if(2!==r.length)throw Error("Sparse matrices can only be reshaped in two dimensions");r.forEach(function(e){if(!isNumber(e)||!isInteger(e)||e<=-2||0===e)throw TypeError("Invalid size, must contain positive integers or -1 (size: "+string_format(r)+")")});var t=this._size[0]*this._size[1],n=(r=processSizesWildcard(r,t))[0]*r[1];if(t!==n)throw Error("Reshaping sparse matrix will result in the wrong number of elements");var a=e?this.clone():this;if(this._size[0]===r[0]&&this._size[1]===r[1])return a;for(var o=[],u=0;u<a._ptr.length;u++)for(var s=0;s<a._ptr[u+1]-a._ptr[u];s++)o.push(u);for(var c=a._values.slice(),f=a._index.slice(),l=0;l<a._index.length;l++){var p=f[l],m=o[l],h=p*a._size[1]+m;o[l]=h%r[1],f[l]=Math.floor(h/r[1])}a._values.length=0,a._index.length=0,a._ptr.length=r[1]+1,a._size=r.slice();for(var d=0;d<a._ptr.length;d++)a._ptr[d]=0;for(var g=0;g<c.length;g++){var v=f[g],D=o[g],y=c[g];_insert(_getValueIndex(v,a._ptr[D],a._ptr[D+1],a._index),v,D,y,a._values,a._index,a._ptr)}return a},SparseMatrix.prototype.clone=function(){return new SparseMatrix({values:this._values?object_clone(this._values):void 0,index:object_clone(this._index),ptr:object_clone(this._ptr),size:object_clone(this._size),datatype:this._datatype})},SparseMatrix.prototype.size=function(){return this._size.slice(0)},SparseMatrix.prototype.map=function(r,n){if(!this._values)throw Error("Cannot invoke map on a Pattern only matrix");var a=this,o=this._size[0],u=this._size[1],s=maxArgumentCount(r);return function(r,n,a,o,u,s,c){var f=[],l=[],p=[],m=t,h=0;isString(r._datatype)&&(m=e.find(t,[r._datatype,r._datatype])||t,h=e.convert(0,r._datatype));for(var invoke=function(r,e,t){r=s(r,e,t),m(r,h)||(f.push(r),l.push(e))},d=o;d<=u;d++){p.push(f.length);var g=r._ptr[d],v=r._ptr[d+1];if(c)for(var D=g;D<v;D++){var y=r._index[D];y>=n&&y<=a&&invoke(r._values[D],y-n,d-o)}else{for(var x={},b=g;b<v;b++)x[r._index[b]]=r._values[b];for(var _=n;_<=a;_++)invoke(_ in x?x[_]:0,_-n,d-o)}}return p.push(f.length),new SparseMatrix({values:f,index:l,ptr:p,size:[a-n+1,u-o+1]})}(this,0,o-1,0,u-1,function(e,t,n){return 1===s?r(e):2===s?r(e,[t,n]):r(e,[t,n],a)},n)},SparseMatrix.prototype.forEach=function(r,e){if(!this._values)throw Error("Cannot invoke forEach on a Pattern only matrix");for(var t=this._size[0],n=this._size[1],a=0;a<n;a++){var o=this._ptr[a],u=this._ptr[a+1];if(e)for(var s=o;s<u;s++){var c=this._index[s];r(this._values[s],[c,a],this)}else{for(var f={},l=o;l<u;l++)f[this._index[l]]=this._values[l];for(var p=0;p<t;p++)r(p in f?f[p]:0,[p,a],this)}}},SparseMatrix.prototype[Symbol.iterator]=function*(){if(!this._values)throw Error("Cannot iterate a Pattern only matrix");for(var r=this._size[1],e=0;e<r;e++)for(var t=this._ptr[e],n=this._ptr[e+1],a=t;a<n;a++){var o=this._index[a];yield{value:this._values[a],index:[o,e]}}},SparseMatrix.prototype.toArray=function(){return _toArray(this._values,this._index,this._ptr,this._size,!0)},SparseMatrix.prototype.valueOf=function(){return _toArray(this._values,this._index,this._ptr,this._size,!1)},SparseMatrix.prototype.format=function(r){for(var e=this._size[0],t=this._size[1],n=this.density(),a="Sparse Matrix ["+string_format(e,r)+" x "+string_format(t,r)+"] density: "+string_format(n,r)+"\n",o=0;o<t;o++)for(var u=this._ptr[o],s=this._ptr[o+1],c=u;c<s;c++)a+="\n    ("+string_format(this._index[c],r)+", "+string_format(o,r)+") ==> "+(this._values?string_format(this._values[c],r):"X");return a},SparseMatrix.prototype.toString=function(){return string_format(this.toArray())},SparseMatrix.prototype.toJSON=function(){return{mathjs:"SparseMatrix",values:this._values,index:this._index,ptr:this._ptr,size:this._size,datatype:this._datatype}},SparseMatrix.prototype.diagonal=function(r){if(r){if(isBigNumber(r)&&(r=r.toNumber()),!isNumber(r)||!isInteger(r))throw TypeError("The parameter k must be an integer number")}else r=0;var e=r>0?r:0,t=r<0?-r:0,n=this._size[0],a=this._size[1],o=Math.min(n-t,a-e),u=[],s=[],c=[];c[0]=0;for(var f=e;f<a&&u.length<o;f++)for(var l=this._ptr[f],p=this._ptr[f+1],m=l;m<p;m++){var h=this._index[m];if(h===f-e+t){u.push(this._values[m]),s[u.length-1]=h-t;break}}return c.push(u.length),new SparseMatrix({values:u,index:s,ptr:c,size:[o,1]})},SparseMatrix.fromJSON=function(r){return new SparseMatrix(r)},SparseMatrix.diagonal=function(r,n,a,o,u){if(!M(r))throw TypeError("Array expected, size parameter");if(2!==r.length)throw Error("Only two dimensions matrix are supported");if(r=r.map(function(r){if(isBigNumber(r)&&(r=r.toNumber()),!isNumber(r)||!isInteger(r)||r<1)throw Error("Size values must be positive integers");return r}),a){if(isBigNumber(a)&&(a=a.toNumber()),!isNumber(a)||!isInteger(a))throw TypeError("The parameter k must be an integer number")}else a=0;var s,c=t,f=0;isString(u)&&(c=e.find(t,[u,u])||t,f=e.convert(0,u));var l=a>0?a:0,p=a<0?-a:0,m=r[0],h=r[1],d=Math.min(m-p,h-l);if(M(n)){if(n.length!==d)throw Error("Invalid value array length");s=function(r){return n[r]}}else if(isMatrix(n)){var g=n.size();if(1!==g.length||g[0]!==d)throw Error("Invalid matrix length");s=function(r){return n.get([r])}}else s=function(){return n};for(var v=[],D=[],y=[],x=0;x<h;x++){y.push(v.length);var b=x-l;if(b>=0&&b<d){var _=s(b);c(_,f)||(D.push(b+p),v.push(_))}}return y.push(v.length),new SparseMatrix({values:v,index:D,ptr:y,size:[m,h]})},SparseMatrix.prototype.swapRows=function(r,e){if(!isNumber(r)||!isInteger(r)||!isNumber(e)||!isInteger(e))throw Error("Row index must be positive integers");if(2!==this._size.length)throw Error("Only two dimensional matrix is supported");return validateIndex(r,this._size[0]),validateIndex(e,this._size[0]),SparseMatrix._swapRows(r,e,this._size[1],this._values,this._index,this._ptr),this},SparseMatrix._forEachRow=function(r,e,t,n,a){for(var o=n[r],u=n[r+1],s=o;s<u;s++)a(t[s],e[s])},SparseMatrix._swapRows=function(r,e,t,n,a,o){for(var u=0;u<t;u++){var s=o[u],c=o[u+1],f=_getValueIndex(r,s,c,a),l=_getValueIndex(e,s,c,a);if(f<c&&l<c&&a[f]===r&&a[l]===e){if(n){var p=n[f];n[f]=n[l],n[l]=p}continue}if(f<c&&a[f]===r&&(l>=c||a[l]!==e)){var m=n?n[f]:void 0;a.splice(l,0,e),n&&n.splice(l,0,m),a.splice(l<=f?f+1:f,1),n&&n.splice(l<=f?f+1:f,1);continue}if(l<c&&a[l]===e&&(f>=c||a[f]!==r)){var h=n?n[l]:void 0;a.splice(f,0,r),n&&n.splice(f,0,h),a.splice(f<=l?l+1:l,1),n&&n.splice(f<=l?l+1:l,1)}}},SparseMatrix},{isClass:!0}),rZ="square",rV=factory_factory(rZ,["typed"],r=>{var{typed:e}=r;return e(rZ,{number:squareNumber,Complex:function(r){return r.mul(r)},BigNumber:function(r){return r.times(r)},Fraction:function(r){return r.mul(r)},Unit:function(r){return r.pow(2)}})}),rH="subtractScalar",rJ=factory_factory(rH,["typed"],r=>{var{typed:e}=r;return e(rH,{"number, number":subtractNumber,"Complex, Complex":function(r,e){return r.sub(e)},"BigNumber, BigNumber":function(r,e){return r.minus(e)},"Fraction, Fraction":function(r,e){return r.sub(e)},"Unit, Unit":e.referToSelf(r=>(t,n)=>{if(null===t.value||void 0===t.value)throw Error("Parameter x contains a unit with undefined value");if(null===n.value||void 0===n.value)throw Error("Parameter y contains a unit with undefined value");if(!t.equalBase(n))throw Error("Units do not match");var a=t.clone();return a.value=e.find(r,[a.valueType(),n.valueType()])(a.value,n.value),a.fixPrefix=!1,a})})}),r$="apply";function _apply(r,e,t){var n,a,o;if(e<=0){if(!Array.isArray(r[0]))return t(r);for(n=0,o=function(r){var e,t,n=r.length,a=r[0].length,o=[];for(t=0;t<a;t++){var u=[];for(e=0;e<n;e++)u.push(r[e][t]);o.push(u)}return o}(r),a=[];n<o.length;n++)a[n]=_apply(o[n],e-1,t);return a}for(n=0,a=[];n<r.length;n++)a[n]=_apply(r[n],e-1,t);return a}r=>{var{typed:e,isInteger:t}=r;return e(r$,{"Array | Matrix, number | BigNumber, function":function(r,e,n){if(!t(e))throw TypeError("Integer number expected for dimension");var a=Array.isArray(r)?arraySize(r):r.size();if(e<0||e>=a.length)throw new IndexError(e,a.length);return isMatrix(r)?r.create(_apply(r.valueOf(),e,n)):_apply(r,e,n)}})},factory_factory("bin",["typed","format"],r=>{var{typed:e,format:t}=r;return e("bin",{"number | BigNumber":function(r){return t(r,{notation:"bin"})},"number | BigNumber, number | BigNumber":function(r,e){return t(r,{notation:"bin",wordSize:e})}})});var rW="isNaN",rX=factory_factory(rW,["typed"],r=>{var{typed:e}=r;return e(rW,{number:isNaNNumber,BigNumber:function(r){return r.isNaN()},Fraction:function(r){return!1},Complex:function(r){return r.isNaN()},Unit:function(r){return Number.isNaN(r.value)},"Array | Matrix":function(r){return deepMap(r,Number.isNaN)}})}),rY=factory_factory("sqrt",["config","typed","Complex"],r=>{var{config:e,typed:t,Complex:n}=r;return t("sqrt",{number:_sqrtNumber,Complex:function(r){return r.sqrt()},BigNumber:function(r){return!r.isNegative()||e.predictable?r.sqrt():_sqrtNumber(r.toNumber())},Unit:function(r){return r.pow(.5)}});function _sqrtNumber(r){return isNaN(r)?NaN:r>=0||e.predictable?Math.sqrt(r):new n(r,0).sqrt()}}),rG="unaryMinus",rQ=factory_factory(rG,["typed"],r=>{var{typed:e}=r;return e(rG,{number:unaryMinusNumber,"Complex | BigNumber | Fraction":r=>r.neg(),Unit:e.referToSelf(r=>t=>{var n=t.clone();return n.value=e.find(r,n.valueType())(t.value),n}),"Array | Matrix":e.referToSelf(r=>e=>deepMap(e,r,!0))})}),rK=factory_factory("fraction",["typed","Fraction"],r=>{var{typed:e,Fraction:t}=r;return e("fraction",{number:function(r){if(!isFinite(r)||isNaN(r))throw Error(r+" cannot be represented as a fraction");return new t(r)},string:function(r){return new t(r)},"number, number":function(r,e){return new t(r,e)},null:function(r){return new t(0)},BigNumber:function(r){return new t(r.toString())},Fraction:function(r){return r},Unit:e.referToSelf(r=>e=>{var t=e.clone();return t.value=r(e.value),t}),Object:function(r){return new t(r)},"Array | Matrix":e.referToSelf(r=>e=>deepMap(e,r))})}),r0="isNumeric",r1=factory_factory(r0,["typed"],r=>{var{typed:e}=r;return e(r0,{"number | BigNumber | Fraction | boolean":()=>!0,"Complex | Unit | string | null | undefined | Node":()=>!1,"Array | Matrix":e.referToSelf(r=>e=>deepMap(e,r))})}),r2="matrix",r8=factory_factory(r2,["typed","Matrix","DenseMatrix","SparseMatrix"],r=>{var{typed:e,Matrix:t,DenseMatrix:n,SparseMatrix:a}=r;return e(r2,{"":function(){return _create([])},string:function(r){return _create([],r)},"string, string":function(r,e){return _create([],r,e)},Array:function(r){return _create(r)},Matrix:function(r){return _create(r,r.storage())},"Array | Matrix, string":_create,"Array | Matrix, string, string":_create});function _create(r,e,t){if("dense"===e||"default"===e||void 0===e)return new n(r,t);if("sparse"===e)return new a(r,t);throw TypeError("Unknown matrix type "+JSON.stringify(e)+".")}}),r3="mode",r5=factory_factory(r3,["typed","isNaN","isNumeric"],r=>{var{typed:e,isNaN:t,isNumeric:n}=r;return e(r3,{"Array | Matrix":_mode,"...":function(r){return _mode(r)}});function _mode(r){if(0===(r=flatten(r.valueOf())).length)throw Error("Cannot calculate mode of an empty array");for(var e={},a=[],o=0,u=0;u<r.length;u++){var s=r[u];if(n(s)&&t(s))throw Error("Cannot calculate mode of an array containing NaN values");s in e||(e[s]=0),e[s]++,e[s]===o?a.push(s):e[s]>o&&(o=e[s],a=[s])}return a}});function noBignumber(){throw Error('No "bignumber" implementation available')}function noFraction(){throw Error('No "fraction" implementation available')}function noMatrix(){throw Error('No "matrix" implementation available')}var r7=factory_factory("numeric",["number","?bignumber","?fraction"],r=>{var{number:e,bignumber:t,fraction:n}=r,a={string:!0,number:!0,BigNumber:!0,Fraction:!0},o={number:r=>e(r),BigNumber:t?r=>t(r):noBignumber,Fraction:n?r=>n(r):noFraction};return function(r){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"number",t=arguments.length>2?arguments[2]:void 0;if(void 0!==t)throw SyntaxError("numeric() takes one or two arguments");var n=typeOf(r);if(!(n in a))throw TypeError("Cannot convert "+r+' of type "'+n+'"; valid input types are '+Object.keys(a).join(", "));if(!(e in o))throw TypeError("Cannot convert "+r+' to type "'+e+'"; valid output types are '+Object.keys(o).join(", "));return e===n?r:o[e](r)}});function improveErrorMessage(r,e,t){var n;return -1!==String(r).indexOf("Unexpected type")?(n=arguments.length>2?" (type: "+typeOf(t)+", value: "+JSON.stringify(t)+")":" (type: "+r.data.actual+")",TypeError("Cannot calculate "+e+", unexpected type of argument"+n)):-1!==String(r).indexOf("complex numbers")?(n=arguments.length>2?" (type: "+typeOf(t)+", value: "+JSON.stringify(t)+")":"",TypeError("Cannot calculate "+e+", no ordering relation is defined for complex numbers"+n)):r}var r9=(r=>{var{typed:e,config:t,multiplyScalar:n,numeric:a}=r;return e("prod",{"Array | Matrix":_prod,"Array | Matrix, number | BigNumber":function(r,e){throw Error("prod(A, dim) is not yet supported")},"...":function(r){return _prod(r)}});function _prod(r){var e;if(deepForEach(r,function(r){try{e=void 0===e?r:n(e,r)}catch(e){throw improveErrorMessage(e,"prod",r)}}),"string"==typeof e&&(e=a(e,t.number)),void 0===e)throw Error("Cannot calculate prod of an empty array");return e}},"reshape"),r4=factory_factory(r9,["typed","isInteger","matrix"],r=>{var{typed:e,isInteger:t}=r;return e(r9,{"Matrix, Array":function(r,e){return r.reshape(e,!0)},"Array, Array":function(r,e){return e.forEach(function(r){if(!t(r))throw TypeError("Invalid size for dimension: "+r)}),reshape(r,e)}})}),r6="size",er=factory_factory(r6,["typed","config","?matrix"],r=>{var{typed:e,config:t,matrix:n}=r;return e(r6,{Matrix:function(r){return r.create(r.size())},Array:arraySize,string:function(r){return"Array"===t.matrix?[r.length]:n([r.length])},"number | Complex | BigNumber | Unit | boolean | null":function(r){return"Array"===t.matrix?[]:n?n([]):noMatrix()}})}),ee="transpose",et=factory_factory(ee,["typed","matrix"],r=>{var{typed:e,matrix:t}=r;return e(ee,{Array:r=>transposeMatrix(t(r)).valueOf(),Matrix:transposeMatrix,any:object_clone});function transposeMatrix(r){var e,t=r.size();switch(t.length){case 1:e=r.clone();break;case 2:var n=t[0],a=t[1];if(0===a)throw RangeError("Cannot transpose a 2D matrix with no columns (size: "+string_format(t)+")");switch(r.storage()){case"dense":e=function(r,e,t){for(var n,a=r._data,o=[],u=0;u<t;u++){n=o[u]=[];for(var s=0;s<e;s++)n[s]=object_clone(a[s][u])}return r.createDenseMatrix({data:o,size:[t,e],datatype:r._datatype})}(r,n,a);break;case"sparse":e=function(r,e,t){for(var n,a,o,u=r._values,s=r._index,c=r._ptr,f=u?[]:void 0,l=[],p=[],m=[],h=0;h<e;h++)m[h]=0;for(n=0,a=s.length;n<a;n++)m[s[n]]++;for(var d=0,g=0;g<e;g++)p.push(d),d+=m[g],m[g]=p[g];for(p.push(d),o=0;o<t;o++)for(var v=c[o],D=c[o+1],y=v;y<D;y++){var x=m[s[y]]++;l[x]=o,u&&(f[x]=object_clone(u[y]))}return r.createSparseMatrix({values:f,index:l,ptr:p,size:[t,e],datatype:r._datatype})}(r,n,a)}break;default:throw RangeError("Matrix must be a vector or two dimensional (size: "+string_format(t)+")")}return e}}),en=(r=>{var{typed:e,config:t,matrix:n,BigNumber:a}=r;return e("xgcd",{"number, number":function(r,e){var a=xgcdNumber(r,e);return"Array"===t.matrix?a:n(a)},"BigNumber, BigNumber":function(r,e){var o,u,s,c,f=new a(0),l=new a(1),p=f,m=l,h=l,d=f;if(!r.isInt()||!e.isInt())throw Error("Parameters in function xgcd must be integer numbers");for(;!e.isZero();)u=r.div(e).floor(),s=r.mod(e),o=p,p=m.minus(u.times(p)),m=o,o=h,h=d.minus(u.times(h)),d=o,r=e,e=s;return c=r.lt(f)?[r.neg(),m.neg(),d.neg()]:[r,r.isZero()?0:m,d],"Array"===t.matrix?c:n(c)}})},"zeros"),ei=factory_factory(en,["typed","config","matrix","BigNumber"],r=>{var{typed:e,config:t,matrix:n,BigNumber:a}=r;return e(en,{"":function(){return"Array"===t.matrix?_zeros([]):_zeros([],"default")},"...number | BigNumber | string":function(r){if("string"==typeof r[r.length-1]){var e=r.pop();return _zeros(r,e)}return"Array"===t.matrix?_zeros(r):_zeros(r,"default")},Array:_zeros,Matrix:function(r){var e=r.storage();return _zeros(r.valueOf(),e)},"Array | Matrix, string":function(r,e){return _zeros(r.valueOf(),e)}});function _zeros(r,e){var t,o=(t=!1,r.forEach(function(r,e,n){isBigNumber(r)&&(t=!0,n[e]=r.toNumber())}),t)?new a(0):0;if(function(r){r.forEach(function(r){if("number"!=typeof r||!isInteger(r)||r<0)throw Error("Parameters in function zeros must be positive integers")})}(r),e){var u=n(e);return r.length>0?u.resize(r,o):u}var s=[];return r.length>0?array_resize(s,r,o):s}}),ea=(r=>{var{config:e,typed:t,isNegative:n,unaryMinus:a,matrix:o,Complex:u,BigNumber:s,Fraction:c}=r;return t("cbrt",{number:cbrtNumber,Complex:_cbrtComplex,"Complex, boolean":_cbrtComplex,BigNumber:function(r){return r.cbrt()},Unit:function(r){if(r.value&&isComplex(r.value)){var e=r.clone();return e.value=1,(e=e.pow(1/3)).value=_cbrtComplex(r.value),e}var t,o=n(r.value);o&&(r.value=a(r.value)),t=isBigNumber(r.value)?new s(1).div(3):isFraction(r.value)?new c(1,3):1/3;var u=r.pow(t);return o&&(u.value=a(u.value)),u}});function _cbrtComplex(r,t){var n=r.arg()/3,a=r.abs(),s=new u(cbrtNumber(a),0).mul(new u(0,n).exp());if(!t)return s;var c=[s,new u(cbrtNumber(a),0).mul(new u(0,n+2*Math.PI/3).exp()),new u(cbrtNumber(a),0).mul(new u(0,n-2*Math.PI/3).exp())];return"Array"===e.matrix?c:o(c)}},"concat"),eo=factory_factory(ea,["typed","matrix","isInteger"],r=>{var{typed:e,matrix:t,isInteger:n}=r;return e(ea,{"...Array | Matrix | number | BigNumber":function(r){var e,a,o=r.length,u=-1,s=!1,c=[];for(e=0;e<o;e++){var f=r[e];if(isMatrix(f)&&(s=!0),isNumber(f)||isBigNumber(f)){if(e!==o-1)throw Error("Dimension must be specified as last argument");if(a=u,!n(u=f.valueOf()))throw TypeError("Integer number expected for dimension");if(u<0||e>0&&u>a)throw new IndexError(u,a+1)}else{var l=object_clone(f).valueOf(),p=arraySize(l);if(c[e]=l,a=u,u=p.length-1,e>0&&u!==a)throw new DimensionError(a+1,u+1)}}if(0===c.length)throw SyntaxError("At least one matrix expected");for(var m=c.shift();c.length;)m=concat(m,c.shift(),u);return s?t(m):m},"...string":function(r){return r.join("")}})}),eu="ctranspose",es=factory_factory(eu,["typed","transpose","conj"],r=>{var{typed:e,transpose:t,conj:n}=r;return e(eu,{any:function(r){return n(t(r))}})}),ec="diag",ef=factory_factory(ec,["typed","matrix","DenseMatrix","SparseMatrix"],r=>{var{typed:e,matrix:t,DenseMatrix:n,SparseMatrix:a}=r;return e(ec,{Array:function(r){return _diag(r,0,arraySize(r),null)},"Array, number":function(r,e){return _diag(r,e,arraySize(r),null)},"Array, BigNumber":function(r,e){return _diag(r,e.toNumber(),arraySize(r),null)},"Array, string":function(r,e){return _diag(r,0,arraySize(r),e)},"Array, number, string":function(r,e,t){return _diag(r,e,arraySize(r),t)},"Array, BigNumber, string":function(r,e,t){return _diag(r,e.toNumber(),arraySize(r),t)},Matrix:function(r){return _diag(r,0,r.size(),r.storage())},"Matrix, number":function(r,e){return _diag(r,e,r.size(),r.storage())},"Matrix, BigNumber":function(r,e){return _diag(r,e.toNumber(),r.size(),r.storage())},"Matrix, string":function(r,e){return _diag(r,0,r.size(),e)},"Matrix, number, string":function(r,e,t){return _diag(r,e,r.size(),t)},"Matrix, BigNumber, string":function(r,e,t){return _diag(r,e.toNumber(),r.size(),t)}});function _diag(r,e,o,u){if(!isInteger(e))throw TypeError("Second parameter in function diag must be an integer");var s=e>0?e:0,c=e<0?-e:0;switch(o.length){case 1:return function(r,e,t,o,u,s){var c=[o+u,o+s];if(t&&"sparse"!==t&&"dense"!==t)throw TypeError("Unknown matrix type ".concat(t,'"'));var f="sparse"===t?a.diagonal(c,r,e):n.diagonal(c,r,e);return null!==t?f:f.valueOf()}(r,e,u,o[0],c,s);case 2:return function(r,e,n,a,o,u){if(isMatrix(r)){var s=r.diagonal(e);return null!==n?n!==s.storage()?t(s,n):s:s.valueOf()}for(var c=Math.min(a[0]-o,a[1]-u),f=[],l=0;l<c;l++)f[l]=r[l+o][l+u];return null!==n?t(f):f}(r,e,u,o,c,s)}throw RangeError("Matrix for function diag must be 2 dimensional")}}),el="divideScalar",ep=factory_factory(el,["typed","numeric"],r=>{var{typed:e,numeric:t}=r;return e(el,{"number, number":function(r,e){return r/e},"Complex, Complex":function(r,e){return r.div(e)},"BigNumber, BigNumber":function(r,e){return r.div(e)},"Fraction, Fraction":function(r,e){return r.div(e)},"Unit, number | Complex | Fraction | BigNumber | Unit":(r,e)=>r.divide(e),"number | Fraction | Complex | BigNumber, Unit":(r,e)=>e.divideInto(r)})}),em=factory_factory("matAlgo02xDS0",["typed","equalScalar"],r=>{var{typed:e,equalScalar:t}=r;return function(r,n,a,o){var u,s=r._data,c=r._size,f=r._datatype,l=n._values,p=n._index,m=n._ptr,h=n._size,d=n._datatype;if(c.length!==h.length)throw new DimensionError(c.length,h.length);if(c[0]!==h[0]||c[1]!==h[1])throw RangeError("Dimension mismatch. Matrix A ("+c+") must match Matrix B ("+h+")");if(!l)throw Error("Cannot perform operation on Dense Matrix and Pattern Sparse Matrix");var g=c[0],v=c[1],D=t,y=0,x=a;"string"==typeof f&&f===d&&(u=f,D=e.find(t,[u,u]),y=e.convert(0,u),x=e.find(a,[u,u]));for(var b=[],_=[],E=[],w=0;w<v;w++){E[w]=_.length;for(var A=m[w],F=m[w+1],C=A;C<F;C++){var M=p[C],N=o?x(l[C],s[M][w]):x(s[M][w],l[C]);D(N,y)||(_.push(M),b.push(N))}}return E[v]=_.length,n.createSparseMatrix({values:b,index:_,ptr:E,size:[g,v],datatype:u})}}),eh=factory_factory("matAlgo03xDSf",["typed"],r=>{var{typed:e}=r;return function(r,t,n,a){var o,u=r._data,s=r._size,c=r._datatype,f=t._values,l=t._index,p=t._ptr,m=t._size,h=t._datatype;if(s.length!==m.length)throw new DimensionError(s.length,m.length);if(s[0]!==m[0]||s[1]!==m[1])throw RangeError("Dimension mismatch. Matrix A ("+s+") must match Matrix B ("+m+")");if(!f)throw Error("Cannot perform operation on Dense Matrix and Pattern Sparse Matrix");var d=s[0],g=s[1],v=0,D=n;"string"==typeof c&&c===h&&(o=c,v=e.convert(0,o),D=e.find(n,[o,o]));for(var y=[],x=0;x<d;x++)y[x]=[];for(var b=[],_=[],E=0;E<g;E++){for(var w=E+1,A=p[E],F=p[E+1],C=A;C<F;C++){var M=l[C];b[M]=a?D(f[C],u[M][E]):D(u[M][E],f[C]),_[M]=w}for(var N=0;N<d;N++)_[N]===w?y[N][E]=b[N]:y[N][E]=a?D(v,u[N][E]):D(u[N][E],v)}return r.createDenseMatrix({data:y,size:[d,g],datatype:o})}}),ed=factory_factory("matAlgo07xSSf",["typed","DenseMatrix"],r=>{var{typed:e,DenseMatrix:t}=r;return function(r,n,a){var o,u,s,c=r._size,f=r._datatype,l=n._size,p=n._datatype;if(c.length!==l.length)throw new DimensionError(c.length,l.length);if(c[0]!==l[0]||c[1]!==l[1])throw RangeError("Dimension mismatch. Matrix A ("+c+") must match Matrix B ("+l+")");var m=c[0],h=c[1],d=0,g=a;"string"==typeof f&&f===p&&(o=f,d=e.convert(0,o),g=e.find(a,[o,o]));var v=[];for(u=0;u<m;u++)v[u]=[];var D=[],y=[],x=[],b=[];for(s=0;s<h;s++){var _=s+1;for(_scatter(r,s,x,D,_),_scatter(n,s,b,y,_),u=0;u<m;u++){var E=x[u]===_?D[u]:d,w=b[u]===_?y[u]:d;v[u][s]=g(E,w)}}return new t({data:v,size:[m,h],datatype:o})};function _scatter(r,e,t,n,a){for(var o=r._values,u=r._index,s=r._ptr,c=s[e],f=s[e+1];c<f;c++){var l=u[c];t[l]=a,n[l]=o[c]}}}),eg=factory_factory("matAlgo11xS0s",["typed","equalScalar"],r=>{var{typed:e,equalScalar:t}=r;return function(r,n,a,o){var u,s=r._values,c=r._index,f=r._ptr,l=r._size,p=r._datatype;if(!s)throw Error("Cannot perform operation on Pattern Sparse Matrix and Scalar value");var m=l[0],h=l[1],d=t,g=0,v=a;"string"==typeof p&&(u=p,d=e.find(t,[u,u]),g=e.convert(0,u),n=e.convert(n,u),v=e.find(a,[u,u]));for(var D=[],y=[],x=[],b=0;b<h;b++){x[b]=y.length;for(var _=f[b],E=f[b+1],w=_;w<E;w++){var A=c[w],F=o?v(n,s[w]):v(s[w],n);d(F,g)||(y.push(A),D.push(F))}}return x[h]=y.length,r.createSparseMatrix({values:D,index:y,ptr:x,size:[m,h],datatype:u})}}),ev=factory_factory("matAlgo12xSfs",["typed","DenseMatrix"],r=>{var{typed:e,DenseMatrix:t}=r;return function(r,n,a,o){var u,s=r._values,c=r._index,f=r._ptr,l=r._size,p=r._datatype;if(!s)throw Error("Cannot perform operation on Pattern Sparse Matrix and Scalar value");var m=l[0],h=l[1],d=a;"string"==typeof p&&(u=p,n=e.convert(n,u),d=e.find(a,[u,u]));for(var g=[],v=[],D=[],y=0;y<h;y++){for(var x=y+1,b=f[y],_=f[y+1],E=b;E<_;E++){var w=c[E];v[w]=s[E],D[w]=x}for(var A=0;A<m;A++)0===y&&(g[A]=[]),D[A]===x?g[A][y]=o?d(n,v[A]):d(v[A],n):g[A][y]=o?d(n,0):d(0,n)}return new t({data:g,size:[m,h],datatype:u})}}),eD=factory_factory("matAlgo13xDD",["typed"],r=>{var{typed:e}=r;return function(r,t,n){var a,o=r._data,u=r._size,s=r._datatype,c=t._data,f=t._size,l=t._datatype,p=[];if(u.length!==f.length)throw new DimensionError(u.length,f.length);for(var m=0;m<u.length;m++){if(u[m]!==f[m])throw RangeError("Dimension mismatch. Matrix A ("+u+") must match Matrix B ("+f+")");p[m]=u[m]}var h=n;"string"==typeof s&&s===l&&(a=s,h=e.find(n,[a,a]));var d=p.length>0?function _iterate(r,e,t,n,a,o){var u=[];if(e===t.length-1)for(var s=0;s<n;s++)u[s]=r(a[s],o[s]);else for(var c=0;c<n;c++)u[c]=_iterate(r,e+1,t,t[e+1],a[c],o[c]);return u}(h,0,p,p[0],o,c):[];return r.createDenseMatrix({data:d,size:p,datatype:a})}}),ey=factory_factory("matAlgo14xDs",["typed"],r=>{var{typed:e}=r;return function(r,t,n,a){var o,u=r._data,s=r._size,c=r._datatype,f=n;"string"==typeof c&&(o=c,t=e.convert(t,o),f=e.find(n,[o,o]));var l=s.length>0?function _iterate(r,e,t,n,a,o,u){var s=[];if(e===t.length-1)for(var c=0;c<n;c++)s[c]=u?r(o,a[c]):r(a[c],o);else for(var f=0;f<n;f++)s[f]=_iterate(r,e+1,t,t[e+1],a[f],o,u);return s}(f,0,s,s[0],u,t,a):[];return r.createDenseMatrix({data:l,size:object_clone(s),datatype:o})}}),ex=factory_factory("broadcast",["concat"],r=>{var{concat:e}=r;return function(r,e){var t=Math.max(r._size.length,e._size.length);if(r._size.length===e._size.length&&r._size.every((r,t)=>r===e._size[t]))return[r,e];for(var n=_padLeft(r._size,t,0),a=_padLeft(e._size,t,0),o=[],u=0;u<t;u++)o[u]=Math.max(n[u],a[u]);checkBroadcastingRules(n,o),checkBroadcastingRules(a,o);var s=r.clone(),c=e.clone();s._size.length<t?s.reshape(_padLeft(s._size,t,1)):c._size.length<t&&c.reshape(_padLeft(c._size,t,1));for(var f=0;f<t;f++)s._size[f]<o[f]&&(s=_stretch(s,o[f],f)),c._size[f]<o[f]&&(c=_stretch(c,o[f],f));return[s,c]};function _padLeft(r,e,t){return[...Array(e-r.length).fill(t),...r]}function _stretch(r,t,n){return e(...Array(t).fill(r),n)}}),eb=factory_factory("matrixAlgorithmSuite",["typed","matrix","concat"],r=>{var{typed:e,matrix:t,concat:n}=r,a=eD({typed:e}),o=ey({typed:e}),u=ex({concat:n});return function(r){var n,s=r.elop,c=r.SD||r.DS;s?(n={"DenseMatrix, DenseMatrix":(r,e)=>a(...u(r,e),s),"Array, Array":(r,e)=>a(...u(t(r),t(e)),s).valueOf(),"Array, DenseMatrix":(r,e)=>a(...u(t(r),e),s),"DenseMatrix, Array":(r,e)=>a(...u(r,t(e)),s)},r.SS&&(n["SparseMatrix, SparseMatrix"]=(e,t)=>r.SS(...u(e,t),s,!1)),r.DS&&(n["DenseMatrix, SparseMatrix"]=(e,t)=>r.DS(...u(e,t),s,!1),n["Array, SparseMatrix"]=(e,n)=>r.DS(...u(t(e),n),s,!1)),c&&(n["SparseMatrix, DenseMatrix"]=(r,e)=>c(...u(e,r),s,!0),n["SparseMatrix, Array"]=(r,e)=>c(...u(t(e),r),s,!0))):(n={"DenseMatrix, DenseMatrix":e.referToSelf(r=>(e,t)=>a(...u(e,t),r)),"Array, Array":e.referToSelf(r=>(e,n)=>a(...u(t(e),t(n)),r).valueOf()),"Array, DenseMatrix":e.referToSelf(r=>(e,n)=>a(...u(t(e),n),r)),"DenseMatrix, Array":e.referToSelf(r=>(e,n)=>a(...u(e,t(n)),r))},r.SS&&(n["SparseMatrix, SparseMatrix"]=e.referToSelf(e=>(t,n)=>r.SS(...u(t,n),e,!1))),r.DS&&(n["DenseMatrix, SparseMatrix"]=e.referToSelf(e=>(t,n)=>r.DS(...u(t,n),e,!1)),n["Array, SparseMatrix"]=e.referToSelf(e=>(n,a)=>r.DS(...u(t(n),a),e,!1))),c&&(n["SparseMatrix, DenseMatrix"]=e.referToSelf(r=>(e,t)=>c(...u(t,e),r,!0)),n["SparseMatrix, Array"]=e.referToSelf(r=>(e,n)=>c(...u(t(n),e),r,!0))));var f=r.scalar||"any";(r.Ds||r.Ss)&&(s?(n["DenseMatrix,"+f]=(r,e)=>o(r,e,s,!1),n[f+", DenseMatrix"]=(r,e)=>o(e,r,s,!0),n["Array,"+f]=(r,e)=>o(t(r),e,s,!1).valueOf(),n[f+", Array"]=(r,e)=>o(t(e),r,s,!0).valueOf()):(n["DenseMatrix,"+f]=e.referToSelf(r=>(e,t)=>o(e,t,r,!1)),n[f+", DenseMatrix"]=e.referToSelf(r=>(e,t)=>o(t,e,r,!0)),n["Array,"+f]=e.referToSelf(r=>(e,n)=>o(t(e),n,r,!1).valueOf()),n[f+", Array"]=e.referToSelf(r=>(e,n)=>o(t(n),e,r,!0).valueOf())));var l=void 0!==r.sS?r.sS:r.Ss;return s?(r.Ss&&(n["SparseMatrix,"+f]=(e,t)=>r.Ss(e,t,s,!1)),l&&(n[f+", SparseMatrix"]=(r,e)=>l(e,r,s,!0))):(r.Ss&&(n["SparseMatrix,"+f]=e.referToSelf(e=>(t,n)=>r.Ss(t,n,e,!1))),l&&(n[f+", SparseMatrix"]=e.referToSelf(r=>(e,t)=>l(t,e,r,!0)))),s&&s.signatures&&extend(n,s.signatures),n}}),e_="dotDivide",eE=(r=>{var{typed:e,matrix:t,equalScalar:n,divideScalar:a,DenseMatrix:o,concat:u}=r,s=em({typed:e,equalScalar:n}),c=eh({typed:e}),f=ed({typed:e,DenseMatrix:o}),l=eg({typed:e,equalScalar:n}),p=ev({typed:e,DenseMatrix:o}),m=eb({typed:e,matrix:t,concat:u});return e(e_,m({elop:a,SS:f,DS:c,SD:s,Ss:l,sS:p}))},"equal"),ew=factory_factory(eE,["typed","matrix","equalScalar","DenseMatrix","concat"],r=>{var{typed:e,matrix:t,equalScalar:n,DenseMatrix:a,concat:o}=r,u=eh({typed:e}),s=ed({typed:e,DenseMatrix:a}),c=ev({typed:e,DenseMatrix:a}),f=eb({typed:e,matrix:t,concat:o});return e(eE,eA({typed:e,equalScalar:n}),f({elop:n,SS:s,DS:u,Ss:c}))}),eA=factory_factory(eE,["typed","equalScalar"],r=>{var{typed:e,equalScalar:t}=r;return e(eE,{"any, any":function(r,e){return null===r?null===e:null===e?null===r:void 0===r?void 0===e:void 0===e?void 0===r:t(r,e)}})}),eF="flatten",eC=factory_factory(eF,["typed","matrix"],r=>{var{typed:e,matrix:t}=r;return e(eF,{Array:function(r){return flatten(r)},Matrix:function(r){return t(flatten(r.toArray()))}})}),eM="identity",eN=factory_factory(eM,["typed","config","matrix","BigNumber","DenseMatrix","SparseMatrix"],r=>{var{typed:e,config:t,matrix:n,BigNumber:a,DenseMatrix:o,SparseMatrix:u}=r;return e(eM,{"":function(){return"Matrix"===t.matrix?n([]):[]},string:function(r){return n(r)},"number | BigNumber":function(r){return _identity(r,r,"Matrix"===t.matrix?"dense":void 0)},"number | BigNumber, string":function(r,e){return _identity(r,r,e)},"number | BigNumber, number | BigNumber":function(r,e){return _identity(r,e,"Matrix"===t.matrix?"dense":void 0)},"number | BigNumber, number | BigNumber, string":function(r,e,t){return _identity(r,e,t)},Array:function(r){return _identityVector(r)},"Array, string":function(r,e){return _identityVector(r,e)},Matrix:function(r){return _identityVector(r.valueOf(),r.storage())},"Matrix, string":function(r,e){return _identityVector(r.valueOf(),e)}});function _identityVector(r,e){switch(r.length){case 0:return e?n(e):[];case 1:return _identity(r[0],r[0],e);case 2:return _identity(r[0],r[1],e);default:throw Error("Vector containing two values expected")}}function _identity(r,e,t){var n=isBigNumber(r)||isBigNumber(e)?a:null;if(isBigNumber(r)&&(r=r.toNumber()),isBigNumber(e)&&(e=e.toNumber()),!isInteger(r)||r<1||!isInteger(e)||e<1)throw Error("Parameters in function identity must be positive integers");var s=n?new a(1):1,c=n?new n(0):0,f=[r,e];if(t){if("sparse"===t)return u.diagonal(f,s,0,c);if("dense"===t)return o.diagonal(f,s,0,c);throw TypeError('Unknown matrix type "'.concat(t,'"'))}for(var l=array_resize([],f,c),p=r<e?r:e,m=0;m<p;m++)l[m][m]=s;return l}}),eS="largerEq",eB=factory_factory(eS,["typed","config","matrix","DenseMatrix","concat"],r=>{var{typed:e,config:t,matrix:n,DenseMatrix:a,concat:o}=r,u=eh({typed:e}),s=ed({typed:e,DenseMatrix:a}),c=ev({typed:e,DenseMatrix:a}),f=eb({typed:e,matrix:n,concat:o}),l=rm({typed:e});return e(eS,ez({typed:e,config:t}),{"boolean, boolean":(r,e)=>r>=e,"BigNumber, BigNumber":function(r,e){return r.gte(e)||nearlyEqual_nearlyEqual(r,e,t.epsilon)},"Fraction, Fraction":(r,e)=>-1!==r.compare(e),"Complex, Complex":function(){throw TypeError("No ordering relation is defined for complex numbers")}},l,f({SS:s,DS:u,Ss:c}))}),ez=factory_factory(eS,["typed","config"],r=>{var{typed:e,config:t}=r;return e(eS,{"number, number":function(r,e){return r>=e||nearlyEqual(r,e,t.epsilon)}})}),eT=factory_factory("matAlgo01xDSid",["typed"],r=>{var{typed:e}=r;return function(r,t,n,a){var o,u,s=r._data,c=r._size,f=r._datatype,l=t._values,p=t._index,m=t._ptr,h=t._size,d=t._datatype;if(c.length!==h.length)throw new DimensionError(c.length,h.length);if(c[0]!==h[0]||c[1]!==h[1])throw RangeError("Dimension mismatch. Matrix A ("+c+") must match Matrix B ("+h+")");if(!l)throw Error("Cannot perform operation on Dense Matrix and Pattern Sparse Matrix");var g=c[0],v=c[1],D="string"==typeof f&&f===d?f:void 0,y=D?e.find(n,[D,D]):n,x=[];for(o=0;o<g;o++)x[o]=[];var b=[],_=[];for(u=0;u<v;u++){for(var E=u+1,w=m[u],A=m[u+1],F=w;F<A;F++)b[o=p[F]]=a?y(l[F],s[o][u]):y(s[o][u],l[F]),_[o]=E;for(o=0;o<g;o++)_[o]===E?x[o][u]=b[o]:x[o][u]=s[o][u]}return r.createDenseMatrix({data:x,size:[g,v],datatype:D})}}),eI=factory_factory("matAlgo10xSids",["typed","DenseMatrix"],r=>{var{typed:e,DenseMatrix:t}=r;return function(r,n,a,o){var u,s=r._values,c=r._index,f=r._ptr,l=r._size,p=r._datatype;if(!s)throw Error("Cannot perform operation on Pattern Sparse Matrix and Scalar value");var m=l[0],h=l[1],d=a;"string"==typeof p&&(u=p,n=e.convert(n,u),d=e.find(a,[u,u]));for(var g=[],v=[],D=[],y=0;y<h;y++){for(var x=y+1,b=f[y],_=f[y+1],E=b;E<_;E++){var w=c[E];v[w]=s[E],D[w]=x}for(var A=0;A<m;A++)0===y&&(g[A]=[]),D[A]===x?g[A][y]=o?d(n,v[A]):d(v[A],n):g[A][y]=n}return new t({data:g,size:[m,h],datatype:u})}});function createSolveValidation(r){var{DenseMatrix:e}=r;return function(r,t,n){var a=r.size();if(2!==a.length)throw RangeError("Matrix must be two dimensional (size: "+string_format(a)+")");var o=a[0];if(o!==a[1])throw RangeError("Matrix must be square (size: "+string_format(a)+")");var u=[];if(isMatrix(t)){var s=t.size(),c=t._data;if(1===s.length){if(s[0]!==o)throw RangeError("Dimension mismatch. Matrix columns must match vector length.");for(var f=0;f<o;f++)u[f]=[c[f]];return new e({data:u,size:[o,1],datatype:t._datatype})}if(2===s.length){if(s[0]!==o||1!==s[1])throw RangeError("Dimension mismatch. Matrix columns must match vector length.");if(isDenseMatrix(t)){if(n){u=[];for(var l=0;l<o;l++)u[l]=[c[l][0]];return new e({data:u,size:[o,1],datatype:t._datatype})}return t}if(isSparseMatrix(t)){for(var p=0;p<o;p++)u[p]=[0];for(var m=t._values,h=t._index,d=t._ptr,g=d[1],v=d[0];v<g;v++)u[h[v]][0]=m[v];return new e({data:u,size:[o,1],datatype:t._datatype})}}throw RangeError("Dimension mismatch. The right side has to be either 1- or 2-dimensional vector.")}if(M(t)){var D=arraySize(t);if(1===D.length){if(D[0]!==o)throw RangeError("Dimension mismatch. Matrix columns must match vector length.");for(var y=0;y<o;y++)u[y]=[t[y]];return new e({data:u,size:[o,1]})}if(2===D.length){if(D[0]!==o||1!==D[1])throw RangeError("Dimension mismatch. Matrix columns must match vector length.");for(var x=0;x<o;x++)u[x]=[t[x][0]];return new e({data:u,size:[o,1]})}throw RangeError("Dimension mismatch. The right side has to be either 1- or 2-dimensional vector.")}}}r=>{var{typed:e,equalScalar:t}=r;return function(r,n,a){var o,u,s,c,f,l=r._values,p=r._index,m=r._ptr,h=r._size,d=r._datatype,g=n._values,v=n._index,D=n._ptr,y=n._size,x=n._datatype;if(h.length!==y.length)throw new DimensionError(h.length,y.length);if(h[0]!==y[0]||h[1]!==y[1])throw RangeError("Dimension mismatch. Matrix A ("+h+") must match Matrix B ("+y+")");if(!l||!g)throw Error("Cannot perform operation on Pattern Sparse Matrices");var b=h[0],_=h[1],E=t,w=0,A=a;"string"==typeof d&&d===x&&(o=d,E=e.find(t,[o,o]),w=e.convert(0,o),A=e.find(a,[o,o]));for(var F=[],C=[],M=[],N=[],S=[],B=0;B<_;B++){M[B]=C.length;var z=B+1;for(s=m[B],c=m[B+1],u=s;u<c;u++)S[f=p[u]]=z,N[f]=l[u],C.push(f);for(s=D[B],c=D[B+1],u=s;u<c;u++)S[f=v[u]]===z&&(N[f]=A(N[f],g[u]));for(u=M[B];u<C.length;){var T=N[f=C[u]];E(T,w)?C.splice(u,1):(F.push(T),u++)}}return M[_]=C.length,r.createSparseMatrix({values:F,index:C,ptr:M,size:[b,_],datatype:o})}},r=>{var{typed:e,matrix:t}=r;return{"Array, number":e.referTo("DenseMatrix, number",r=>(e,n)=>r(t(e),n).valueOf()),"Array, BigNumber":e.referTo("DenseMatrix, BigNumber",r=>(e,n)=>r(t(e),n).valueOf()),"number, Array":e.referTo("number, DenseMatrix",r=>(e,n)=>r(e,t(n)).valueOf()),"BigNumber, Array":e.referTo("BigNumber, DenseMatrix",r=>(e,n)=>r(e,t(n)).valueOf())}};var eO="lsolve",eP=factory_factory(eO,["typed","matrix","divideScalar","multiplyScalar","subtractScalar","equalScalar","DenseMatrix"],r=>{var{typed:e,matrix:t,divideScalar:n,multiplyScalar:a,subtractScalar:o,equalScalar:u,DenseMatrix:s}=r,c=createSolveValidation({DenseMatrix:s});return e(eO,{"SparseMatrix, Array | Matrix":function(r,e){return function(r,e){for(var t=(e=c(r,e,!0))._data,f=r._size[0],l=r._size[1],p=r._values,m=r._index,h=r._ptr,d=[],g=0;g<l;g++){var v=t[g][0]||0;if(u(v,0))d[g]=[0];else{for(var D=0,y=[],x=[],b=h[g],_=h[g+1],E=b;E<_;E++){var w=m[E];w===g?D=p[E]:w>g&&(y.push(p[E]),x.push(w))}if(u(D,0))throw Error("Linear system cannot be solved since matrix is singular");for(var A=n(v,D),F=0,C=x.length;F<C;F++){var M=x[F];t[M]=[o(t[M][0]||0,a(A,y[F]))]}d[g]=[A]}}return new s({data:d,size:[f,1]})}(r,e)},"DenseMatrix, Array | Matrix":function(r,e){return _denseForwardSubstitution(r,e)},"Array, Array | Matrix":function(r,e){return _denseForwardSubstitution(t(r),e).valueOf()}});function _denseForwardSubstitution(r,e){for(var t=(e=c(r,e,!0))._data,f=r._size[0],l=r._size[1],p=[],m=r._data,h=0;h<l;h++){var d=t[h][0]||0,g=void 0;if(u(d,0))g=0;else{var v=m[h][h];if(u(v,0))throw Error("Linear system cannot be solved since matrix is singular");g=n(d,v);for(var D=h+1;D<f;D++)t[D]=[o(t[D][0]||0,a(g,m[D][h]))]}p[h]=[g]}return new s({data:p,size:[f,1]})}}),ej="matrixFromColumns",ek=factory_factory(ej,["typed","matrix","flatten","size"],r=>{var{typed:e,matrix:t,flatten:n,size:a}=r;return e(ej,{"...Array":function(r){return _createArray(r)},"...Matrix":function(r){return t(_createArray(r.map(r=>r.toArray())))}});function _createArray(r){if(0===r.length)throw TypeError("At least one column is needed to construct a matrix.");for(var e=checkVectorTypeAndReturnLength(r[0]),t=[],a=0;a<e;a++)t[a]=[];for(var o of r){var u=checkVectorTypeAndReturnLength(o);if(u!==e)throw TypeError("The vectors had different length: "+(0|e)+"  "+(0|u));for(var s=n(o),c=0;c<e;c++)t[c].push(s[c])}return t}function checkVectorTypeAndReturnLength(r){var e=a(r);if(1===e.length)return e[0];if(2===e.length){if(1===e[0])return e[1];if(1===e[1])return e[0];throw TypeError("At least one of the arguments is not a vector.")}throw TypeError("Only one- or two-dimensional vectors are supported.")}}),eq=(r=>{var{typed:e,equalScalar:t}=r;return function(r,n,a){var o,u=r._values,s=r._size,c=r._datatype,f=n._values,l=n._size,p=n._datatype;if(s.length!==l.length)throw new DimensionError(s.length,l.length);if(s[0]!==l[0]||s[1]!==l[1])throw RangeError("Dimension mismatch. Matrix A ("+s+") must match Matrix B ("+l+")");var m=s[0],h=s[1],d=t,g=0,v=a;"string"==typeof c&&c===p&&(o=c,d=e.find(t,[o,o]),g=e.convert(0,o),v=e.find(a,[o,o]));for(var D=u&&f?[]:void 0,y=[],x=[],b=D?[]:void 0,_=[],E=[],w=0;w<h;w++){x[w]=y.length;var A=w+1;if(scatter(r,w,_,b,E,A,y,v),scatter(n,w,_,b,E,A,y,v),b)for(var F=x[w];F<y.length;){var C=y[F];if(E[C]===A){var M=b[C];d(M,g)?y.splice(F,1):(D.push(M),F++)}else y.splice(F,1)}else for(var N=x[w];N<y.length;)E[y[N]]!==A?y.splice(N,1):N++}return x[h]=y.length,r.createSparseMatrix({values:D,index:y,ptr:x,size:[m,h],datatype:o})}},factory_factory("qr",["typed","matrix","zeros","identity","isZero","equal","sign","sqrt","conj","unaryMinus","addScalar","divideScalar","multiplyScalar","subtractScalar","complex"],r=>{var{typed:e,matrix:t,zeros:n,identity:a,isZero:o,equal:u,sign:s,sqrt:c,conj:f,unaryMinus:l,addScalar:p,divideScalar:m,multiplyScalar:h,subtractScalar:d,complex:g}=r;return _extends(e("qr",{DenseMatrix:function(r){return _denseQR(r)},SparseMatrix:function(r){return function(r){throw Error("qr not implemented for sparse matrices yet")}(0)},Array:function(r){var e=_denseQR(t(r));return{Q:e.Q.valueOf(),R:e.R.valueOf()}}}),{_denseQRimpl});function _denseQRimpl(r){var e,t,g,v=r._size[0],D=r._size[1],y=a([v],"dense"),x=y._data,b=r.clone(),_=b._data,E=n([v],"");for(g=0;g<Math.min(D,v);++g){var w=_[g][g],A=l(u(w,0)?1:s(w)),F=f(A),C=0;for(e=g;e<v;e++)C=p(C,h(_[e][g],f(_[e][g])));var M=h(A,c(C));if(!o(M)){var N=d(w,M);for(E[g]=1,e=g+1;e<v;e++)E[e]=m(_[e][g],N);var S=l(f(m(N,M))),B=void 0;for(t=g;t<D;t++){for(B=0,e=g;e<v;e++)B=p(B,h(f(E[e]),_[e][t]));for(B=h(B,S),e=g;e<v;e++)_[e][t]=h(d(_[e][t],h(E[e],B)),F)}for(e=0;e<v;e++){for(B=0,t=g;t<v;t++)B=p(B,h(x[e][t],E[t]));for(B=h(B,S),t=g;t<v;++t)x[e][t]=m(d(x[e][t],h(B,f(E[t]))),F)}}}return{Q:y,R:b,toString:function(){return"Q: "+this.Q.toString()+"\nR: "+this.R.toString()}}}function _denseQR(r){var e=_denseQRimpl(r),t=e.R._data;if(r._data.length>0)for(var n="Complex"===t[0][0].type?g(0):0,a=0;a<t.length;++a)for(var o=0;o<a&&o<(t[0]||[]).length;++o)t[a][o]=n;return e}}));function ArgumentsError(r,e,t,n){if(!(this instanceof ArgumentsError))throw SyntaxError("Constructor must be called with the new operator");this.fn=r,this.count=e,this.min=t,this.max=n,this.message="Wrong number of arguments in function "+r+" ("+e+" provided, "+t+(null!=n?"-"+n:"")+" expected)",this.stack=Error().stack}ArgumentsError.prototype=Error(),ArgumentsError.prototype.constructor=Error,ArgumentsError.prototype.name="ArgumentsError",ArgumentsError.prototype.isArgumentsError=!0;var eR="Number of decimals in function round must be an integer",eU="round",eL=factory_factory(eU,["typed","matrix","equalScalar","zeros","BigNumber","DenseMatrix"],r=>{var{typed:e,matrix:t,equalScalar:n,zeros:a,BigNumber:o,DenseMatrix:u}=r,s=eg({typed:e,equalScalar:n}),c=ev({typed:e,DenseMatrix:u}),f=ey({typed:e});return e(eU,{number:roundNumber,"number, number":roundNumber,"number, BigNumber":function(r,e){if(!e.isInteger())throw TypeError(eR);return new o(r).toDecimalPlaces(e.toNumber())},Complex:function(r){return r.round()},"Complex, number":function(r,e){if(e%1)throw TypeError(eR);return r.round(e)},"Complex, BigNumber":function(r,e){if(!e.isInteger())throw TypeError(eR);var t=e.toNumber();return r.round(t)},BigNumber:function(r){return r.toDecimalPlaces(0)},"BigNumber, BigNumber":function(r,e){if(!e.isInteger())throw TypeError(eR);return r.toDecimalPlaces(e.toNumber())},Fraction:function(r){return r.round()},"Fraction, number":function(r,e){if(e%1)throw TypeError(eR);return r.round(e)},"Fraction, BigNumber":function(r,e){if(!e.isInteger())throw TypeError(eR);return r.round(e.toNumber())},"Unit, number, Unit":e.referToSelf(r=>function(e,t,n){var a=e.toNumeric(n);return n.multiply(r(a,t))}),"Unit, BigNumber, Unit":e.referToSelf(r=>(e,t,n)=>r(e,t.toNumber(),n)),"Unit, Unit":e.referToSelf(r=>(e,t)=>r(e,0,t)),"Array | Matrix, number, Unit":e.referToSelf(r=>(e,t,n)=>deepMap(e,e=>r(e,t,n),!0)),"Array | Matrix, BigNumber, Unit":e.referToSelf(r=>(e,t,n)=>r(e,t.toNumber(),n)),"Array | Matrix, Unit":e.referToSelf(r=>(e,t)=>r(e,0,t)),"Array | Matrix":e.referToSelf(r=>e=>deepMap(e,r,!0)),"SparseMatrix, number | BigNumber":e.referToSelf(r=>(e,t)=>s(e,t,r,!1)),"DenseMatrix, number | BigNumber":e.referToSelf(r=>(e,t)=>f(e,t,r,!1)),"Array, number | BigNumber":e.referToSelf(r=>(e,n)=>f(t(e),n,r,!1).valueOf()),"number | Complex | BigNumber | Fraction, SparseMatrix":e.referToSelf(r=>(e,t)=>n(e,0)?a(t.size(),t.storage()):c(t,e,r,!0)),"number | Complex | BigNumber | Fraction, DenseMatrix":e.referToSelf(r=>(e,t)=>n(e,0)?a(t.size(),t.storage()):f(t,e,r,!0)),"number | Complex | BigNumber | Fraction, Array":e.referToSelf(r=>(e,n)=>f(t(n),e,r,!0).valueOf())})}),eZ="smaller",eV=factory_factory(eZ,["typed","config","matrix","DenseMatrix","concat"],r=>{var{typed:e,config:t,matrix:n,DenseMatrix:a,concat:o}=r,u=eh({typed:e}),s=ed({typed:e,DenseMatrix:a}),c=ev({typed:e,DenseMatrix:a}),f=eb({typed:e,matrix:n,concat:o}),l=rm({typed:e});return e(eZ,eH({typed:e,config:t}),{"boolean, boolean":(r,e)=>r<e,"BigNumber, BigNumber":function(r,e){return r.lt(e)&&!nearlyEqual_nearlyEqual(r,e,t.epsilon)},"Fraction, Fraction":(r,e)=>-1===r.compare(e),"Complex, Complex":function(r,e){throw TypeError("No ordering relation is defined for complex numbers")}},l,f({SS:s,DS:u,Ss:c}))}),eH=factory_factory(eZ,["typed","config"],r=>{var{typed:e,config:t}=r;return e(eZ,{"number, number":function(r,e){return r<e&&!nearlyEqual(r,e,t.epsilon)}})}),eJ=factory_factory("matAlgo05xSfSf",["typed","equalScalar"],r=>{var{typed:e,equalScalar:t}=r;return function(r,n,a){var o,u,s,c,f,l=r._values,p=r._index,m=r._ptr,h=r._size,d=r._datatype,g=n._values,v=n._index,D=n._ptr,y=n._size,x=n._datatype;if(h.length!==y.length)throw new DimensionError(h.length,y.length);if(h[0]!==y[0]||h[1]!==y[1])throw RangeError("Dimension mismatch. Matrix A ("+h+") must match Matrix B ("+y+")");var b=h[0],_=h[1],E=t,w=0,A=a;"string"==typeof d&&d===x&&(o=d,E=e.find(t,[o,o]),w=e.convert(0,o),A=e.find(a,[o,o]));var F=l&&g?[]:void 0,C=[],M=[],N=F?[]:void 0,S=F?[]:void 0,B=[],z=[];for(s=0;s<_;s++){M[s]=C.length;var T=s+1;for(c=m[s],f=m[s+1];c<f;c++)u=p[c],C.push(u),B[u]=T,N&&(N[u]=l[c]);for(c=D[s],f=D[s+1];c<f;c++)B[u=v[c]]!==T&&C.push(u),z[u]=T,S&&(S[u]=g[c]);if(F)for(c=M[s];c<C.length;){var I=B[u=C[c]],O=z[u];if(I===T||O===T){var P=A(I===T?N[u]:w,O===T?S[u]:w);E(P,w)?C.splice(c,1):(F.push(P),c++)}}}return M[_]=C.length,r.createSparseMatrix({values:F,index:C,ptr:M,size:[b,_],datatype:o})}}),e$="subtract",eW=factory_factory(e$,["typed","matrix","equalScalar","subtractScalar","unaryMinus","DenseMatrix","concat"],r=>{var{typed:e,matrix:t,equalScalar:n,subtractScalar:a,unaryMinus:o,DenseMatrix:u,concat:s}=r,c=eT({typed:e}),f=eh({typed:e}),l=eJ({typed:e,equalScalar:n}),p=eI({typed:e,DenseMatrix:u}),m=ev({typed:e,DenseMatrix:u}),h=eb({typed:e,matrix:t,concat:s});return e(e$,{"any, any":a},h({elop:a,SS:l,DS:c,SD:f,Ss:m,sS:p}))}),eX="unequal",eY=(factory_factory(eX,["typed","equalScalar"],r=>{var{typed:e,equalScalar:t}=r;return e(eX,{"any, any":function(r,e){return null===r?null!==e:null===e?null!==r:void 0===r?void 0!==e:void 0===e?void 0!==r:!t(r,e)}})}),"usolve"),eG=factory_factory(eY,["typed","matrix","divideScalar","multiplyScalar","subtractScalar","equalScalar","DenseMatrix"],r=>{var{typed:e,matrix:t,divideScalar:n,multiplyScalar:a,subtractScalar:o,equalScalar:u,DenseMatrix:s}=r,c=createSolveValidation({DenseMatrix:s});return e(eY,{"SparseMatrix, Array | Matrix":function(r,e){return function(r,e){for(var t=(e=c(r,e,!0))._data,f=r._size[0],l=r._size[1],p=r._values,m=r._index,h=r._ptr,d=[],g=l-1;g>=0;g--){var v=t[g][0]||0;if(u(v,0))d[g]=[0];else{for(var D=0,y=[],x=[],b=h[g],_=h[g+1],E=_-1;E>=b;E--){var w=m[E];w===g?D=p[E]:w<g&&(y.push(p[E]),x.push(w))}if(u(D,0))throw Error("Linear system cannot be solved since matrix is singular");for(var A=n(v,D),F=0,C=x.length;F<C;F++){var M=x[F];t[M]=[o(t[M][0],a(A,y[F]))]}d[g]=[A]}}return new s({data:d,size:[f,1]})}(r,e)},"DenseMatrix, Array | Matrix":function(r,e){return _denseBackwardSubstitution(r,e)},"Array, Array | Matrix":function(r,e){return _denseBackwardSubstitution(t(r),e).valueOf()}});function _denseBackwardSubstitution(r,e){for(var t=(e=c(r,e,!0))._data,f=r._size[0],l=r._size[1],p=[],m=r._data,h=l-1;h>=0;h--){var d=t[h][0]||0,g=void 0;if(u(d,0))g=0;else{var v=m[h][h];if(u(v,0))throw Error("Linear system cannot be solved since matrix is singular");g=n(d,v);for(var D=h-1;D>=0;D--)t[D]=[o(t[D][0]||0,a(g,m[D][h]))]}p[h]=[g]}return new s({data:p,size:[f,1]})}}),eQ=factory_factory("matAlgo04xSidSid",["typed","equalScalar"],r=>{var{typed:e,equalScalar:t}=r;return function(r,n,a){var o,u,s,c,f,l,p=r._values,m=r._index,h=r._ptr,d=r._size,g=r._datatype,v=n._values,D=n._index,y=n._ptr,x=n._size,b=n._datatype;if(d.length!==x.length)throw new DimensionError(d.length,x.length);if(d[0]!==x[0]||d[1]!==x[1])throw RangeError("Dimension mismatch. Matrix A ("+d+") must match Matrix B ("+x+")");var _=d[0],E=d[1],w=t,A=0,F=a;"string"==typeof g&&g===b&&(o=g,w=e.find(t,[o,o]),A=e.convert(0,o),F=e.find(a,[o,o]));var C=p&&v?[]:void 0,M=[],N=[],S=p&&v?[]:void 0,B=p&&v?[]:void 0,z=[],T=[];for(s=0;s<E;s++){N[s]=M.length;var I=s+1;for(f=h[s],l=h[s+1],c=f;c<l;c++)u=m[c],M.push(u),z[u]=I,S&&(S[u]=p[c]);for(f=y[s],l=y[s+1],c=f;c<l;c++)if(z[u=D[c]]===I){if(S){var O=F(S[u],v[c]);w(O,A)?z[u]=null:S[u]=O}}else M.push(u),T[u]=I,B&&(B[u]=v[c]);if(S&&B)for(c=N[s];c<M.length;)z[u=M[c]]===I?(C[c]=S[u],c++):T[u]===I?(C[c]=B[u],c++):M.splice(c,1)}return N[E]=M.length,r.createSparseMatrix({values:C,index:M,ptr:N,size:[_,E],datatype:o})}}),eK=factory_factory("add",["typed","matrix","addScalar","equalScalar","DenseMatrix","SparseMatrix","concat"],r=>{var{typed:e,matrix:t,addScalar:n,equalScalar:a,DenseMatrix:o,SparseMatrix:u,concat:s}=r,c=eT({typed:e}),f=eQ({typed:e,equalScalar:a}),l=eI({typed:e,DenseMatrix:o}),p=eb({typed:e,matrix:t,concat:s});return e("add",{"any, any":n,"any, any, ...any":e.referToSelf(r=>(e,t,n)=>{for(var a=r(e,t),o=0;o<n.length;o++)a=r(a,n[o]);return a})},p({elop:n,DS:c,SS:f,Ss:l}))}),e0=(r=>{var{typed:e,equalScalar:t}=r;return function(r,n,a){var o,u,s,c,f,l,p=r._values,m=r._index,h=r._ptr,d=r._size,g=r._datatype,v=n._values,D=n._index,y=n._ptr,x=n._size,b=n._datatype;if(d.length!==x.length)throw new DimensionError(d.length,x.length);if(d[0]!==x[0]||d[1]!==x[1])throw RangeError("Dimension mismatch. Matrix A ("+d+") must match Matrix B ("+x+")");var _=d[0],E=d[1],w=t,A=0,F=a;"string"==typeof g&&g===b&&(o=g,w=e.find(t,[o,o]),A=e.convert(0,o),F=e.find(a,[o,o]));var C=p&&v?[]:void 0,M=[],N=[],S=C?[]:void 0,B=[];for(s=0;s<E;s++){N[s]=M.length;var z=s+1;if(S)for(f=y[s],l=y[s+1],c=f;c<l;c++)B[u=D[c]]=z,S[u]=v[c];for(f=h[s],l=h[s+1],c=f;c<l;c++)if(u=m[c],S){var T=B[u]===z?S[u]:A,I=F(p[c],T);w(I,A)||(M.push(u),C.push(I))}else M.push(u)}return N[E]=M.length,r.createSparseMatrix({values:C,index:M,ptr:N,size:[_,E],datatype:o})}},"compare"),e1=factory_factory(e0,["typed","config","matrix","equalScalar","BigNumber","Fraction","DenseMatrix","concat"],r=>{var{typed:e,config:t,equalScalar:n,matrix:a,BigNumber:o,Fraction:u,DenseMatrix:s,concat:c}=r,f=eh({typed:e}),l=eJ({typed:e,equalScalar:n}),p=ev({typed:e,DenseMatrix:s}),m=eb({typed:e,matrix:a,concat:c}),h=rm({typed:e});return e(e0,e2({typed:e,config:t}),{"boolean, boolean":function(r,e){return r===e?0:r>e?1:-1},"BigNumber, BigNumber":function(r,e){return new o(nearlyEqual_nearlyEqual(r,e,t.epsilon)?0:r.cmp(e))},"Fraction, Fraction":function(r,e){return new u(r.compare(e))},"Complex, Complex":function(){throw TypeError("No ordering relation is defined for complex numbers")}},h,m({SS:l,DS:f,Ss:p}))}),e2=factory_factory(e0,["typed","config"],r=>{var{typed:e,config:t}=r;return e(e0,{"number, number":function(r,e){return nearlyEqual(r,e,t.epsilon)?0:r>e?1:-1}})});compareText.signature="any, any",r=>{var{typed:e,matrix:t,concat:n}=r,a=eb({typed:e,matrix:t,concat:n});return e("compareText",compareText,a({elop:compareText,Ds:!0}))};var e8=factory_factory("dot",["typed","addScalar","multiplyScalar","conj","size"],r=>{var{typed:e,addScalar:t,multiplyScalar:n,conj:a,size:o}=r;return e("dot",{"Array | DenseMatrix, Array | DenseMatrix":function(r,o){var u=_validateDim(r,o),s=isMatrix(r)?r._data:r,c=isMatrix(r)?r._datatype:void 0,f=isMatrix(o)?o._data:o,l=isMatrix(o)?o._datatype:void 0,p=2===_size(r).length,m=2===_size(o).length,h=t,d=n;if(c&&l&&c===l&&"string"==typeof c&&(h=e.find(t,[c,c]),d=e.find(n,[c,c])),!p&&!m){for(var g=d(a(s[0]),f[0]),v=1;v<u;v++)g=h(g,d(a(s[v]),f[v]));return g}if(!p&&m){for(var D=d(a(s[0]),f[0][0]),y=1;y<u;y++)D=h(D,d(a(s[y]),f[y][0]));return D}if(p&&!m){for(var x=d(a(s[0][0]),f[0]),b=1;b<u;b++)x=h(x,d(a(s[b][0]),f[b]));return x}if(p&&m){for(var _=d(a(s[0][0]),f[0][0]),E=1;E<u;E++)_=h(_,d(a(s[E][0]),f[E][0]));return _}},"SparseMatrix, SparseMatrix":function(r,e){_validateDim(r,e);for(var a=r._index,o=r._values,u=e._index,s=e._values,c=0,f=0,l=0;f<a.length&&l<u.length;){var p=a[f],m=u[l];if(p<m){f++;continue}if(p>m){l++;continue}p===m&&(c=t(c,n(o[f],s[l])),f++,l++)}return c}});function _validateDim(r,e){var t,n,a=_size(r),o=_size(e);if(1===a.length)t=a[0];else if(2===a.length&&1===a[1])t=a[0];else throw RangeError("Expected a column vector, instead got a matrix of size ("+a.join(", ")+")");if(1===o.length)n=o[0];else if(2===o.length&&1===o[1])n=o[0];else throw RangeError("Expected a column vector, instead got a matrix of size ("+o.join(", ")+")");if(t!==n)throw RangeError("Vectors must have equal length ("+t+" != "+n+")");if(0===t)throw RangeError("Cannot calculate the dot product of empty vectors");return t}function _size(r){return isMatrix(r)?r.size():o(r)}}),e3="floor",e5=factory_factory(e3,["typed","config","round"],r=>{var{typed:e,config:t,round:n}=r;return e(e3,{number:function(r){return nearlyEqual(r,n(r),t.epsilon)?n(r):Math.floor(r)},"number, number":function(r,e){if(nearlyEqual(r,n(r,e),t.epsilon))return n(r,e);var[a,o]="".concat(r,"e").split("e"),u=Math.floor(Number("".concat(a,"e").concat(Number(o)+e)));return[a,o]="".concat(u,"e").split("e"),Number("".concat(a,"e").concat(Number(o)-e))}})}),e7=factory_factory(e3,["typed","config","round","matrix","equalScalar","zeros","DenseMatrix"],r=>{var{typed:e,config:t,round:n,matrix:a,equalScalar:o,zeros:u,DenseMatrix:s}=r,c=eg({typed:e,equalScalar:o}),f=ev({typed:e,DenseMatrix:s}),l=ey({typed:e}),p=e5({typed:e,config:t,round:n});return e("floor",{number:p.signatures.number,"number,number":p.signatures["number,number"],Complex:function(r){return r.floor()},"Complex, number":function(r,e){return r.floor(e)},"Complex, BigNumber":function(r,e){return r.floor(e.toNumber())},BigNumber:function(r){return nearlyEqual_nearlyEqual(r,n(r),t.epsilon)?n(r):r.floor()},"BigNumber, BigNumber":function(r,e){return nearlyEqual_nearlyEqual(r,n(r,e),t.epsilon)?n(r,e):r.toDecimalPlaces(e.toNumber(),C.ROUND_FLOOR)},Fraction:function(r){return r.floor()},"Fraction, number":function(r,e){return r.floor(e)},"Fraction, BigNumber":function(r,e){return r.floor(e.toNumber())},"Array | Matrix":e.referToSelf(r=>e=>deepMap(e,r,!0)),"Array, number | BigNumber":e.referToSelf(r=>(e,t)=>deepMap(e,e=>r(e,t),!0)),"SparseMatrix, number | BigNumber":e.referToSelf(r=>(e,t)=>c(e,t,r,!1)),"DenseMatrix, number | BigNumber":e.referToSelf(r=>(e,t)=>l(e,t,r,!1)),"number | Complex | Fraction | BigNumber, Array":e.referToSelf(r=>(e,t)=>l(a(t),e,r,!0).valueOf()),"number | Complex | Fraction | BigNumber, Matrix":e.referToSelf(r=>(e,t)=>o(e,0)?u(t.size(),t.storage()):"dense"===t.storage()?l(t,e,r,!0):f(t,e,r,!0))})}),e9=(r=>{var{typed:e,config:t,round:n,matrix:a,equalScalar:o,zeros:u,DenseMatrix:s,concat:c}=r,f=e7({typed:e,config:t,round:n,matrix:a,equalScalar:o,zeros:u,DenseMatrix:s}),l=em({typed:e,equalScalar:o}),p=eh({typed:e}),m=eJ({typed:e,equalScalar:o}),h=eg({typed:e,equalScalar:o}),d=ev({typed:e,DenseMatrix:s}),g=eb({typed:e,matrix:a,concat:c});return e("mod",{"number, number":function(r,e){return 0===e?r:r-e*f(r/e)},"BigNumber, BigNumber":function(r,e){return e.isZero()?r:r.sub(e.mul(f(r.div(e))))},"Fraction, Fraction":function(r,e){return e.equals(0)?r:r.sub(e.mul(f(r.div(e))))}},g({SS:m,DS:p,SD:l,Ss:h,sS:d}))},"number | BigNumber | Fraction | Matrix | Array");"".concat(e9,", ").concat(e9,", ...").concat(e9);var e4=factory_factory("ImmutableDenseMatrix",["smaller","DenseMatrix"],r=>{var{smaller:e,DenseMatrix:t}=r;function ImmutableDenseMatrix(r,e){if(!(this instanceof ImmutableDenseMatrix))throw SyntaxError("Constructor must be called with the new operator");if(e&&!isString(e))throw Error("Invalid datatype: "+e);if(isMatrix(r)||M(r)){var n=new t(r,e);this._data=n._data,this._size=n._size,this._datatype=n._datatype,this._min=null,this._max=null}else if(r&&M(r.data)&&M(r.size))this._data=r.data,this._size=r.size,this._datatype=r.datatype,this._min=void 0!==r.min?r.min:null,this._max=void 0!==r.max?r.max:null;else if(r)throw TypeError("Unsupported type of data ("+typeOf(r)+")");else this._data=[],this._size=[0],this._datatype=e,this._min=null,this._max=null}return ImmutableDenseMatrix.prototype=new t,ImmutableDenseMatrix.prototype.type="ImmutableDenseMatrix",ImmutableDenseMatrix.prototype.isImmutableDenseMatrix=!0,ImmutableDenseMatrix.prototype.subset=function(r){switch(arguments.length){case 1:var e=t.prototype.subset.call(this,r);if(isMatrix(e))return new ImmutableDenseMatrix({data:e._data,size:e._size,datatype:e._datatype});return e;case 2:case 3:throw Error("Cannot invoke set subset on an Immutable Matrix instance");default:throw SyntaxError("Wrong number of arguments")}},ImmutableDenseMatrix.prototype.set=function(){throw Error("Cannot invoke set on an Immutable Matrix instance")},ImmutableDenseMatrix.prototype.resize=function(){throw Error("Cannot invoke resize on an Immutable Matrix instance")},ImmutableDenseMatrix.prototype.reshape=function(){throw Error("Cannot invoke reshape on an Immutable Matrix instance")},ImmutableDenseMatrix.prototype.clone=function(){return new ImmutableDenseMatrix({data:object_clone(this._data),size:object_clone(this._size),datatype:this._datatype})},ImmutableDenseMatrix.prototype.toJSON=function(){return{mathjs:"ImmutableDenseMatrix",data:this._data,size:this._size,datatype:this._datatype}},ImmutableDenseMatrix.fromJSON=function(r){return new ImmutableDenseMatrix(r)},ImmutableDenseMatrix.prototype.swapRows=function(){throw Error("Cannot invoke swapRows on an Immutable Matrix instance")},ImmutableDenseMatrix.prototype.min=function(){if(null===this._min){var r=null;this.forEach(function(t){(null===r||e(t,r))&&(r=t)}),this._min=null!==r?r:void 0}return this._min},ImmutableDenseMatrix.prototype.max=function(){if(null===this._max){var r=null;this.forEach(function(t){(null===r||e(r,t))&&(r=t)}),this._max=null!==r?r:void 0}return this._max},ImmutableDenseMatrix},{isClass:!0}),e6=factory_factory("Index",["ImmutableDenseMatrix","getMatrixDataType"],r=>{var{ImmutableDenseMatrix:e,getMatrixDataType:t}=r;function Index(r){if(!(this instanceof Index))throw SyntaxError("Constructor must be called with the new operator");this._dimensions=[],this._sourceSize=[],this._isScalar=!0;for(var e=0,n=arguments.length;e<n;e++){var a=arguments[e],o=M(a),u=isMatrix(a),s=null;if(isRange(a))this._dimensions.push(a),this._isScalar=!1;else if(o||u){var c=void 0;"boolean"===t(a)?(o&&(c=_createImmutableMatrix(_booleansArrayToNumbersForIndex(a).valueOf())),u&&(c=_createImmutableMatrix(_booleansArrayToNumbersForIndex(a._data).valueOf())),s=a.valueOf().length):c=_createImmutableMatrix(a.valueOf()),this._dimensions.push(c);var f=c.size();(1!==f.length||1!==f[0]||null!==s)&&(this._isScalar=!1)}else if("number"==typeof a)this._dimensions.push(_createImmutableMatrix([a]));else if("string"==typeof a)this._dimensions.push(a);else throw TypeError("Dimension must be an Array, Matrix, number, string, or Range");this._sourceSize.push(s)}}function _createImmutableMatrix(r){for(var t=0,n=r.length;t<n;t++)if("number"!=typeof r[t]||!isInteger(r[t]))throw TypeError("Index parameters must be positive integer numbers");return new e(r)}return Index.prototype.type="Index",Index.prototype.isIndex=!0,Index.prototype.clone=function(){var r=new Index;return r._dimensions=object_clone(this._dimensions),r._isScalar=this._isScalar,r._sourceSize=this._sourceSize,r},Index.create=function(r){var e=new Index;return Index.apply(e,r),e},Index.prototype.size=function(){for(var r=[],e=0,t=this._dimensions.length;e<t;e++){var n=this._dimensions[e];r[e]="string"==typeof n?1:n.size()[0]}return r},Index.prototype.max=function(){for(var r=[],e=0,t=this._dimensions.length;e<t;e++){var n=this._dimensions[e];r[e]="string"==typeof n?n:n.max()}return r},Index.prototype.min=function(){for(var r=[],e=0,t=this._dimensions.length;e<t;e++){var n=this._dimensions[e];r[e]="string"==typeof n?n:n.min()}return r},Index.prototype.forEach=function(r){for(var e=0,t=this._dimensions.length;e<t;e++)r(this._dimensions[e],e,this)},Index.prototype.dimension=function(r){return this._dimensions[r]||null},Index.prototype.isObjectProperty=function(){return 1===this._dimensions.length&&"string"==typeof this._dimensions[0]},Index.prototype.getObjectProperty=function(){return this.isObjectProperty()?this._dimensions[0]:null},Index.prototype.isScalar=function(){return this._isScalar},Index.prototype.toArray=function(){for(var r=[],e=0,t=this._dimensions.length;e<t;e++){var n=this._dimensions[e];r.push("string"==typeof n?n:n.toArray())}return r},Index.prototype.valueOf=Index.prototype.toArray,Index.prototype.toString=function(){for(var r=[],e=0,t=this._dimensions.length;e<t;e++){var n=this._dimensions[e];"string"==typeof n?r.push(JSON.stringify(n)):r.push(n.toString())}return"["+r.join(", ")+"]"},Index.prototype.toJSON=function(){return{mathjs:"Index",dimensions:this._dimensions}},Index.fromJSON=function(r){return Index.create(r.dimensions)},Index},{isClass:!0});function _booleansArrayToNumbersForIndex(r){var e=[];return r.forEach((r,t)=>{r&&e.push(t)}),e}var tr="larger",te=factory_factory(tr,["typed","config","matrix","DenseMatrix","concat"],r=>{var{typed:e,config:t,matrix:n,DenseMatrix:a,concat:o}=r,u=eh({typed:e}),s=ed({typed:e,DenseMatrix:a}),c=ev({typed:e,DenseMatrix:a}),f=eb({typed:e,matrix:n,concat:o}),l=rm({typed:e});return e(tr,tt({typed:e,config:t}),{"boolean, boolean":(r,e)=>r>e,"BigNumber, BigNumber":function(r,e){return r.gt(e)&&!nearlyEqual_nearlyEqual(r,e,t.epsilon)},"Fraction, Fraction":(r,e)=>1===r.compare(e),"Complex, Complex":function(){throw TypeError("No ordering relation is defined for complex numbers")}},l,f({SS:s,DS:u,Ss:c}))}),tt=factory_factory(tr,["typed","config"],r=>{var{typed:e,config:t}=r;return e(tr,{"number, number":function(r,e){return r>e&&!nearlyEqual(r,e,t.epsilon)}})}),tn="multiply",ti=factory_factory(tn,["typed","matrix","addScalar","multiplyScalar","equalScalar","dot"],r=>{var{typed:e,matrix:t,addScalar:n,multiplyScalar:a,equalScalar:o,dot:u}=r,s=eg({typed:e,equalScalar:o}),c=ey({typed:e});function _validateMatrixDimensions(r,e){switch(r.length){case 1:switch(e.length){case 1:if(r[0]!==e[0])throw RangeError("Dimension mismatch in multiplication. Vectors must have the same length");break;case 2:if(r[0]!==e[0])throw RangeError("Dimension mismatch in multiplication. Vector length ("+r[0]+") must match Matrix rows ("+e[0]+")");break;default:throw Error("Can only multiply a 1 or 2 dimensional matrix (Matrix B has "+e.length+" dimensions)")}break;case 2:switch(e.length){case 1:if(r[1]!==e[0])throw RangeError("Dimension mismatch in multiplication. Matrix columns ("+r[1]+") must match Vector length ("+e[0]+")");break;case 2:if(r[1]!==e[0])throw RangeError("Dimension mismatch in multiplication. Matrix A columns ("+r[1]+") must match Matrix B rows ("+e[0]+")");break;default:throw Error("Can only multiply a 1 or 2 dimensional matrix (Matrix B has "+e.length+" dimensions)")}break;default:throw Error("Can only multiply a 1 or 2 dimensional matrix (Matrix A has "+r.length+" dimensions)")}}var f=e("_multiplyMatrixVector",{"DenseMatrix, any":function(r,t){var o,u=r._data,s=r._size,c=r._datatype,f=t._data,l=t._datatype,p=s[0],m=s[1],h=n,d=a;c&&l&&c===l&&"string"==typeof c&&(o=c,h=e.find(n,[o,o]),d=e.find(a,[o,o]));for(var g=[],v=0;v<p;v++){for(var D=u[v],y=d(D[0],f[0]),x=1;x<m;x++)y=h(y,d(D[x],f[x]));g[v]=y}return r.createDenseMatrix({data:g,size:[p],datatype:o})},"SparseMatrix, any":function(r,t){var u,s=r._values,c=r._index,f=r._ptr,l=r._datatype;if(!s)throw Error("Cannot multiply Pattern only Matrix times Dense Matrix");var p=t._data,m=t._datatype,h=r._size[0],d=t._size[0],g=[],v=[],D=[],y=n,x=a,b=o,_=0;l&&m&&l===m&&"string"==typeof l&&(u=l,y=e.find(n,[u,u]),x=e.find(a,[u,u]),b=e.find(o,[u,u]),_=e.convert(0,u));var E=[],w=[];D[0]=0;for(var A=0;A<d;A++){var F=p[A];if(!b(F,_))for(var C=f[A],M=f[A+1],N=C;N<M;N++){var S=c[N];w[S]?E[S]=y(E[S],x(F,s[N])):(w[S]=!0,v.push(S),E[S]=x(F,s[N]))}}for(var B=v.length,z=0;z<B;z++){var T=v[z];g[z]=E[T]}return D[1]=v.length,r.createSparseMatrix({values:g,index:v,ptr:D,size:[h,1],datatype:u})}}),l=e("_multiplyMatrixMatrix",{"DenseMatrix, DenseMatrix":function(r,t){var o,u=r._data,s=r._size,c=r._datatype,f=t._data,l=t._size,p=t._datatype,m=s[0],h=s[1],d=l[1],g=n,v=a;c&&p&&c===p&&"string"==typeof c&&(o=c,g=e.find(n,[o,o]),v=e.find(a,[o,o]));for(var D=[],y=0;y<m;y++){var x=u[y];D[y]=[];for(var b=0;b<d;b++){for(var _=v(x[0],f[0][b]),E=1;E<h;E++)_=g(_,v(x[E],f[E][b]));D[y][b]=_}}return r.createDenseMatrix({data:D,size:[m,d],datatype:o})},"DenseMatrix, SparseMatrix":function(r,t){var u,s=r._data,c=r._size,f=r._datatype,l=t._values,p=t._index,m=t._ptr,h=t._size,d=t._datatype;if(!l)throw Error("Cannot multiply Dense Matrix times Pattern only Matrix");var g=c[0],v=h[1],D=n,y=a,x=o,b=0;f&&d&&f===d&&"string"==typeof f&&(u=f,D=e.find(n,[u,u]),y=e.find(a,[u,u]),x=e.find(o,[u,u]),b=e.convert(0,u));for(var _=[],E=[],w=[],A=t.createSparseMatrix({values:_,index:E,ptr:w,size:[g,v],datatype:u}),F=0;F<v;F++){w[F]=E.length;var C=m[F],M=m[F+1];if(M>C)for(var N=0,S=0;S<g;S++){for(var B=S+1,z=void 0,T=C;T<M;T++){var I=p[T];N!==B?(z=y(s[S][I],l[T]),N=B):z=D(z,y(s[S][I],l[T]))}N!==B||x(z,b)||(E.push(S),_.push(z))}}return w[v]=E.length,A},"SparseMatrix, DenseMatrix":function(r,t){var u,s=r._values,c=r._index,f=r._ptr,l=r._datatype;if(!s)throw Error("Cannot multiply Pattern only Matrix times Dense Matrix");var p=t._data,m=t._datatype,h=r._size[0],d=t._size[0],g=t._size[1],v=n,D=a,y=o,x=0;l&&m&&l===m&&"string"==typeof l&&(u=l,v=e.find(n,[u,u]),D=e.find(a,[u,u]),y=e.find(o,[u,u]),x=e.convert(0,u));for(var b=[],_=[],E=[],w=r.createSparseMatrix({values:b,index:_,ptr:E,size:[h,g],datatype:u}),A=[],F=[],C=0;C<g;C++){E[C]=_.length;for(var M=C+1,N=0;N<d;N++){var S=p[N][C];if(!y(S,x))for(var B=f[N],z=f[N+1],T=B;T<z;T++){var I=c[T];F[I]!==M?(F[I]=M,_.push(I),A[I]=D(S,s[T])):A[I]=v(A[I],D(S,s[T]))}}for(var O=E[C],P=_.length,j=O;j<P;j++){var k=_[j];b[j]=A[k]}}return E[g]=_.length,w},"SparseMatrix, SparseMatrix":function(r,t){var o,u,s,c,f,l,p,m,h,d=r._values,g=r._index,v=r._ptr,D=r._datatype,y=t._values,x=t._index,b=t._ptr,_=t._datatype,E=r._size[0],w=t._size[1],A=d&&y,F=n,C=a;D&&_&&D===_&&"string"==typeof D&&(o=D,F=e.find(n,[o,o]),C=e.find(a,[o,o]));for(var M=A?[]:void 0,N=[],S=[],B=r.createSparseMatrix({values:M,index:N,ptr:S,size:[E,w],datatype:o}),z=A?[]:void 0,T=[],I=0;I<w;I++){S[I]=N.length;var O=I+1;for(l=b[I],p=b[I+1],f=l;f<p;f++)if(h=x[f],A)for(s=v[h],c=v[h+1],u=s;u<c;u++)T[m=g[u]]!==O?(T[m]=O,N.push(m),z[m]=C(y[f],d[u])):z[m]=F(z[m],C(y[f],d[u]));else for(s=v[h],c=v[h+1],u=s;u<c;u++)T[m=g[u]]!==O&&(T[m]=O,N.push(m));if(A)for(var P=S[I],j=N.length,k=P;k<j;k++){var q=N[k];M[k]=z[q]}}return S[w]=N.length,B}});return e(tn,a,{"Array, Array":e.referTo("Matrix, Matrix",r=>(e,n)=>{_validateMatrixDimensions(arraySize(e),arraySize(n));var a=r(t(e),t(n));return isMatrix(a)?a.valueOf():a}),"Matrix, Matrix":function(r,t){var o=r.size(),s=t.size();return(_validateMatrixDimensions(o,s),1===o.length)?1===s.length?function(r,e,t){if(0===t)throw Error("Cannot multiply two empty vectors");return u(r,e)}(r,t,o[0]):function(r,t){if("dense"!==t.storage())throw Error("Support for SparseMatrix not implemented");return function(r,t){var o,u=r._data,s=r._size,c=r._datatype,f=t._data,l=t._size,p=t._datatype,m=s[0],h=l[1],d=n,g=a;c&&p&&c===p&&"string"==typeof c&&(o=c,d=e.find(n,[o,o]),g=e.find(a,[o,o]));for(var v=[],D=0;D<h;D++){for(var y=g(u[0],f[0][D]),x=1;x<m;x++)y=d(y,g(u[x],f[x][D]));v[D]=y}return r.createDenseMatrix({data:v,size:[h],datatype:o})}(r,t)}(r,t):1===s.length?f(r,t):l(r,t)},"Matrix, Array":e.referTo("Matrix,Matrix",r=>(e,n)=>r(e,t(n))),"Array, Matrix":e.referToSelf(r=>(e,n)=>r(t(e,n.storage()),n)),"SparseMatrix, any":function(r,e){return s(r,e,a,!1)},"DenseMatrix, any":function(r,e){return c(r,e,a,!1)},"any, SparseMatrix":function(r,e){return s(e,r,a,!0)},"any, DenseMatrix":function(r,e){return c(e,r,a,!0)},"Array, any":function(r,e){return c(t(r),e,a,!1).valueOf()},"any, Array":function(r,e){return c(t(e),r,a,!0).valueOf()},"any, any":a,"any, any, ...any":e.referToSelf(r=>(e,t,n)=>{for(var a=r(e,t),o=0;o<n.length;o++)a=r(a,n[o]);return a})})}),ta="partitionSelect",to=factory_factory(ta,["typed","isNumeric","isNaN","compare"],r=>{var{typed:e,isNumeric:t,isNaN:n,compare:a}=r,desc=(r,e)=>-a(r,e);return e(ta,{"Array | Matrix, number":function(r,e){return _partitionSelect(r,e,a)},"Array | Matrix, number, string":function(r,e,t){if("asc"===t)return _partitionSelect(r,e,a);if("desc"===t)return _partitionSelect(r,e,desc);throw Error('Compare string must be "asc" or "desc"')},"Array | Matrix, number, function":_partitionSelect});function _partitionSelect(r,e,t){if(!isInteger(e)||e<0)throw Error("k must be a non-negative integer");if(isMatrix(r)){if(r.size().length>1)throw Error("Only one dimensional matrices supported");return quickSelect(r.valueOf(),e,t)}if(Array.isArray(r))return quickSelect(r,e,t)}function quickSelect(r,e,a){if(e>=r.length)throw Error("k out of bounds");for(var o=0;o<r.length;o++)if(t(r[o])&&n(r[o]))return r[o];for(var u=0,s=r.length-1;u<s;){for(var c=u,f=s,l=r[Math.floor(Math.random()*(s-u+1))+u];c<f;)if(a(r[c],l)>=0){var p=r[f];r[f]=r[c],r[c]=p,--f}else++c;a(r[c],l)>0&&--c,e<=c?s=c:u=c+1}return r[e]}});function csTdfs(r,e,t,n,a,o,u){var s=0;for(t[u]=r;s>=0;){var c=t[u+s],f=t[n+c];-1===f?(s--,o[e++]=c):(t[n+c]=t[a+f],t[u+ ++s]=f)}return e}var tu=factory_factory("csAmd",["add","multiply","transpose"],r=>{var{add:e,multiply:t,transpose:n}=r;return function(r,a){if(!a||r<=0||r>3)return null;var o,u,s,c,f,l,p,m,h,d,g,v,D,y,x,b,_=a._size,E=_[0],w=_[1],A=0,F=Math.max(16,10*Math.sqrt(w));F=Math.min(w-2,F);var C=function(r,a,o,u,s){var c=n(a);if(1===r&&u===o)return e(a,c);if(2===r){for(var f=c._index,l=c._ptr,p=0,m=0;m<o;m++){var h=l[m];if(l[m]=p,!(l[m+1]-h>s))for(var d=l[m+1];h<d;h++)f[p++]=f[h]}l[o]=p,a=n(c)}return t(c,a)}(r,a,E,w,F);!function(r,e,t){for(var n=r._values,a=r._index,o=r._ptr,u=r._size[1],s=0,c=0;c<u;c++){var f=o[c];for(o[c]=s;f<o[c+1];f++)e(a[f],c,n?n[f]:1,null)&&(a[s]=a[f],n&&(n[s]=n[f]),s++)}o[u]=s,a.splice(s,a.length-s),n&&n.splice(s,n.length-s)}(C,_diag,0);for(var M=C._index,N=C._ptr,S=N[w],B=[],z=[],T=w+1,I=2*(w+1),O=3*(w+1),P=4*(w+1),j=5*(w+1),k=6*(w+1),q=7*(w+1),R=function(r,e,t,n,a,o,u,s,c,f,l,p){for(var m=0;m<r;m++)t[n+m]=e[m+1]-e[m];t[n+r]=0;for(var h=0;h<=r;h++)t[a+h]=-1,o[h]=-1,t[u+h]=-1,t[s+h]=-1,t[c+h]=1,t[f+h]=1,t[l+h]=0,t[p+h]=t[n+h];var d=_wclear(0,0,t,f,r);return t[l+r]=-2,e[r]=-1,t[f+r]=0,d}(w,N,z,0,O,B,I,q,T,k,P,j),U=function(r,e,t,n,a,o,u,s,c,f,l){for(var p=0,m=0;m<r;m++){var h=t[n+m];if(0===h)t[a+m]=-2,p++,e[m]=-1,t[o+m]=0;else if(h>u)t[s+m]=0,t[a+m]=-1,p++,e[m]=-r-2,t[s+r]++;else{var d=t[c+h];-1!==d&&(f[d]=m),t[l+m]=t[c+h],t[c+h]=m}}return p}(w,N,z,j,P,k,F,T,O,B,I),L=0;U<w;){for(s=-1;L<w&&-1===(s=z[O+L]);L++);-1!==z[I+s]&&(B[z[I+s]]=-1),z[O+L]=z[I+s];var Z=z[P+s],V=z[T+s];U+=V;var H=0;z[T+s]=-V;var J=N[s],$=0===Z?J:S,W=$;for(c=1;c<=Z+1;c++){for(c>Z?(l=s,p=J,m=z[0+s]-Z):(p=N[l=M[J++]],m=z[0+l]),f=1;f<=m;f++)(h=z[T+(o=M[p++])])<=0||(H+=h,z[T+o]=-h,M[W++]=o,-1!==z[I+o]&&(B[z[I+o]]=B[o]),-1!==B[o]?z[I+B[o]]=z[I+o]:z[O+z[j+o]]=z[I+o]);l!==s&&(N[l]=-s-2,z[k+l]=0)}for(0!==Z&&(S=W),z[j+s]=H,N[s]=$,z[0+s]=W-$,z[P+s]=-2,R=_wclear(R,A,z,k,w),d=$;d<W;d++)if(!((g=z[P+(o=M[d])])<=0)){var X=R-(h=-z[T+o]);for(J=N[o],v=N[o]+g-1;J<=v;J++)z[k+(l=M[J])]>=R?z[k+l]-=h:0!==z[k+l]&&(z[k+l]=z[j+l]+X)}for(d=$;d<W;d++){for(x=0,D=(v=N[o=M[d]])+z[P+o]-1,y=v,b=0,J=v;J<=D;J++)if(0!==z[k+(l=M[J])]){var Y=z[k+l]-R;Y>0?(b+=Y,M[y++]=l,x+=l):(N[l]=-s-2,z[k+l]=0)}z[P+o]=y-v+1;var G=y,Q=v+z[0+o];for(J=D+1;J<Q;J++){var K=z[T+(u=M[J])];K<=0||(b+=K,M[y++]=u,x+=u)}0===b?(N[o]=-s-2,H-=h=-z[T+o],V+=h,U+=h,z[T+o]=0,z[P+o]=-1):(z[j+o]=Math.min(z[j+o],b),M[y]=M[G],M[G]=M[v],M[v]=s,z[0+o]=y-v+1,x=(x<0?-x:x)%w,z[I+o]=z[q+x],z[q+x]=o,B[o]=x)}for(z[j+s]=H,R=_wclear(R+(A=Math.max(A,H)),A,z,k,w),d=$;d<W;d++)if(!(z[T+(o=M[d])]>=0))for(o=z[q+(x=B[o])],z[q+x]=-1;-1!==o&&-1!==z[I+o];o=z[I+o],R++){for(m=z[0+o],g=z[P+o],J=N[o]+1;J<=N[o]+m-1;J++)z[k+M[J]]=R;var rr=o;for(u=z[I+o];-1!==u;){var re=z[0+u]===m&&z[P+u]===g;for(J=N[u]+1;re&&J<=N[u]+m-1;J++)z[k+M[J]]!==R&&(re=0);re?(N[u]=-o-2,z[T+o]+=z[T+u],z[T+u]=0,z[P+u]=-1,u=z[I+u],z[I+rr]=u):(rr=u,u=z[I+u])}}for(J=$,d=$;d<W;d++)(h=-z[T+(o=M[d])])<=0||(z[T+o]=h,b=Math.min(b=z[j+o]+H-h,w-U-h),-1!==z[O+b]&&(B[z[O+b]]=o),z[I+o]=z[O+b],B[o]=-1,z[O+b]=o,L=Math.min(L,b),z[j+o]=b,M[J++]=o);z[T+s]=V,0==(z[0+s]=J-$)&&(N[s]=-1,z[k+s]=0),0!==Z&&(S=J)}for(o=0;o<w;o++)N[o]=-N[o]-2;for(u=0;u<=w;u++)z[O+u]=-1;for(u=w;u>=0;u--)z[T+u]>0||(z[I+u]=z[O+N[u]],z[O+N[u]]=u);for(l=w;l>=0;l--)z[T+l]<=0||-1===N[l]||(z[I+l]=z[O+N[l]],z[O+N[l]]=l);for(s=0,o=0;o<=w;o++)-1===N[o]&&(s=csTdfs(o,s,z,O,I,B,k));return B.splice(B.length-1,1),B};function _wclear(r,e,t,n,a){if(r<2||r+e<0){for(var o=0;o<a;o++)0!==t[n+o]&&(t[n+o]=1);r=2}return r}function _diag(r,e){return r!==e}}),ts=factory_factory("csCounts",["transpose"],r=>{var{transpose:e}=r;return function(r,t,n,a){if(!r||!t||!n)return null;var o,u,s,c,f,l,p,m=r._size,h=m[0],d=m[1],g=4*d+(a?d+h+1:0),v=[],D=2*d,y=3*d,x=4*d,b=5*d+1;for(s=0;s<g;s++)v[s]=-1;var _=[],E=e(r),w=E._index,A=E._ptr;for(s=0;s<d;s++)for(_[u=n[s]]=-1===v[y+u]?1:0;-1!==u&&-1===v[y+u];u=t[u])v[y+u]=s;if(a){for(s=0;s<d;s++)v[n[s]]=s;for(o=0;o<h;o++){for(s=d,l=A[o],p=A[o+1],f=l;f<p;f++)s=Math.min(s,v[w[f]]);v[b+o]=v[x+s],v[x+s]=o}}for(o=0;o<d;o++)v[0+o]=o;for(s=0;s<d;s++){for(-1!==t[u=n[s]]&&_[t[u]]--,c=a?v[x+s]:u;-1!==c;c=a?v[b+c]:-1)for(f=A[c];f<A[c+1];f++){var F=function(r,e,t,n,a,o,u){var s,c,f,l=0;if(r<=e||t[n+e]<=t[a+r])return -1;t[a+r]=t[n+e];var p=t[o+r];if(t[o+r]=e,-1===p)l=1,f=r;else{for(l=2,f=p;f!==t[u+f];f=t[u+f]);for(s=p;s!==f;s=c)c=t[u+s],t[u+s]=f}return{jleaf:l,q:f}}(o=w[f],u,v,y,d,D,0);F.jleaf>=1&&_[u]++,2===F.jleaf&&_[F.q]--}-1!==t[u]&&(v[0+u]=t[u])}for(u=0;u<d;u++)-1!==t[u]&&(_[t[u]]+=_[u]);return _}}),tc=factory_factory("csSqr",["add","multiply","transpose"],r=>{var{add:e,multiply:t,transpose:n}=r,a=tu({add:e,multiply:t,transpose:n}),o=ts({transpose:n});return function(r,e,t){var n,u=e._ptr,s=e._size[1],c={};if(c.q=a(r,e),r&&!c.q)return null;if(t){var f=r?function(r,e,t,n){r._values;for(var a=r._index,o=r._ptr,u=r._size,s=r._datatype,c=u[0],f=u[1],l=[],p=[],m=0,h=0;h<f;h++){p[h]=m;for(var d=t?t[h]:h,g=o[d],v=o[d+1],D=g;D<v;D++){var y=e?e[a[D]]:a[D];l[m]=y,m++}}return p[f]=m,r.createSparseMatrix({values:null,index:l,ptr:p,size:[c,f],datatype:s})}(e,null,c.q,0):e;c.parent=function(r,e){if(!r)return null;var t,n,a=r._index,o=r._ptr,u=r._size,s=u[0],c=u[1],f=[],l=[];if(e)for(t=0;t<s;t++)l[c+t]=-1;for(var p=0;p<c;p++){f[p]=-1,l[0+p]=-1;for(var m=o[p],h=o[p+1],d=m;d<h;d++){var g=a[d];for(t=e?l[c+g]:g;-1!==t&&t<p;t=n)n=l[0+t],l[0+t]=p,-1===n&&(f[t]=p);e&&(l[c+g]=p)}}return f}(f,1);var l=function(r,e){if(!r)return null;var t,n=0,a=[],o=[],u=2*e;for(t=0;t<e;t++)o[0+t]=-1;for(t=e-1;t>=0;t--)-1!==r[t]&&(o[e+t]=o[0+r[t]],o[0+r[t]]=t);for(t=0;t<e;t++)-1===r[t]&&(n=csTdfs(t,n,o,0,e,a,u));return a}(c.parent,s);if(c.cp=o(f,c.parent,l,1),f&&c.parent&&c.cp&&function(r,e){var t,n,a,o,u,s=r._ptr,c=r._index,f=r._size,l=f[0],p=f[1];e.pinv=[],e.leftmost=[];var m=e.parent,h=e.pinv,d=e.leftmost,g=[],v=l+p,D=l+2*p;for(n=0;n<p;n++)g[l+n]=-1,g[v+n]=-1,g[D+n]=0;for(t=0;t<l;t++)d[t]=-1;for(n=p-1;n>=0;n--)for(o=s[n],u=s[n+1],a=o;a<u;a++)d[c[a]]=n;for(t=l-1;t>=0;t--)h[t]=-1,-1!==(n=d[t])&&(0==g[D+n]++&&(g[v+n]=t),g[0+t]=g[l+n],g[l+n]=t);for(n=0,e.lnz=0,e.m2=l;n<p;n++)if(t=g[l+n],e.lnz++,t<0&&(t=e.m2++),h[t]=n,!(--D[n]<=0)){e.lnz+=g[D+n];var y=m[n];-1!==y&&(0===g[D+y]&&(g[v+y]=g[v+n]),g[0+g[v+n]]=g[l+y],g[l+y]=g[0+t],g[D+y]+=g[D+n])}for(t=0;t<l;t++)h[t]<0&&(h[t]=n++);return!0}(f,c))for(c.unz=0,n=0;n<s;n++)c.unz+=c.cp[n]}else c.unz=4*u[s]+s,c.lnz=c.unz;return c}}),tf=factory_factory("csSpsolve",["divideScalar","multiply","subtract"],r=>{var{divideScalar:e,multiply:t,subtract:n}=r;return function(r,a,o,u,s,c,f){var l,p,m,h,d=r._values,g=r._index,v=r._ptr,D=r._size[1],y=a._values,x=a._index,b=a._ptr,_=function(r,e,t,n,a){var o,u,s,c,f=r._ptr,l=r._size,p=e._index,m=e._ptr,h=l[1],d=h;for(s=m[t],c=m[t+1],u=s;u<c;u++){var g=p[u];f[g]<0||(d=function(r,e,t,n,a){var o,u,s,c=e._index,f=e._ptr,l=e._size[1],p=0;for(n[0]=r;p>=0;){r=n[p];var m,h,d,g=a?a[r]:r;!(f[r]<0)&&(f[m=r]=-f[m]-2,n[l+p]=g<0?0:(h=f[g])<0?-h-2:h);var v=1;for(u=n[l+p],s=g<0?0:(d=f[g+1])<0?-d-2:d;u<s;u++)if(!(f[o=c[u]]<0)){n[l+p]=u,n[++p]=o,v=0;break}v&&(p--,n[--t]=r)}return t}(g,r,d,n,a))}for(u=d;u<h;u++)f[o=n[u]]=-f[o]-2;return d}(r,a,o,u,c);for(l=_;l<D;l++)s[u[l]]=0;for(p=b[o],m=b[o+1],l=p;l<m;l++)s[x[l]]=y[l];for(var E=_;E<D;E++){var w=u[E],A=c?c[w]:w;if(!(A<0))for(p=v[A],m=v[A+1],s[w]=e(s[w],d[f?p:m-1]),l=f?p+1:p,h=f?m:m-1;l<h;l++){var F=g[l];s[F]=n(s[F],t(d[l],s[w]))}}return _}}),tl=factory_factory("csLu",["abs","divideScalar","multiply","subtract","larger","largerEq","SparseMatrix"],r=>{var{abs:e,divideScalar:t,multiply:n,subtract:a,larger:o,largerEq:u,SparseMatrix:s}=r,c=tf({divideScalar:t,multiply:n,subtract:a});return function(r,a,f){if(!r)return null;var l,p,m,h=r._size[1],d=100,g=100;a&&(l=a.q,d=a.lnz||d,g=a.unz||g);var v=[],D=[],y=[],x=new s({values:v,index:D,ptr:y,size:[h,h]}),b=[],_=[],E=[],w=new s({values:b,index:_,ptr:E,size:[h,h]}),A=[],F=[],C=[];for(p=0;p<h;p++)F[p]=0,A[p]=-1,y[p+1]=0;d=0,g=0;for(var M=0;M<h;M++){y[M]=d,E[M]=g;var N=l?l[M]:M,S=c(x,r,N,C,F,A,1),B=-1,z=-1;for(m=S;m<h;m++)if(A[p=C[m]]<0){var T=e(F[p]);o(T,z)&&(z=T,B=p)}else _[g]=A[p],b[g++]=F[p];if(-1===B||z<=0)return null;A[N]<0&&u(e(F[N]),n(z,f))&&(B=N);var I=F[B];for(_[g]=M,b[g++]=I,A[B]=M,D[d]=B,v[d++]=1,m=S;m<h;m++)A[p=C[m]]<0&&(D[d]=p,v[d++]=t(F[p],I)),F[p]=0}for(m=0,y[h]=d,E[h]=g;m<d;m++)D[m]=A[D[m]];return v.splice(d,v.length-d),D.splice(d,D.length-d),b.splice(g,b.length-g),_.splice(g,_.length-g),{L:x,U:w,pinv:A}}}),tp=factory_factory("slu",["typed","abs","add","multiply","transpose","divideScalar","subtract","larger","largerEq","SparseMatrix"],r=>{var{typed:e,abs:t,add:n,multiply:a,transpose:o,divideScalar:u,subtract:s,larger:c,largerEq:f,SparseMatrix:l}=r,p=tc({add:n,multiply:a,transpose:o}),m=tl({abs:t,divideScalar:u,multiply:a,subtract:s,larger:c,largerEq:f,SparseMatrix:l});return e("slu",{"SparseMatrix, number, number":function(r,e,t){if(!isInteger(e)||e<0||e>3)throw Error("Symbolic Ordering and Analysis order must be an integer number in the interval [0, 3]");if(t<0||t>1)throw Error("Partial pivoting threshold must be a number from 0 to 1");var n=p(e,r,!1),a=m(r,n,t);return{L:a.L,U:a.U,p:a.pinv,q:n.q,toString:function(){return"L: "+this.L.toString()+"\nU: "+this.U.toString()+"\np: "+this.p.toString()+(this.q?"\nq: "+this.q.toString():"")+"\n"}}}})}),tm="subset";function _getSubstring(r,e){if(!isIndex(e))throw TypeError("Index expected");if(isEmptyIndex(e))return"";if(validateIndexSourceSize(Array.from(r),e),1!==e.size().length)throw new DimensionError(e.size().length,1);var t=r.length;validateIndex(e.min()[0],t),validateIndex(e.max()[0],t);var n=e.dimension(0),a="";return n.forEach(function(e){a+=r.charAt(e)}),a}function _setSubstring(r,e,t,n){if(!e||!0!==e.isIndex)throw TypeError("Index expected");if(isEmptyIndex(e))return r;if(validateIndexSourceSize(Array.from(r),e),1!==e.size().length)throw new DimensionError(e.size().length,1);if(void 0!==n){if("string"!=typeof n||1!==n.length)throw TypeError("Single character expected as defaultValue")}else n=" ";var a=e.dimension(0);if(a.size()[0]!==t.length)throw new DimensionError(a.size()[0],t.length);var o=r.length;validateIndex(e.min()[0]),validateIndex(e.max()[0]);for(var u=[],s=0;s<o;s++)u[s]=r.charAt(s);if(a.forEach(function(r,e){u[r]=t.charAt(e[0])}),u.length>o)for(var c=o-1,f=u.length;c<f;c++)u[c]||(u[c]=n);return u.join("")}function _getObjectProperty(r,e){if(!isEmptyIndex(e)){if(1!==e.size().length)throw new DimensionError(e.size(),1);var t=e.dimension(0);if("string"!=typeof t)throw TypeError("String expected as index to retrieve an object property");return getSafeProperty(r,t)}}function _setObjectProperty(r,e,t){if(isEmptyIndex(e))return r;if(1!==e.size().length)throw new DimensionError(e.size(),1);var n=e.dimension(0);if("string"!=typeof n)throw TypeError("String expected as index to retrieve an object property");var a=object_clone(r);return customs_setSafeProperty(a,n,t),a}r=>{var{typed:e,matrix:t,zeros:n,add:a}=r;return e(tm,{"Matrix, Index":function(r,e){return isEmptyIndex(e)?t():(validateIndexSourceSize(r,e),r.subset(e))},"Array, Index":e.referTo("Matrix, Index",function(r){return function(e,n){var a=r(t(e),n);return n.isScalar()?a:a.valueOf()}}),"Object, Index":_getObjectProperty,"string, Index":_getSubstring,"Matrix, Index, any, any":function(r,e,t,o){return isEmptyIndex(e)?r:(validateIndexSourceSize(r,e),r.clone().subset(e,function(r,e){if("string"==typeof r)throw Error("can't boradcast a string");if(e._isScalar)return r;var t=e.size();if(!t.every(r=>r>0))return r;try{return a(r,n(t))}catch(e){return r}}(t,e),o))},"Array, Index, any, any":e.referTo("Matrix, Index, any, any",function(r){return function(e,n,a,o){var u=r(t(e),n,a,o);return u.isMatrix?u.valueOf():u}}),"Array, Index, any":e.referTo("Matrix, Index, any, any",function(r){return function(e,n,a){return r(t(e),n,a,void 0).valueOf()}}),"Matrix, Index, any":e.referTo("Matrix, Index, any, any",function(r){return function(e,t,n){return r(e,t,n,void 0)}}),"string, Index, string":_setSubstring,"string, Index, string, string":_setSubstring,"Object, Index, any":_setObjectProperty})};var th="usolveAll",td=factory_factory(th,["typed","matrix","divideScalar","multiplyScalar","subtractScalar","equalScalar","DenseMatrix"],r=>{var{typed:e,matrix:t,divideScalar:n,multiplyScalar:a,subtractScalar:o,equalScalar:u,DenseMatrix:s}=r,c=createSolveValidation({DenseMatrix:s});return e(th,{"SparseMatrix, Array | Matrix":function(r,e){return function(r,e){for(var t=[c(r,e,!0)._data.map(r=>r[0])],f=r._size[0],l=r._size[1],p=r._values,m=r._index,h=r._ptr,d=l-1;d>=0;d--)for(var g=t.length,v=0;v<g;v++){for(var D=t[v],y=[],x=[],b=h[d],_=h[d+1],E=0,w=_-1;w>=b;w--){var A=m[w];A===d?E=p[w]:A<d&&(y.push(p[w]),x.push(A))}if(u(E,0)){if(u(D[d],0)){if(0===v){var F=[...D];F[d]=1;for(var C=0,M=x.length;C<M;C++){var N=x[C];F[N]=o(F[N],y[C])}t.push(F)}}else{if(0===v)return[];t.splice(v,1),v-=1,g-=1}}else{D[d]=n(D[d],E);for(var S=0,B=x.length;S<B;S++){var z=x[S];D[z]=o(D[z],a(D[d],y[S]))}}}return t.map(r=>new s({data:r.map(r=>[r]),size:[f,1]}))}(r,e)},"DenseMatrix, Array | Matrix":function(r,e){return _denseBackwardSubstitution(r,e)},"Array, Array | Matrix":function(r,e){return _denseBackwardSubstitution(t(r),e).map(r=>r.valueOf())}});function _denseBackwardSubstitution(r,e){for(var t=[c(r,e,!0)._data.map(r=>r[0])],f=r._data,l=r._size[0],p=r._size[1],m=p-1;m>=0;m--)for(var h=t.length,d=0;d<h;d++){var g=t[d];if(u(f[m][m],0)){if(u(g[m],0)){if(0===d){var v=[...g];v[m]=1;for(var D=m-1;D>=0;D--)v[D]=o(v[D],f[D][m]);t.push(v)}}else{if(0===d)return[];t.splice(d,1),d-=1,h-=1}}else{g[m]=n(g[m],f[m][m]);for(var y=m-1;y>=0;y--)g[y]=o(g[y],a(g[m],f[y][m]))}}return t.map(r=>new s({data:r.map(r=>[r]),size:[l,1]}))}}),tg="ceil",tv=factory_factory(tg,["typed","config","round"],r=>{var{typed:e,config:t,round:n}=r;return e(tg,{number:function(r){return nearlyEqual(r,n(r),t.epsilon)?n(r):Math.ceil(r)},"number, number":function(r,e){if(nearlyEqual(r,n(r,e),t.epsilon))return n(r,e);var[a,o]="".concat(r,"e").split("e"),u=Math.ceil(Number("".concat(a,"e").concat(Number(o)+e)));return[a,o]="".concat(u,"e").split("e"),Number("".concat(a,"e").concat(Number(o)-e))}})}),tD=factory_factory(tg,["typed","config","round","matrix","equalScalar","zeros","DenseMatrix"],r=>{var{typed:e,config:t,round:n,matrix:a,equalScalar:o,zeros:u,DenseMatrix:s}=r,c=eg({typed:e,equalScalar:o}),f=ev({typed:e,DenseMatrix:s}),l=ey({typed:e}),p=tv({typed:e,config:t,round:n});return e("ceil",{number:p.signatures.number,"number,number":p.signatures["number,number"],Complex:function(r){return r.ceil()},"Complex, number":function(r,e){return r.ceil(e)},"Complex, BigNumber":function(r,e){return r.ceil(e.toNumber())},BigNumber:function(r){return nearlyEqual_nearlyEqual(r,n(r),t.epsilon)?n(r):r.ceil()},"BigNumber, BigNumber":function(r,e){return nearlyEqual_nearlyEqual(r,n(r,e),t.epsilon)?n(r,e):r.toDecimalPlaces(e.toNumber(),C.ROUND_CEIL)},Fraction:function(r){return r.ceil()},"Fraction, number":function(r,e){return r.ceil(e)},"Fraction, BigNumber":function(r,e){return r.ceil(e.toNumber())},"Array | Matrix":e.referToSelf(r=>e=>deepMap(e,r,!0)),"Array, number | BigNumber":e.referToSelf(r=>(e,t)=>deepMap(e,e=>r(e,t),!0)),"SparseMatrix, number | BigNumber":e.referToSelf(r=>(e,t)=>c(e,t,r,!1)),"DenseMatrix, number | BigNumber":e.referToSelf(r=>(e,t)=>l(e,t,r,!1)),"number | Complex | Fraction | BigNumber, Array":e.referToSelf(r=>(e,t)=>l(a(t),e,r,!0).valueOf()),"number | Complex | Fraction | BigNumber, Matrix":e.referToSelf(r=>(e,t)=>o(e,0)?u(t.size(),t.storage()):"dense"===t.storage()?l(t,e,r,!0):f(t,e,r,!0))})}),ty=t(7478),tx="compareNatural",tb=(r=>{var{typed:e,compare:t}=r,n=t.signatures["boolean,boolean"];return e(tx,{"any, any":function _compareNatural(r,e){var a,o=typeOf(r),u=typeOf(e);if(("number"===o||"BigNumber"===o||"Fraction"===o)&&("number"===u||"BigNumber"===u||"Fraction"===u))return"0"!==(a=t(r,e)).toString()?a>0?1:-1:ty(o,u);var s=["Array","DenseMatrix","SparseMatrix"];if(s.includes(o)||s.includes(u))return 0!==(a=function compareMatricesAndArrays(r,e,t){return isSparseMatrix(e)&&isSparseMatrix(t)?compareArrays(r,e.toJSON().values,t.toJSON().values):isSparseMatrix(e)?compareMatricesAndArrays(r,e.toArray(),t):isSparseMatrix(t)?compareMatricesAndArrays(r,e,t.toArray()):isDenseMatrix(e)?compareMatricesAndArrays(r,e.toJSON().data,t):isDenseMatrix(t)?compareMatricesAndArrays(r,e,t.toJSON().data):Array.isArray(e)?Array.isArray(t)?compareArrays(r,e,t):compareMatricesAndArrays(r,e,[t]):compareMatricesAndArrays(r,[e],t)}(_compareNatural,r,e))?a:ty(o,u);if(o!==u)return ty(o,u);if("Complex"===o)return r.re>e.re?1:r.re<e.re?-1:r.im>e.im?1:r.im<e.im?-1:0;if("Unit"===o)return r.equalBase(e)?_compareNatural(r.value,e.value):compareArrays(_compareNatural,r.formatUnits(),e.formatUnits());if("boolean"===o)return n(r,e);if("string"===o)return ty(r,e);if("Object"===o)return function(r,e,t){var n=Object.keys(e),a=Object.keys(t);n.sort(ty),a.sort(ty);var o=compareArrays(r,n,a);if(0!==o)return o;for(var u=0;u<n.length;u++){var s=r(e[n[u]],t[a[u]]);if(0!==s)return s}return 0}(_compareNatural,r,e);if("null"===o||"undefined"===o)return 0;throw TypeError('Unsupported type of value "'+o+'"')}});function compareArrays(r,e,t){for(var n=0,a=Math.min(e.length,t.length);n<a;n++){var o=r(e[n],t[n]);if(0!==o)return o}return e.length>t.length?1:e.length<t.length?-1:0}},factory_factory("det",["typed","matrix","subtractScalar","multiply","divideScalar","isZero","unaryMinus"],r=>{var{typed:e,matrix:t,subtractScalar:n,multiply:a,divideScalar:o,isZero:u,unaryMinus:s}=r;return e("det",{any:function(r){return object_clone(r)},"Array | Matrix":function(r){var e;switch((e=isMatrix(r)?r.size():Array.isArray(r)?(r=t(r)).size():[]).length){case 0:return object_clone(r);case 1:if(1===e[0])return object_clone(r.valueOf()[0]);if(0===e[0])return 1;throw RangeError("Matrix must be square (size: "+string_format(e)+")");case 2:var c=e[0],f=e[1];if(c===f)return function(r,e,t){if(1===e)return object_clone(r[0][0]);if(2===e)return n(a(r[0][0],r[1][1]),a(r[1][0],r[0][1]));for(var c=!1,f=Array(e).fill(0).map((r,e)=>e),l=0;l<e;l++){var p=f[l];if(u(r[p][l])){var m=void 0;for(m=l+1;m<e;m++)if(!u(r[f[m]][l])){p=f[m],f[m]=f[l],f[l]=p,c=!c;break}if(m===e)return r[p][l]}for(var h=r[p][l],d=0===l?1:r[f[l-1]][l-1],g=l+1;g<e;g++)for(var v=f[g],D=l+1;D<e;D++)r[v][D]=o(n(a(r[v][D],h),a(r[v][l],r[p][D])),d)}var y=r[f[e-1]][e-1];return c?s(y):y}(r.clone().valueOf(),c,0);if(0===f)return 1;throw RangeError("Matrix must be square (size: "+string_format(e)+")");default:throw RangeError("Matrix must be two dimensional (size: "+string_format(e)+")")}}})})),t_=factory_factory("FibonacciHeap",["smaller","larger"],r=>{var{smaller:e,larger:t}=r,n=1/Math.log((1+Math.sqrt(5))/2);function FibonacciHeap(){if(!(this instanceof FibonacciHeap))throw SyntaxError("Constructor must be called with the new operator");this._minimum=null,this._size=0}function _cut(r,e,t){e.left.right=e.right,e.right.left=e.left,t.degree--,t.child===e&&(t.child=e.right),0===t.degree&&(t.child=null),e.left=r,e.right=r.right,r.right=e,e.right.left=e,e.parent=null,e.mark=!1}FibonacciHeap.prototype.type="FibonacciHeap",FibonacciHeap.prototype.isFibonacciHeap=!0,FibonacciHeap.prototype.insert=function(r,t){var n={key:r,value:t,degree:0};if(this._minimum){var a=this._minimum;n.left=a,n.right=a.right,a.right=n,n.right.left=n,e(r,a.key)&&(this._minimum=n)}else n.left=n,n.right=n,this._minimum=n;return this._size++,n},FibonacciHeap.prototype.size=function(){return this._size},FibonacciHeap.prototype.clear=function(){this._minimum=null,this._size=0},FibonacciHeap.prototype.isEmpty=function(){return 0===this._size},FibonacciHeap.prototype.extractMinimum=function(){var r=this._minimum;if(null===r)return r;for(var a=this._minimum,o=r.degree,u=r.child;o>0;){var s=u.right;u.left.right=u.right,u.right.left=u.left,u.left=a,u.right=a.right,a.right=u,u.right.left=u,u.parent=null,u=s,o--}return r.left.right=r.right,r.right.left=r.left,a=r===r.right?null:function(r,a){var o,u=Math.floor(Math.log(a)*n)+1,s=Array(u),c=0,f=r;if(f)for(c++,f=f.right;f!==r;)c++,f=f.right;for(;c>0;){for(var l=f.degree,p=f.right;o=s[l];){if(t(f.key,o.key)){var m=o;o=f,f=m}_linkNodes(o,f),s[l]=null,l++}s[l]=f,f=p,c--}r=null;for(var h=0;h<u;h++)(o=s[h])&&(r?(o.left.right=o.right,o.right.left=o.left,o.left=r,o.right=r.right,r.right=o,o.right.left=o,e(o.key,r.key)&&(r=o)):r=o);return r}(a=r.right,this._size),this._size--,this._minimum=a,r},FibonacciHeap.prototype.remove=function(r){var t,n;this._minimum=(t=this._minimum,r.key=-1,(n=r.parent)&&e(r.key,n.key)&&(_cut(t,r,n),function _cascadingCut(r,e){var t=e.parent;t&&(e.mark?(_cut(r,e,t),_cascadingCut(t)):e.mark=!0)}(t,n)),e(r.key,t.key)&&(t=r),t),this.extractMinimum()};var _linkNodes=function(r,e){r.left.right=r.right,r.right.left=r.left,r.parent=e,e.child?(r.left=e.child,r.right=e.child.right,e.child.right=r,r.right.left=r):(e.child=r,r.right=r,r.left=r),e.degree++,r.mark=!1};return FibonacciHeap},{isClass:!0}),tE=factory_factory("fix",["typed","ceil","floor"],r=>{var{typed:e,ceil:t,floor:n}=r;return e("fix",{number:function(r){return r>0?n(r):t(r)},"number, number":function(r,e){return r>0?n(r,e):t(r,e)}})}),tw=(r=>{var{typed:e,Complex:t,matrix:n,ceil:a,floor:o,equalScalar:u,zeros:s,DenseMatrix:c}=r,f=ev({typed:e,DenseMatrix:c}),l=ey({typed:e}),p=tE({typed:e,ceil:a,floor:o});return e("fix",{number:p.signatures.number,"number, number | BigNumber":p.signatures["number,number"],Complex:function(r){return new t(r.re>0?Math.floor(r.re):Math.ceil(r.re),r.im>0?Math.floor(r.im):Math.ceil(r.im))},"Complex, number":function(r,e){return new t(r.re>0?o(r.re,e):a(r.re,e),r.im>0?o(r.im,e):a(r.im,e))},"Complex, BigNumber":function(r,e){var n=e.toNumber();return new t(r.re>0?o(r.re,n):a(r.re,n),r.im>0?o(r.im,n):a(r.im,n))},BigNumber:function(r){return r.isNegative()?a(r):o(r)},"BigNumber, number | BigNumber":function(r,e){return r.isNegative()?a(r,e):o(r,e)},Fraction:function(r){return r.s<0?r.ceil():r.floor()},"Fraction, number | BigNumber":function(r,e){return r.s<0?a(r,e):o(r,e)},"Array | Matrix":e.referToSelf(r=>e=>deepMap(e,r,!0)),"Array | Matrix, number | BigNumber":e.referToSelf(r=>(e,t)=>deepMap(e,e=>r(e,t),!0)),"number | Complex | Fraction | BigNumber, Array":e.referToSelf(r=>(e,t)=>l(n(t),e,r,!0).valueOf()),"number | Complex | Fraction | BigNumber, Matrix":e.referToSelf(r=>(e,t)=>u(e,0)?s(t.size(),t.storage()):"dense"===t.storage()?l(t,e,r,!0):f(t,e,r,!0))})},"index");r=>{var{typed:e,Index:t}=r;return e(tw,{"...number | string | BigNumber | Range | Array | Matrix":function(r){var e=r.map(function(r){return isBigNumber(r)?r.toNumber():M(r)||isMatrix(r)?r.map(function(r){return isBigNumber(r)?r.toNumber():r}):r}),n=new t;return t.apply(n,e),n}})};var tA="smallerEq",tF=factory_factory(tA,["typed","config","matrix","DenseMatrix","concat"],r=>{var{typed:e,config:t,matrix:n,DenseMatrix:a,concat:o}=r,u=eh({typed:e}),s=ed({typed:e,DenseMatrix:a}),c=ev({typed:e,DenseMatrix:a}),f=eb({typed:e,matrix:n,concat:o}),l=rm({typed:e});return e(tA,tC({typed:e,config:t}),{"boolean, boolean":(r,e)=>r<=e,"BigNumber, BigNumber":function(r,e){return r.lte(e)||nearlyEqual_nearlyEqual(r,e,t.epsilon)},"Fraction, Fraction":(r,e)=>1!==r.compare(e),"Complex, Complex":function(){throw TypeError("No ordering relation is defined for complex numbers")}},l,f({SS:s,DS:u,Ss:c}))}),tC=factory_factory(tA,["typed","config"],r=>{var{typed:e,config:t}=r;return e(tA,{"number, number":function(r,e){return r<=e||nearlyEqual(r,e,t.epsilon)}})}),tM="range",tN=factory_factory(tM,["typed","config","?matrix","?bignumber","smaller","smallerEq","larger","largerEq","add","isPositive"],r=>{var{typed:e,config:t,matrix:n,bignumber:a,smaller:o,smallerEq:u,larger:s,largerEq:c,add:f,isPositive:l}=r;return e(tM,{string:_strRange,"string, boolean":_strRange,"number, number":function(r,e){return _out(_range(r,e,1,!1))},"number, number, number":function(r,e,t){return _out(_range(r,e,t,!1))},"number, number, boolean":function(r,e,t){return _out(_range(r,e,1,t))},"number, number, number, boolean":function(r,e,t,n){return _out(_range(r,e,t,n))},"BigNumber, BigNumber":function(r,e){var t=r.constructor;return _out(_range(r,e,new t(1),!1))},"BigNumber, BigNumber, BigNumber":function(r,e,t){return _out(_range(r,e,t,!1))},"BigNumber, BigNumber, boolean":function(r,e,t){var n=r.constructor;return _out(_range(r,e,new n(1),t))},"BigNumber, BigNumber, BigNumber, boolean":function(r,e,t,n){return _out(_range(r,e,t,n))},"Unit, Unit, Unit":function(r,e,t){return _out(_range(r,e,t,!1))},"Unit, Unit, Unit, boolean":function(r,e,t,n){return _out(_range(r,e,t,n))}});function _out(r){return"Matrix"===t.matrix?n?n(r):noMatrix():r}function _strRange(r,e){var n=function(r){var e=r.split(":").map(function(r){return Number(r)});if(e.some(function(r){return isNaN(r)}))return null;switch(e.length){case 2:return{start:e[0],end:e[1],step:1};case 3:return{start:e[0],end:e[2],step:e[1]};default:return null}}(r);if(!n)throw SyntaxError('String "'+r+'" is no valid range');return"BigNumber"===t.number?(void 0===a&&noBignumber(),_out(_range(a(n.start),a(n.end),a(n.step)),e)):_out(_range(n.start,n.end,n.step,e))}function _range(r,e,t,n){for(var a=[],p=l(t)?n?u:o:n?c:s,m=r;p(m,e);)a.push(m),m=f(m,t);return a}}),tS=(r=>{var{typed:e,size:t,concat:n,subset:a,setDifference:o,Index:u}=r;return e("setSymDifference",{"Array | Matrix, Array | Matrix":function(r,e){if(0===a(t(r),new u(0)))return flatten(e);if(0===a(t(e),new u(0)))return flatten(r);var s=flatten(r),c=flatten(e);return n(o(s,c),o(c,s))}})},factory_factory("Spa",["addScalar","equalScalar","FibonacciHeap"],r=>{var{addScalar:e,equalScalar:t,FibonacciHeap:n}=r;function Spa(){if(!(this instanceof Spa))throw SyntaxError("Constructor must be called with the new operator");this._values=[],this._heap=new n}return Spa.prototype.type="Spa",Spa.prototype.isSpa=!0,Spa.prototype.set=function(r,e){if(this._values[r])this._values[r].value=e;else{var t=this._heap.insert(r,e);this._values[r]=t}},Spa.prototype.get=function(r){var e=this._values[r];return e?e.value:0},Spa.prototype.accumulate=function(r,t){var n=this._values[r];n?n.value=e(n.value,t):(n=this._heap.insert(r,t),this._values[r]=n)},Spa.prototype.forEach=function(r,e,n){var a=this._heap,o=this._values,u=[],s=a.extractMinimum();for(s&&u.push(s);s&&s.key<=e;)s.key>=r&&!t(s.value,0)&&n(s.key,s.value,this),(s=a.extractMinimum())&&u.push(s);for(var c=0;c<u.length;c++){var f=u[c];o[(s=a.insert(f.key,f.value)).key]=s}},Spa.prototype.swap=function(r,e){var t=this._values[r],n=this._values[e];if(!t&&n)t=this._heap.insert(r,n.value),this._heap.remove(n),this._values[r]=t,this._values[e]=void 0;else if(t&&!n)n=this._heap.insert(e,t.value),this._heap.remove(t),this._values[e]=n,this._values[r]=void 0;else if(t&&n){var a=t.value;t.value=n.value,n.value=a}},Spa},{isClass:!0})),tB="column",tz=factory_factory(tB,["typed","Index","matrix","range"],r=>{var{typed:e,Index:t,matrix:n,range:a}=r;return e(tB,{"Matrix, number":_column,"Array, number":function(r,e){return _column(n(object_clone(r)),e).valueOf()}});function _column(r,e){if(2!==r.size().length)throw Error("Only two dimensional matrix is supported");validateIndex(e,r.size()[1]);var o=a(0,r.size()[0]),u=new t(o,e),s=r.subset(u);return isMatrix(s)?s:n([[s]])}}),tT=factory_factory("inv",["typed","matrix","divideScalar","addScalar","multiply","unaryMinus","det","identity","abs"],r=>{var{typed:e,matrix:t,divideScalar:n,addScalar:a,multiply:o,unaryMinus:u,det:s,identity:c,abs:f}=r;return e("inv",{"Array | Matrix":function(r){var e=isMatrix(r)?r.size():arraySize(r);switch(e.length){case 1:if(1===e[0]){if(isMatrix(r))return t([n(1,r.valueOf()[0])]);return[n(1,r[0])]}throw RangeError("Matrix must be square (size: "+string_format(e)+")");case 2:var a=e[0],o=e[1];if(a===o){if(isMatrix(r))return t(_inv(r.valueOf(),a,o),r.storage());return _inv(r,a,o)}throw RangeError("Matrix must be square (size: "+string_format(e)+")");default:throw RangeError("Matrix must be two dimensional (size: "+string_format(e)+")")}},any:function(r){return n(1,r)}});function _inv(r,e,t){if(1===e){if(0===(h=r[0][0]))throw Error("Cannot calculate inverse, determinant is zero");return[[n(1,h)]]}if(2===e){var l,p,m,h,d,g=s(r);if(0===g)throw Error("Cannot calculate inverse, determinant is zero");return[[n(r[1][1],g),n(u(r[0][1]),g)],[n(u(r[1][0]),g),n(r[0][0],g)]]}var v=r.concat();for(l=0;l<e;l++)v[l]=v[l].concat();for(var D=c(e).valueOf(),y=0;y<t;y++){var x=f(v[y][y]),b=y;for(l=y+1;l<e;)f(v[l][y])>x&&(x=f(v[l][y]),b=l),l++;if(0===x)throw Error("Cannot calculate inverse, determinant is zero");(l=b)!==y&&(d=v[y],v[y]=v[l],v[l]=d,d=D[y],D[y]=D[l],D[l]=d);var _=v[y],E=D[y];for(l=0;l<e;l++){var w=v[l],A=D[l];if(l!==y){if(0!==w[y]){for(m=n(u(w[y]),_[y]),p=y;p<t;p++)w[p]=a(w[p],o(m,_[p]));for(p=0;p<t;p++)A[p]=a(A[p],o(m,E[p]))}}else{for(m=_[y],p=y;p<t;p++)w[p]=n(w[p],m);for(p=0;p<t;p++)A[p]=n(A[p],m)}}}return D}}),tI=factory_factory("lup",["typed","matrix","abs","addScalar","divideScalar","multiplyScalar","subtractScalar","larger","equalScalar","unaryMinus","DenseMatrix","SparseMatrix","Spa"],r=>{var{typed:e,matrix:t,abs:n,addScalar:a,divideScalar:o,multiplyScalar:u,subtractScalar:s,larger:c,equalScalar:f,unaryMinus:l,DenseMatrix:p,SparseMatrix:m,Spa:h}=r;return e("lup",{DenseMatrix:function(r){return _denseLUP(r)},SparseMatrix:function(r){return function(r){var e,t,a,s=r._size[0],p=r._size[1],d=Math.min(s,p),g=r._values,v=r._index,D=r._ptr,y=[],x=[],b=[],_=[s,d],E=[],w=[],A=[],F=[d,p],C=[],M=[];for(e=0;e<s;e++)C[e]=e,M[e]=e;var swapIndeces=function(r,e){var t=M[r],n=M[e];C[t]=e,C[n]=r,M[r]=n,M[e]=t};for(t=0;t<p;t++)!function(){var r=new h;t<s&&(b.push(y.length),y.push(1),x.push(t)),A.push(E.length);var p=D[t],d=D[t+1];for(a=p;a<d;a++)e=v[a],r.set(C[e],g[a]);t>0&&r.forEach(0,t-1,function(e,t){m._forEachRow(e,y,x,b,function(n,a){n>e&&r.accumulate(n,l(u(a,t)))})});var M=t,N=r.get(t),S=n(N);r.forEach(t+1,s-1,function(r,e){var t=n(e);c(t,S)&&(M=r,S=t,N=e)}),t!==M&&(m._swapRows(t,M,_[1],y,x,b),m._swapRows(t,M,F[1],E,w,A),r.swap(t,M),swapIndeces(t,M)),r.forEach(0,s-1,function(r,e){r<=t?(E.push(e),w.push(r)):f(e=o(e,N),0)||(y.push(e),x.push(r))})}();return A.push(E.length),b.push(y.length),{L:new m({values:y,index:x,ptr:b,size:_}),U:new m({values:E,index:w,ptr:A,size:F}),p:C,toString:function(){return"L: "+this.L.toString()+"\nU: "+this.U.toString()+"\nP: "+this.p}}}(r)},Array:function(r){var e=_denseLUP(t(r));return{L:e.L.valueOf(),U:e.U.valueOf(),p:e.p}}});function _denseLUP(r){var e,t,l,m=r._size[0],h=r._size[1],d=Math.min(m,h),g=object_clone(r._data),v=[],D=[m,d],y=[],x=[d,h],b=[];for(e=0;e<m;e++)b[e]=e;for(t=0;t<h;t++){if(t>0)for(e=0;e<m;e++){var _=Math.min(e,t),E=0;for(l=0;l<_;l++)E=a(E,u(g[e][l],g[l][t]));g[e][t]=s(g[e][t],E)}var w=t,A=0,F=0;for(e=t;e<m;e++){var C=g[e][t],M=n(C);c(M,A)&&(w=e,A=M,F=C)}if(t!==w&&(b[t]=[b[w],b[w]=b[t]][0],p._swapRows(t,w,g)),t<m)for(e=t+1;e<m;e++)f(g[e][t],0)||(g[e][t]=o(g[e][t],F))}for(t=0;t<h;t++)for(e=0;e<m;e++){if(0===t&&(e<h&&(y[e]=[]),v[e]=[]),e<t){e<h&&(y[e][t]=g[e][t]),t<m&&(v[e][t]=0);continue}if(e===t){e<h&&(y[e][t]=g[e][t]),t<m&&(v[e][t]=1);continue}e<h&&(y[e][t]=0),t<m&&(v[e][t]=g[e][t])}var N=new p({data:v,size:D}),S=new p({data:y,size:x}),B=[];for(e=0,d=b.length;e<d;e++)B[b[e]]=e;return{L:N,U:S,p:B,toString:function(){return"L: "+this.L.toString()+"\nU: "+this.U.toString()+"\nP: "+this.p}}}}),tO=factory_factory("pow",["typed","config","identity","multiply","matrix","inv","fraction","number","Complex"],r=>{var{typed:e,config:t,identity:n,multiply:a,matrix:o,inv:u,number:s,fraction:c,Complex:f}=r;return e("pow",{"number, number":_pow,"Complex, Complex":function(r,e){return r.pow(e)},"BigNumber, BigNumber":function(r,e){return e.isInteger()||r>=0||t.predictable?r.pow(e):new f(r.toNumber(),0).pow(e.toNumber(),0)},"Fraction, Fraction":function(r,e){var n=r.pow(e);if(null!=n)return n;if(!t.predictable)return _pow(r.valueOf(),e.valueOf());throw Error("Result of pow is non-rational and cannot be expressed as a fraction")},"Array, number":_powArray,"Array, BigNumber":function(r,e){return _powArray(r,e.toNumber())},"Matrix, number":_powMatrix,"Matrix, BigNumber":function(r,e){return _powMatrix(r,e.toNumber())},"Unit, number | BigNumber":function(r,e){return r.pow(e)}});function _pow(r,e){if(t.predictable&&!isInteger(e)&&r<0)try{var n=c(e),a=s(n);if((e===a||1e-14>Math.abs((e-a)/e))&&n.d%2==1)return(n.n%2==0?1:-1)*Math.pow(-r,e)}catch(r){}return t.predictable&&(r<-1&&e===1/0||r>-1&&r<0&&e===-1/0)?NaN:isInteger(e)||r>=0||t.predictable?powNumber(r,e):r*r<1&&e===1/0||r*r>1&&e===-1/0?0:new f(r,0).pow(e,0)}function _powArray(r,e){if(!isInteger(e))throw TypeError("For A^b, b must be an integer (value is "+e+")");var t=arraySize(r);if(2!==t.length)throw Error("For A^b, A must be 2 dimensional (A has "+t.length+" dimensions)");if(t[0]!==t[1])throw Error("For A^b, A must be square (size is "+t[0]+"x"+t[1]+")");if(e<0)try{return _powArray(u(r),-e)}catch(r){if("Cannot calculate inverse, determinant is zero"===r.message)throw TypeError("For A^b, when A is not invertible, b must be a positive integer (value is "+e+")");throw r}for(var o=n(t[0]).valueOf(),s=r;e>=1;)(1&e)==1&&(o=a(s,o)),e>>=1,s=a(s,s);return o}function _powMatrix(r,e){return o(_powArray(r.valueOf(),e))}});function _typeof(r){return(_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(r){return typeof r}:function(r){return r&&"function"==typeof Symbol&&r.constructor===Symbol&&r!==Symbol.prototype?"symbol":typeof r})(r)}function ownKeys(r,e){var t=Object.keys(r);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(r);e&&(n=n.filter(function(e){return Object.getOwnPropertyDescriptor(r,e).enumerable})),t.push.apply(t,n)}return t}function _objectSpread(r){for(var e=1;e<arguments.length;e++){var t=null!=arguments[e]?arguments[e]:{};e%2?ownKeys(Object(t),!0).forEach(function(e){!function(r,e,t){var n;n=function(r,e){if("object"!=_typeof(r)||!r)return r;var t=r[Symbol.toPrimitive];if(void 0!==t){var n=t.call(r,e||"default");if("object"!=_typeof(n))return n;throw TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(r)}(e,"string"),(e="symbol"==_typeof(n)?n:String(n))in r?Object.defineProperty(r,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):r[e]=t}(r,e,t[e])}):Object.getOwnPropertyDescriptors?Object.defineProperties(r,Object.getOwnPropertyDescriptors(t)):ownKeys(Object(t)).forEach(function(e){Object.defineProperty(r,e,Object.getOwnPropertyDescriptor(t,e))})}return r}var tP="gamma",tj=factory_factory(tP,["typed","config","multiplyScalar","pow","BigNumber","Complex"],r=>{var{typed:e,config:t,multiplyScalar:n,pow:a,BigNumber:o,Complex:u}=r;return e(tP,{number:gammaNumber,Complex:function gammaComplex(r){if(0===r.im)return gammaNumber(r.re);if(r.re<.5){var e=new u(1-r.re,-r.im),t=new u(Math.PI*r.re,Math.PI*r.im);return new u(Math.PI).div(t.sin()).div(gammaComplex(e))}r=new u(r.re-1,r.im);for(var n=new u(rN[0],0),a=1;a<rN.length;++a){var o=new u(rN[a],0);n=n.add(o.div(r.add(a)))}var s=new u(r.re+rM+.5,r.im),c=Math.sqrt(2*Math.PI),f=s.pow(r.add(.5)),l=s.neg().exp();return n.mul(c).mul(f).mul(l)},BigNumber:function(r){if(r.isInteger())return r.isNegative()||r.isZero()?new o(1/0):function bigFactorial(r){if(r<8)return new o([1,1,2,6,24,120,720,5040][r]);var e=t.precision+(0|Math.log(r.toNumber())),n=o.clone({precision:e});if(r%2==1)return r.times(bigFactorial(new o(r-1)));for(var a=r,u=new n(r),s=r.toNumber();a>2;)a-=2,s+=a,u=u.times(s);return new o(u.toPrecision(o.precision))}(r.minus(1));if(!r.isFinite())return new o(r.isNegative()?NaN:1/0);throw Error("Integer BigNumber expected")}})}),tk=factory_factory("divide",["typed","matrix","multiply","equalScalar","divideScalar","inv"],r=>{var{typed:e,matrix:t,multiply:n,equalScalar:a,divideScalar:o,inv:u}=r,s=eg({typed:e,equalScalar:a}),c=ey({typed:e});return e("divide",extend({"Array | Matrix, Array | Matrix":function(r,e){return n(r,u(e))},"DenseMatrix, any":function(r,e){return c(r,e,o,!1)},"SparseMatrix, any":function(r,e){return s(r,e,o,!1)},"Array, any":function(r,e){return c(t(r),e,o,!1).valueOf()},"any, Array | Matrix":function(r,e){return n(r,u(e))}},o.signatures))}),tq="factorial";function csIpvec(r,e){var t,n=e.length,a=[];if(r)for(t=0;t<n;t++)a[r[t]]=e[t];else for(t=0;t<n;t++)a[t]=e[t];return a}r=>{var{typed:e,gamma:t}=r;return e(tq,{number:function(r){if(r<0)throw Error("Value must be non-negative");return t(r+1)},BigNumber:function(r){if(r.isNegative())throw Error("Value must be non-negative");return t(r.plus(1))},"Array | Matrix":e.referToSelf(r=>e=>deepMap(e,r))})};var tR="lusolve";r=>{var{typed:e,matrix:t,lup:n,slu:a,usolve:o,lsolve:u,DenseMatrix:s}=r,c=createSolveValidation({DenseMatrix:s});return e(tR,{"Array, Array | Matrix":function(r,e){var a=n(r=t(r));return _lusolve(a.L,a.U,a.p,null,e).valueOf()},"DenseMatrix, Array | Matrix":function(r,e){var t=n(r);return _lusolve(t.L,t.U,t.p,null,e)},"SparseMatrix, Array | Matrix":function(r,e){var t=n(r);return _lusolve(t.L,t.U,t.p,null,e)},"SparseMatrix, Array | Matrix, number, number":function(r,e,t,n){var o=a(r,t,n);return _lusolve(o.L,o.U,o.p,o.q,e)},"Object, Array | Matrix":function(r,e){return _lusolve(r.L,r.U,r.p,r.q,e)}});function _toMatrix(r){if(isMatrix(r))return r;if(M(r))return t(r);throw TypeError("Invalid Matrix LU decomposition")}function _lusolve(r,e,t,n,a){r=_toMatrix(r),e=_toMatrix(e),t&&((a=c(r,a,!0))._data=csIpvec(t,a._data));var s=o(e,u(r,a));return n&&(s._data=csIpvec(n,s._data)),s}};var tU=factory_factory("eigs",["config","typed","matrix","addScalar","equal","subtract","abs","atan","cos","sin","multiplyScalar","divideScalar","inv","bignumber","multiply","add","larger","column","flatten","number","complex","sqrt","diag","size","reshape","qr","usolve","usolveAll","im","re","smaller","matrixFromColumns","dot"],r=>{var{config:e,typed:t,matrix:n,addScalar:a,subtract:o,equal:u,abs:s,atan:c,cos:f,sin:l,multiplyScalar:p,divideScalar:m,inv:h,bignumber:d,multiply:g,add:v,larger:D,column:y,flatten:x,number:b,complex:_,sqrt:E,diag:w,size:A,reshape:F,qr:C,usolve:M,usolveAll:N,im:S,re:B,smaller:z,matrixFromColumns:T,dot:I}=r,O=function(r){var{config:e,addScalar:t,subtract:n,abs:a,atan:o,cos:u,sin:s,multiplyScalar:c,inv:f,bignumber:l,multiply:p,add:m}=r;function getAij(r){for(var e=r.length,t=0,n=[0,1],a=0;a<e;a++)for(var o=a+1;o<e;o++)Math.abs(t)<Math.abs(r[a][o])&&(t=Math.abs(r[a][o]),n=[a,o]);return[n,t]}function getAijBig(r){for(var e=r.length,t=0,n=[0,1],o=0;o<e;o++)for(var u=o+1;u<e;u++)a(t)<a(r[o][u])&&(t=a(r[o][u]),n=[o,u]);return[n,t]}function sorting(r,e,t){var n,o=r.length,u=Array(o);if(t){n=Array(o);for(var s=0;s<o;s++)n[s]=Array(o)}for(var c=0;c<o;c++){for(var f=0,l=r[0],p=0;p<r.length;p++)a(r[p])<a(l)&&(l=r[f=p]);if(u[c]=r.splice(f,1)[0],t)for(var m=0;m<o;m++)n[c][m]=e[m][f],e[m].splice(f,1)}return t?{values:u,eigenvectors:n.map((r,e)=>({value:u[e],vector:r}))}:{values:u}}return function(r,h){var d=arguments.length>2&&void 0!==arguments[2]?arguments[2]:e.epsilon,g=arguments.length>3?arguments[3]:void 0,v=arguments.length>4?arguments[4]:void 0;if("number"===g)return function(r,t,n){var a,o,u=r.length,s=Math.abs(t/u);if(n){o=Array(u);for(var c=0;c<u;c++)o[c]=Array(u).fill(0),o[c][c]=1}for(var f=getAij(r);Math.abs(f[1])>=Math.abs(s);){var l,p,m,h=f[0][0],d=f[0][1];l=r[h][h],p=r[d][d],m=r[h][d],r=function(r,e,t,n){for(var a=r.length,o=Math.cos(e),u=Math.sin(e),s=o*o,c=u*u,f=Array(a).fill(0),l=Array(a).fill(0),p=s*r[t][t]-2*o*u*r[t][n]+c*r[n][n],m=c*r[t][t]+2*o*u*r[t][n]+s*r[n][n],h=0;h<a;h++)f[h]=o*r[t][h]-u*r[n][h],l[h]=u*r[t][h]+o*r[n][h];r[t][t]=p,r[n][n]=m,r[t][n]=0,r[n][t]=0;for(var d=0;d<a;d++)d!==t&&d!==n&&(r[t][d]=f[d],r[d][t]=f[d],r[n][d]=l[d],r[d][n]=l[d]);return r}(r,a=Math.abs(p-l)<=e.epsilon?Math.PI/4:.5*Math.atan(2*m/(p-l)),h,d),n&&(o=function(r,e,t,n){for(var a=r.length,o=Math.cos(e),u=Math.sin(e),s=Array(a).fill(0),c=Array(a).fill(0),f=0;f<a;f++)s[f]=o*r[f][t]-u*r[f][n],c[f]=u*r[f][t]+o*r[f][n];for(var l=0;l<a;l++)r[l][t]=s[l],r[l][n]=c[l];return r}(o,a,h,d)),f=getAij(r)}for(var g=Array(u).fill(0),v=0;v<u;v++)g[v]=r[v][v];return sorting(object_clone(g),o,n)}(r,d,v);if("BigNumber"===g)return function(r,h,d){var g,v,D=r.length,y=a(h/D);if(d){v=Array(D);for(var x=0;x<D;x++)v[x]=Array(D).fill(0),v[x][x]=1}for(var b=getAijBig(r);a(b[1])>=a(y);){var _=b[0][0],E=b[0][1];g=function(r,t,u){var s=n(t,r);return a(s)<=e.epsilon?l(-1).acos().div(4):c(.5,o(p(2,u,f(s))))}(r[_][_],r[E][E],r[_][E]),r=function(r,e,a,o){for(var f=r.length,h=l(u(e)),d=l(s(e)),g=c(h,h),v=c(d,d),D=Array(f).fill(l(0)),y=Array(f).fill(l(0)),x=p(l(2),h,d,r[a][o]),b=t(n(c(g,r[a][a]),x),c(v,r[o][o])),_=m(c(v,r[a][a]),x,c(g,r[o][o])),E=0;E<f;E++)D[E]=n(c(h,r[a][E]),c(d,r[o][E])),y[E]=t(c(d,r[a][E]),c(h,r[o][E]));r[a][a]=b,r[o][o]=_,r[a][o]=l(0),r[o][a]=l(0);for(var w=0;w<f;w++)w!==a&&w!==o&&(r[a][w]=D[w],r[w][a]=D[w],r[o][w]=y[w],r[w][o]=y[w]);return r}(r,g,_,E),d&&(v=function(r,e,a,o){for(var f=r.length,p=u(e),m=s(e),h=Array(f).fill(l(0)),d=Array(f).fill(l(0)),g=0;g<f;g++)h[g]=n(c(p,r[g][a]),c(m,r[g][o])),d[g]=t(c(m,r[g][a]),c(p,r[g][o]));for(var v=0;v<f;v++)r[v][a]=h[v],r[v][o]=d[v];return r}(v,g,_,E)),b=getAijBig(r)}for(var w=Array(D).fill(0),A=0;A<D;A++)w[A]=r[A][A];return sorting(object_clone(w),v,d)}(r,d,v);throw TypeError("Unsupported data type: "+g)}}({config:e,addScalar:a,subtract:o,column:y,flatten:x,equal:u,abs:s,atan:c,cos:f,sin:l,multiplyScalar:p,inv:h,bignumber:d,complex:_,multiply:g,add:v}),P=function(r){var{addScalar:e,subtract:t,flatten:n,multiply:a,multiplyScalar:o,divideScalar:u,sqrt:s,abs:c,bignumber:f,diag:l,size:p,reshape:m,inv:h,qr:d,usolve:g,usolveAll:v,equal:D,complex:y,larger:x,smaller:b,matrixFromColumns:_,dot:E}=r;function inflateMatrix(r,e){for(var t=0;t<r.length;t++)r[t].push(...Array(e-r[t].length).fill(0));for(var n=r.length;n<e;n++)r.push(Array(e).fill(0)),r[n][n]=1;return r}function orthogonalComplement(r,e){var n=p(r);for(var o of e)r=t(r,a(u(E(o=m(o,n),r),E(o,o)),o));return r}function norm(r){return c(s(E(r,r)))}function normalize(r,e){return a(u("BigNumber"===e?f(1):"Complex"===e?y(1):1,norm(r)),r)}return function(r,p,m,_){var E=!(arguments.length>4)||void 0===arguments[4]||arguments[4],w=function(r,t,n,a,s){var p,m="BigNumber"===a,h=m?f(0):0,d=m?f(1):"Complex"===a?y(1):1,g=m?f(1):1,v=m?f(10):2,_=o(v,v);s&&(p=Array(t).fill(d));for(var E=!1;!E;){E=!0;for(var w=0;w<t;w++){for(var A=h,F=h,C=0;C<t;C++)w!==C&&(A=e(A,c(r[C][w])),F=e(F,c(r[w][C])));if(!D(A,0)&&!D(F,0)){for(var M=g,N=A,S=u(F,v),B=o(F,v);b(N,S);)N=o(N,_),M=o(M,v);for(;x(N,B);)N=u(N,_),M=u(M,v);if(b(u(e(N,F),M),o(e(A,F),.95))){E=!1;for(var z=u(1,M),T=0;T<t;T++)w!==T&&(r[w][T]=o(r[w][T],z),r[T][w]=o(r[T][w],M));s&&(p[w]=o(p[w],z))}}}}return s?l(p):null}(r,p,0,_,E);!function(r,n,a,s,l,p){var m="BigNumber"===s,h=m?f(0):"Complex"===s?y(0):0;m&&(a=f(a));for(var d=0;d<n-2;d++){for(var g=0,v=h,D=d+1;D<n;D++){var x=r[D][d];b(c(v),c(x))&&(v=x,g=D)}if(!b(c(v),a)){if(g!==d+1){var _=r[g];r[g]=r[d+1],r[d+1]=_;for(var E=0;E<n;E++){var w=r[E][g];r[E][g]=r[E][d+1],r[E][d+1]=w}if(l){var A=p[g];p[g]=p[d+1],p[d+1]=A}}for(var F=d+2;F<n;F++){var C=u(r[F][d],v);if(0!==C){for(var M=0;M<n;M++)r[F][M]=t(r[F][M],o(C,r[d+1][M]));for(var N=0;N<n;N++)r[N][d+1]=e(r[N][d+1],o(C,r[N][F]));if(l)for(var S=0;S<n;S++)p[F][S]=t(p[F][S],o(C,p[d+1][S]))}}}}}(r,p,m,_,E,w);var{values:A,C:F}=function(r,n,u,p,m){var h="BigNumber"===p,g="Complex"===p,v=h?f(1):g?y(1):1;h&&(u=f(u));for(var D=object_clone(r),_=[],E=n,w=[],A=m?l(Array(n).fill(v)):void 0,F=m?l(Array(E).fill(v)):void 0,C=0;C<=100;){C+=1;for(var M=D[E-1][E-1],N=0;N<E;N++)D[N][N]=t(D[N][N],M);var{Q:S,R:B}=d(D);D=a(B,S);for(var z=0;z<E;z++)D[z][z]=e(D[z][z],M);if(m&&(F=a(F,S)),1===E||b(c(D[E-1][E-2]),u)){C=0,_.push(D[E-1][E-1]),m&&(w.unshift([[1]]),inflateMatrix(F,n),A=a(A,F),E>1&&(F=l(Array(E-1).fill(v)))),E-=1,D.pop();for(var T=0;T<E;T++)D[T].pop()}else if(2===E||b(c(D[E-2][E-3]),u)){C=0;var I=function(r,n,a,u){var c=e(r,u),f=t(o(r,u),o(n,a)),l=o(c,.5),p=o(s(t(o(c,c),o(4,f))),.5);return[e(l,p),t(l,p)]}(D[E-2][E-2],D[E-2][E-1],D[E-1][E-2],D[E-1][E-1]);_.push(...I),m&&(w.unshift(function(r,e,n,a,o,u,s,l){var p="BigNumber"===l,m="Complex"===l,h=p?f(0):m?y(0):0,d=p?f(1):m?y(1):1;if(b(c(n),s))return[[d,h],[h,d]];if(x(c(t(o,u)),s))return[[t(o,a),t(u,a)],[n,n]];var g=t(r,o),v=t(a,o);return b(c(e),s)&&b(c(v),s)?[[g,d],[n,h]]:[[e,h],[v,d]]}(D[E-2][E-2],D[E-2][E-1],D[E-1][E-2],D[E-1][E-1],I[0],I[1],u,p)),inflateMatrix(F,n),A=a(A,F),E>2&&(F=l(Array(E-2).fill(v)))),E-=2,D.pop(),D.pop();for(var O=0;O<E;O++)D[O].pop(),D[O].pop()}if(0===E)break}if(_.sort((r,e)=>+t(c(r),c(e))),C>100){var P=Error("The eigenvalues failed to converge. Only found these eigenvalues: "+_.join(", "));throw P.values=_,P.vectors=[],P}return{values:_,C:m?a(A,function(r,e){for(var t=[],n=0;n<e;n++)t[n]=Array(e).fill(0);var a=0;for(var o of r){for(var u=o.length,s=0;s<u;s++)for(var c=0;c<u;c++)t[a+s][a+c]=o[s][c];a+=u}return t}(w,n)):void 0}}(r,p,m,_,E);return E?{values:A,eigenvectors:function(r,e,o,u,s,c,p){var m=a(h(o),r,o),d="BigNumber"===p,_="Complex"===p,E=d?f(0):_?y(0):0,w=d?f(1):_?y(1):1,A=[],F=[];for(var C of s){var M=function(r,e,t){for(var n=0;n<r.length;n++)if(t(r[n],e))return n;return -1}(A,C,D);-1===M?(A.push(C),F.push(1)):F[M]+=1}for(var N=[],S=A.length,B=Array(e).fill(E),z=l(Array(e).fill(w)),T=0;T<S;T++)!function(){var r=A[T],s=t(m,a(r,z)),l=v(s,B);for(l.shift();l.length<F[T];){var d=function(r,e,t,n,a){for(var o,u="BigNumber"===a?f(1e3):1e3,s=0;s<5;++s){o=function(r,e,t){var n="BigNumber"===t,a="Complex"===t,o=Array(r).fill(0).map(r=>2*Math.random()-1);return n&&(o=o.map(r=>f(r))),a&&(o=o.map(r=>y(r))),normalize(o=orthogonalComplement(o,e),t)}(e,t,a);try{o=g(r,o)}catch(r){continue}if(x(norm(o),u))break}if(s>=5)return null;for(s=0;;){var c=g(r,o);if(b(norm(orthogonalComplement(o,[c])),n))break;if(++s>=10)return null;o=normalize(c)}return o}(s,e,l,c,p);if(null===d)break;l.push(d)}var D=a(h(u),o);l=l.map(r=>a(D,r)),N.push(...l.map(e=>({value:r,vector:n(e)})))}();return N}(r,p,F,w,A,m,_)}:{values:A}}}({config:e,addScalar:a,subtract:o,multiply:g,multiplyScalar:p,flatten:x,divideScalar:m,sqrt:E,abs:s,bignumber:d,diag:w,size:A,reshape:F,qr:C,inv:h,usolve:M,usolveAll:N,equal:u,complex:_,larger:D,smaller:z,matrixFromColumns:T,dot:I});return t("eigs",{Array:function(r){return doEigs(n(r))},"Array, number|BigNumber":function(r,e){return doEigs(n(r),{precision:e})},"Array, Object":(r,e)=>doEigs(n(r),e),Matrix:function(r){return doEigs(r,{matricize:!0})},"Matrix, number|BigNumber":function(r,e){return doEigs(r,{precision:e,matricize:!0})},"Matrix, Object":function(r,e){var t={matricize:!0};return _extends(t,e),doEigs(r,t)}});function doEigs(r){var t,a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},u=!("eigenvectors"in a)||a.eigenvectors,c=function(r,e,t){var n=r.toArray(),a=r.size();if(2!==a.length||a[0]!==a[1])throw RangeError("Matrix must be square (size: ".concat(string_format(a),")"));var u=a[0];if(function(r,e,t){for(var n=0;n<e;n++)for(var a=0;a<e;a++)if(D(d(s(S(r[n][a]))),t))return!1;return!0}(n,u,e)&&(function(r,e){for(var t=0;t<e;t++)for(var n=0;n<e;n++)r[t][n]=B(r[t][n])}(n,u),function(r,e,t){for(var n=0;n<e;n++)for(var a=n;a<e;a++)if(D(d(s(o(r[n][a],r[a][n]))),t))return!1;return!0}(n,u,e))){var c=coerceTypes(r,n,u);return O(n,u,e,c,t)}var f=coerceTypes(r,n,u);return P(n,u,e,f,t)}(r,null!==(t=a.precision)&&void 0!==t?t:e.epsilon,u);return a.matricize&&(c.values=n(c.values),u&&(c.eigenvectors=c.eigenvectors.map(r=>{var{value:e,vector:t}=r;return{value:e,vector:n(t)}}))),u&&Object.defineProperty(c,"vectors",{enumerable:!1,get:()=>{throw Error("eigs(M).vectors replaced with eigs(M).eigenvectors")}}),c}function coerceTypes(r,e,t){var n=r.datatype();if("number"===n||"BigNumber"===n||"Complex"===n)return n;for(var a=!1,o=!1,u=!1,s=0;s<t;s++)for(var c=0;c<t;c++){var f=e[s][c];if(isNumber(f)||isFraction(f))a=!0;else if(isBigNumber(f))o=!0;else if(isComplex(f))u=!0;else throw TypeError("Unsupported type in Matrix: "+typeOf(f))}if(o&&u&&console.warn("Complex BigNumbers not supported, this operation will lose precission."),u){for(var l=0;l<t;l++)for(var p=0;p<t;p++)e[l][p]=_(e[l][p]);return"Complex"}if(o){for(var m=0;m<t;m++)for(var h=0;h<t;h++)e[m][h]=d(e[m][h]);return"BigNumber"}if(a){for(var g=0;g<t;g++)for(var v=0;v<t;v++)e[g][v]=b(e[g][v]);return"number"}throw TypeError("Matrix contains unsupported types only.")}}),tL="mean",tZ=factory_factory(tL,["typed","add","divide"],r=>{var{typed:e,add:t,divide:n}=r;return e(tL,{"Array | Matrix":_mean,"Array | Matrix, number | BigNumber":function(r,e){try{var a=reduce(r,e,t),o=Array.isArray(r)?arraySize(r):r.size();return n(a,o[e])}catch(r){throw improveErrorMessage(r,"mean")}},"...":function(r){if(containsCollections(r))throw TypeError("Scalar values expected in function mean");return _mean(r)}});function _mean(r){var e,a=0;if(deepForEach(r,function(r){try{e=void 0===e?r:t(e,r),a++}catch(e){throw improveErrorMessage(e,"mean",r)}}),0===a)throw Error("Cannot calculate the mean of an empty array");return n(e,a)}}),tV="unbiased",tH=(r=>{var{typed:e,add:t,subtract:n,multiply:a,divide:o,apply:u,isNaN:s}=r;return e("variance",{"Array | Matrix":function(r){return _var(r,tV)},"Array | Matrix, string":_var,"Array | Matrix, number | BigNumber":function(r,e){return _varDim(r,e,tV)},"Array | Matrix, number | BigNumber, string":_varDim,"...":function(r){return _var(r,tV)}});function _var(r,e){var u,c=0;if(0===r.length)throw SyntaxError("Function variance requires one or more parameters (0 provided)");if(deepForEach(r,function(r){try{u=void 0===u?r:t(u,r),c++}catch(e){throw improveErrorMessage(e,"variance",r)}}),0===c)throw Error("Cannot calculate variance of an empty array");var f=o(u,c);if(u=void 0,deepForEach(r,function(r){var e=n(r,f);u=void 0===u?a(e,e):t(u,a(e,e))}),s(u))return u;switch(e){case"uncorrected":return o(u,c);case"biased":return o(u,c+1);case"unbiased":var l=isBigNumber(u)?u.mul(0):0;return 1===c?l:o(u,c-1);default:throw Error('Unknown normalization "'+e+'". Choose "unbiased" (default), "uncorrected", or "biased".')}}function _varDim(r,e,t){try{if(0===r.length)throw SyntaxError("Function variance requires one or more parameters (0 provided)");return u(r,e,r=>_var(r,t))}catch(r){throw improveErrorMessage(r,"variance")}}},"median"),tJ=factory_factory(tH,["typed","add","divide","compare","partitionSelect"],r=>{var{typed:e,add:t,divide:n,compare:a,partitionSelect:o}=r;function _median(r){try{var e=(r=flatten(r.valueOf())).length;if(0===e)throw Error("Cannot calculate median of an empty array");if(e%2==0){for(var t=e/2-1,n=o(r,t+1),c=r[t],f=0;f<t;++f)a(r[f],c)>0&&(c=r[f]);return s(c,n)}var l=o(r,(e-1)/2);return u(l)}catch(r){throw improveErrorMessage(r,"median")}}var u=e({"number | BigNumber | Complex | Unit":function(r){return r}}),s=e({"number | BigNumber | Complex | Unit, number | BigNumber | Complex | Unit":function(r,e){return n(t(r,e),2)}});return e(tH,{"Array | Matrix":_median,"Array | Matrix, number | BigNumber":function(r,e){throw Error("median(A, dim) is not yet supported")},"...":function(r){if(containsCollections(r))throw TypeError("Scalar values expected in function median");return _median(r)}})}),t$="norm",tW=factory_factory(t$,["typed","abs","add","pow","conj","sqrt","multiply","equalScalar","larger","smaller","matrix","ctranspose","eigs"],r=>{var{typed:e,abs:t,add:n,pow:a,conj:o,sqrt:u,multiply:s,equalScalar:c,larger:f,smaller:l,matrix:p,ctranspose:m,eigs:h}=r;return e(t$,{number:Math.abs,Complex:function(r){return r.abs()},BigNumber:function(r){return r.abs()},boolean:function(r){return Math.abs(r)},Array:function(r){return _norm(p(r),2)},Matrix:function(r){return _norm(r,2)},"Array, number | BigNumber | string":function(r,e){return _norm(p(r),e)},"Matrix, number | BigNumber | string":function(r,e){return _norm(r,e)}});function _norm(r,e){var p=r.size();if(1===p.length)return function(r,e){if(e===Number.POSITIVE_INFINITY||"inf"===e)return o=0,r.forEach(function(r){var e=t(r);f(e,o)&&(o=e)},!0),o;if(e===Number.NEGATIVE_INFINITY||"-inf"===e)return r.forEach(function(r){var e=t(r);(!u||l(e,u))&&(u=e)},!0),u||0;if("fro"===e)return _norm(r,2);if("number"==typeof e&&!isNaN(e)){if(!c(e,0)){var o,u,s=0;return r.forEach(function(r){s=n(a(t(r),e),s)},!0),a(s,1/e)}return Number.POSITIVE_INFINITY}throw Error("Unsupported parameter value")}(r,e);if(2===p.length){if(p[0]&&p[1])return function(r,e){var a,c,l,p,d;if(1===e)return a=[],c=0,r.forEach(function(r,e){var o=e[1],u=n(a[o]||0,t(r));f(u,c)&&(c=u),a[o]=u},!0),c;if(e===Number.POSITIVE_INFINITY||"inf"===e)return l=[],p=0,r.forEach(function(r,e){var a=e[0],o=n(l[a]||0,t(r));f(o,p)&&(p=o),l[a]=o},!0),p;if("fro"===e)return d=0,r.forEach(function(r,e){d=n(d,s(r,o(r)))}),t(u(d));if(2===e)return function(r){var e=r.size();if(e[0]!==e[1])throw RangeError("Invalid matrix dimensions");var n=h(s(m(r),r)).values.toArray();return t(u(n[n.length-1]))}(r);throw Error("Unsupported parameter value "+e)}(r,e);throw RangeError("Invalid matrix dimensions")}}}),tX=(r=>{var{typed:e,config:t,multiplyScalar:n,addScalar:a,unaryMinus:o,norm:u,BigNumber:s,matrix:c,DenseMatrix:f,SparseMatrix:l,cos:p,sin:m}=r;return e("rotationMatrix",{"":function(){return"Matrix"===t.matrix?c([]):[]},string:function(r){return c(r)},"number | BigNumber | Complex | Unit":function(r){return _rotationMatrix2x2(r,"Matrix"===t.matrix?"dense":void 0)},"number | BigNumber | Complex | Unit, string":function(r,e){return _rotationMatrix2x2(r,e)},"number | BigNumber | Complex | Unit, Array":function(r,e){var t=c(e);return _validateVector(t),_rotationMatrix3x3(r,t,void 0)},"number | BigNumber | Complex | Unit, Matrix":function(r,e){_validateVector(e);var n=e.storage()||("Matrix"===t.matrix?"dense":void 0);return _rotationMatrix3x3(r,e,n)},"number | BigNumber | Complex | Unit, Array, string":function(r,e,t){var n=c(e);return _validateVector(n),_rotationMatrix3x3(r,n,t)},"number | BigNumber | Complex | Unit, Matrix, string":function(r,e,t){return _validateVector(e),_rotationMatrix3x3(r,e,t)}});function _rotationMatrix2x2(r,e){var t=isBigNumber(r)?new s(-1):-1,a=p(r),o=m(r);return _convertToFormat([[a,n(t,o)],[o,a]],e)}function _validateVector(r){var e=r.size();if(e.length<1||3!==e[0])throw RangeError("Vector must be of dimensions 1x3")}function _mul(r){return r.reduce((r,e)=>n(r,e))}function _convertToFormat(r,e){if(e){if("sparse"===e)return new l(r);if("dense"===e)return new f(r);throw TypeError('Unknown matrix type "'.concat(e,'"'))}return r}function _rotationMatrix3x3(r,e,t){var n=u(e);if(0===n)throw RangeError("Rotation around zero vector");var c=isBigNumber(r)?s:null,f=c?new c(1):1,l=c?new c(-1):-1,h=c?new c(e.get([0])/n):e.get([0])/n,d=c?new c(e.get([1])/n):e.get([1])/n,g=c?new c(e.get([2])/n):e.get([2])/n,v=p(r),D=a(f,o(v)),y=m(r);return _convertToFormat([[a(v,_mul([h,h,D])),a(_mul([h,d,D]),_mul([l,g,y])),a(_mul([h,g,D]),_mul([d,y]))],[a(_mul([h,d,D]),_mul([g,y])),a(v,_mul([d,d,D])),a(_mul([d,g,D]),_mul([l,h,y]))],[a(_mul([h,g,D]),_mul([l,d,y])),a(_mul([d,g,D]),_mul([h,y])),a(v,_mul([g,g,D]))]],t)}},"schur"),tY=N({config:config}),tG=k({}),tQ=V({}),tK=H({}),t0=$({Matrix:tK}),t1=G({BigNumber:tY,Complex:tG,DenseMatrix:t0,Fraction:tQ}),t2=rr({typed:t1}),t8=rn({typed:t1}),t3=ri({typed:t1}),t5=ra({BigNumber:tY,typed:t1}),t7=rs({Complex:tG,typed:t1}),t9=rf({typed:t1}),t4=rp({typed:t1}),t6=rd({config:config,typed:t1}),nr=rD({typed:t1}),ne=ry({typed:t1}),nt=rb({typed:t1}),nn=rA({typed:t1}),ni=rC({typed:t1}),na=rz({typed:t1}),no=rI({typed:t1}),nu=rk({typed:t1}),ns=rR({BigNumber:tY,Fraction:tQ,complex:t7,typed:t1}),nc=rU({typed:t1}),nf=rL({Matrix:tK,equalScalar:t6,typed:t1}),nl=rV({typed:t1}),np=rJ({typed:t1}),nm=rX({typed:t1}),nh=rY({Complex:tG,config:config,typed:t1}),nd=rQ({typed:t1}),ng=rK({Fraction:tQ,typed:t1}),nv=r1({typed:t1}),nD=r8({DenseMatrix:t0,Matrix:tK,SparseMatrix:nf,typed:t1}),ny=r5({isNaN:nm,isNumeric:nv,typed:t1}),nx=r7({bignumber:t5,fraction:ng,number:no}),nb=r4({isInteger:nt,matrix:nD,typed:t1}),n_=er({matrix:nD,config:config,typed:t1}),nE=et({matrix:nD,typed:t1}),nw=ei({BigNumber:tY,config:config,matrix:nD,typed:t1}),nA=eo({isInteger:nt,matrix:nD,typed:t1}),nF=es({conj:t9,transpose:nE,typed:t1}),nC=ef({DenseMatrix:t0,SparseMatrix:nf,matrix:nD,typed:t1}),nM=ep({numeric:nx,typed:t1}),nN=ew({DenseMatrix:t0,concat:nA,equalScalar:t6,matrix:nD,typed:t1}),nS=eC({matrix:nD,typed:t1}),nB=eN({BigNumber:tY,DenseMatrix:t0,SparseMatrix:nf,config:config,matrix:nD,typed:t1}),nz=eB({DenseMatrix:t0,concat:nA,config:config,matrix:nD,typed:t1}),nT=ek({flatten:nS,matrix:nD,size:n_,typed:t1}),nI=eq({addScalar:t8,complex:t7,conj:t9,divideScalar:nM,equal:nN,identity:nB,isZero:ni,matrix:nD,multiplyScalar:na,sign:ns,sqrt:nh,subtractScalar:np,typed:t1,unaryMinus:nd,zeros:nw}),nO=eL({BigNumber:tY,DenseMatrix:t0,equalScalar:t6,matrix:nD,typed:t1,zeros:nw}),nP=eV({DenseMatrix:t0,concat:nA,config:config,matrix:nD,typed:t1}),nj=eW({DenseMatrix:t0,concat:nA,equalScalar:t6,matrix:nD,subtractScalar:np,typed:t1,unaryMinus:nd}),nk=eG({DenseMatrix:t0,divideScalar:nM,equalScalar:t6,matrix:nD,multiplyScalar:na,subtractScalar:np,typed:t1}),nq=eK({DenseMatrix:t0,SparseMatrix:nf,addScalar:t8,concat:nA,equalScalar:t6,matrix:nD,typed:t1}),nR=e1({BigNumber:tY,DenseMatrix:t0,Fraction:tQ,concat:nA,config:config,equalScalar:t6,matrix:nD,typed:t1}),nU=e8({addScalar:t8,conj:t9,multiplyScalar:na,size:n_,typed:t1}),nL=e6({ImmutableDenseMatrix:e4({DenseMatrix:t0,smaller:nP}),getMatrixDataType:nr}),nZ=te({DenseMatrix:t0,concat:nA,config:config,matrix:nD,typed:t1}),nV=ti({addScalar:t8,dot:nU,equalScalar:t6,matrix:nD,multiplyScalar:na,typed:t1}),nH=to({compare:nR,isNaN:nm,isNumeric:nv,typed:t1}),nJ=td({DenseMatrix:t0,divideScalar:nM,equalScalar:t6,matrix:nD,multiplyScalar:na,subtractScalar:np,typed:t1}),n$=tb({divideScalar:nM,isZero:ni,matrix:nD,multiply:nV,subtractScalar:np,typed:t1,unaryMinus:nd}),nW=t_({larger:nZ,smaller:nP}),nX=tF({DenseMatrix:t0,concat:nA,config:config,matrix:nD,typed:t1}),nY=tN({bignumber:t5,matrix:nD,add:nq,config:config,isPositive:nn,larger:nZ,largerEq:nz,smaller:nP,smallerEq:nX,typed:t1}),nG=tS({FibonacciHeap:nW,addScalar:t8,equalScalar:t6}),nQ=tz({Index:nL,matrix:nD,range:nY,typed:t1}),nK=tT({abs:t2,addScalar:t8,det:n$,divideScalar:nM,identity:nB,matrix:nD,multiply:nV,typed:t1,unaryMinus:nd}),n0=tO({Complex:tG,config:config,fraction:ng,identity:nB,inv:nK,matrix:nD,multiply:nV,number:no,typed:t1}),n1=tk({divideScalar:nM,equalScalar:t6,inv:nK,matrix:nD,multiply:nV,typed:t1}),n2=tU({abs:t2,add:nq,addScalar:t8,atan:t3,bignumber:t5,column:nQ,complex:t7,config:config,cos:t4,diag:nC,divideScalar:nM,dot:nU,equal:nN,flatten:nS,im:ne,inv:nK,larger:nZ,matrix:nD,matrixFromColumns:nT,multiply:nV,multiplyScalar:na,number:no,qr:nI,re:nu,reshape:nb,sin:nc,size:n_,smaller:nP,sqrt:nh,subtract:nj,typed:t1,usolve:nk,usolveAll:nJ}),n8=tZ({add:nq,divide:n1,typed:t1}),n3=tJ({add:nq,compare:nR,divide:n1,partitionSelect:nH,typed:t1}),n5=tW({abs:t2,add:nq,conj:t9,ctranspose:nF,eigs:n2,equalScalar:t6,larger:nZ,matrix:nD,multiply:nV,pow:n0,smaller:nP,sqrt:nh,typed:t1})}}]);